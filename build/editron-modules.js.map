{"version":3,"sources":["webpack://editronModules/webpack/bootstrap","webpack://editronModules/./Controller.js","webpack://editronModules/./components/container/index.js","webpack://editronModules/./components/containerdescription/index.js","webpack://editronModules/./components/containererrors/index.js","webpack://editronModules/./components/containerheader/index.js","webpack://editronModules/./components/index.js","webpack://editronModules/./components/overlay/index.js","webpack://editronModules/./components/overlayselecttiles/index.js","webpack://editronModules/./editors/AbstractEditor.js","webpack://editronModules/./editors/AbstractValueEditor.js","webpack://editronModules/./editors/arrayeditor/ArrayItemEditor.js","webpack://editronModules/./editors/arrayeditor/ArrayItemView.js","webpack://editronModules/./editors/arrayeditor/index.js","webpack://editronModules/./editors/index.js","webpack://editronModules/./editors/objecteditor/index.js","webpack://editronModules/./editors/oneofeditor/index.js","webpack://editronModules/./editors/valueeditor/View.js","webpack://editronModules/./editors/valueeditor/index.js","webpack://editronModules/./editron.js","webpack://editronModules/./editron.scss","webpack://editronModules/./node_modules/autosize/dist/autosize.js","webpack://editronModules/./node_modules/diff_match_patch/lib/diff_match_patch.js","webpack://editronModules/./node_modules/gson-pointer/index.js","webpack://editronModules/./node_modules/gson-pointer/lib/delete.js","webpack://editronModules/./node_modules/gson-pointer/lib/get.js","webpack://editronModules/./node_modules/gson-pointer/lib/isRoot.js","webpack://editronModules/./node_modules/gson-pointer/lib/join.js","webpack://editronModules/./node_modules/gson-pointer/lib/removeUndefinedItems.js","webpack://editronModules/./node_modules/gson-pointer/lib/set.js","webpack://editronModules/./node_modules/gson-pointer/lib/split.js","webpack://editronModules/./node_modules/json-schema-library/index.js","webpack://editronModules/./node_modules/json-schema-library/lib/SchemaService.js","webpack://editronModules/./node_modules/json-schema-library/lib/addSchema.js","webpack://editronModules/./node_modules/json-schema-library/lib/addValidator.js","webpack://editronModules/./node_modules/json-schema-library/lib/config/settings.js","webpack://editronModules/./node_modules/json-schema-library/lib/config/strings.js","webpack://editronModules/./node_modules/json-schema-library/lib/cores/CoreInterface.js","webpack://editronModules/./node_modules/json-schema-library/lib/cores/Draft04.js","webpack://editronModules/./node_modules/json-schema-library/lib/cores/JsonEditor.js","webpack://editronModules/./node_modules/json-schema-library/lib/createSchemaOf.js","webpack://editronModules/./node_modules/json-schema-library/lib/each.js","webpack://editronModules/./node_modules/json-schema-library/lib/getChildSchemaSelection.js","webpack://editronModules/./node_modules/json-schema-library/lib/getSchema.js","webpack://editronModules/./node_modules/json-schema-library/lib/getTemplate.js","webpack://editronModules/./node_modules/json-schema-library/lib/getTypeOf.js","webpack://editronModules/./node_modules/json-schema-library/lib/isValid.js","webpack://editronModules/./node_modules/json-schema-library/lib/iterateSchema.js","webpack://editronModules/./node_modules/json-schema-library/lib/precompileSchema.js","webpack://editronModules/./node_modules/json-schema-library/lib/resolveOneOf.fuzzy.js","webpack://editronModules/./node_modules/json-schema-library/lib/resolveOneOf.strict.js","webpack://editronModules/./node_modules/json-schema-library/lib/resolveRef.strict.js","webpack://editronModules/./node_modules/json-schema-library/lib/resolveRef.withOverwrite.js","webpack://editronModules/./node_modules/json-schema-library/lib/step.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/__.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/createCustomError.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/filter.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/flattenArray.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/getTargetSchema.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/punycode.ucs2decode.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/ref.js","webpack://editronModules/./node_modules/json-schema-library/lib/utils/render.js","webpack://editronModules/./node_modules/json-schema-library/lib/validate.js","webpack://editronModules/./node_modules/json-schema-library/lib/validateAsync.js","webpack://editronModules/./node_modules/json-schema-library/lib/validation/errors.js","webpack://editronModules/./node_modules/json-schema-library/lib/validation/format.js","webpack://editronModules/./node_modules/json-schema-library/lib/validation/keyword.js","webpack://editronModules/./node_modules/json-schema-library/lib/validation/type.js","webpack://editronModules/./node_modules/json-schema-library/lib/validation/typeKeywordMapping.js","webpack://editronModules/./node_modules/json-schema-library/remotes/index.js","webpack://editronModules/./node_modules/jsondiffpatch/public/external sync ^\\.\\/.*$","webpack://editronModules/./node_modules/jsondiffpatch/public/external/diff_match_patch_uncompressed.js","webpack://editronModules/./node_modules/jsondiffpatch/src/clone.js","webpack://editronModules/./node_modules/jsondiffpatch/src/contexts/context.js","webpack://editronModules/./node_modules/jsondiffpatch/src/contexts/diff.js","webpack://editronModules/./node_modules/jsondiffpatch/src/contexts/patch.js","webpack://editronModules/./node_modules/jsondiffpatch/src/contexts/reverse.js","webpack://editronModules/./node_modules/jsondiffpatch/src/diffpatcher.js","webpack://editronModules/./node_modules/jsondiffpatch/src/filters/arrays.js","webpack://editronModules/./node_modules/jsondiffpatch/src/filters/dates.js","webpack://editronModules/./node_modules/jsondiffpatch/src/filters/lcs.js","webpack://editronModules/./node_modules/jsondiffpatch/src/filters/nested.js","webpack://editronModules/./node_modules/jsondiffpatch/src/filters/texts.js","webpack://editronModules/./node_modules/jsondiffpatch/src/filters/trivial.js","webpack://editronModules/./node_modules/jsondiffpatch/src/pipe.js","webpack://editronModules/./node_modules/jsondiffpatch/src/processor.js","webpack://editronModules/./node_modules/lodash-es/_Symbol.js","webpack://editronModules/./node_modules/lodash-es/_baseGetTag.js","webpack://editronModules/./node_modules/lodash-es/_freeGlobal.js","webpack://editronModules/./node_modules/lodash-es/_getPrototype.js","webpack://editronModules/./node_modules/lodash-es/_getRawTag.js","webpack://editronModules/./node_modules/lodash-es/_objectToString.js","webpack://editronModules/./node_modules/lodash-es/_overArg.js","webpack://editronModules/./node_modules/lodash-es/_root.js","webpack://editronModules/./node_modules/lodash-es/isObjectLike.js","webpack://editronModules/./node_modules/lodash-es/isPlainObject.js","webpack://editronModules/./node_modules/mithril-material-forms/components/button/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/checkbox/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/checkboxform/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/errors/getErrorClass.js","webpack://editronModules/./node_modules/mithril-material-forms/components/errors/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/imagepreview/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/input/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/inputform/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/inputform/sanitizeValue.js","webpack://editronModules/./node_modules/mithril-material-forms/components/label/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/select/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/selectform/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/textarea/index.js","webpack://editronModules/./node_modules/mithril-material-forms/components/textareaform/index.js","webpack://editronModules/./node_modules/mithril-material-forms/index.js","webpack://editronModules/./node_modules/mitt/dist/mitt.es.js","webpack://editronModules/./node_modules/mitt/dist/mitt.js","webpack://editronModules/./node_modules/process/browser.js","webpack://editronModules/./node_modules/redux-undo/lib/index.js","webpack://editronModules/./node_modules/redux/es/applyMiddleware.js","webpack://editronModules/./node_modules/redux/es/bindActionCreators.js","webpack://editronModules/./node_modules/redux/es/combineReducers.js","webpack://editronModules/./node_modules/redux/es/compose.js","webpack://editronModules/./node_modules/redux/es/createStore.js","webpack://editronModules/./node_modules/redux/es/index.js","webpack://editronModules/./node_modules/redux/es/utils/warning.js","webpack://editronModules/./node_modules/symbol-observable/es/index.js","webpack://editronModules/./node_modules/symbol-observable/es/ponyfill.js","webpack://editronModules/./node_modules/valid-url/index.js","webpack://editronModules/(webpack)/buildin/global.js","webpack://editronModules/(webpack)/buildin/module.js","webpack://editronModules/./plugin/index.js","webpack://editronModules/./services/DataService.js","webpack://editronModules/./services/LocationService.js","webpack://editronModules/./services/OverlayService.js","webpack://editronModules/./services/SchemaService.js","webpack://editronModules/./services/SessionService.js","webpack://editronModules/./services/State.js","webpack://editronModules/./services/ValidationService.js","webpack://editronModules/./services/index.js","webpack://editronModules/./services/reducers/actions.js","webpack://editronModules/./services/reducers/dataReducer.js","webpack://editronModules/./services/reducers/errorReducer.js","webpack://editronModules/./services/uistate/actions.js","webpack://editronModules/./services/uistate/index.js","webpack://editronModules/./services/uistate/uiReducer.js","webpack://editronModules/./services/utils/BubblingCollectionObservable.js","webpack://editronModules/./services/utils/Validation.js","webpack://editronModules/./services/utils/copy.js","webpack://editronModules/./services/utils/diffpatch.js","webpack://editronModules/./services/utils/ensureItemIDs.js","webpack://editronModules/./services/utils/getParentPointer.js","webpack://editronModules/./services/utils/getPatchesPerPointer.js","webpack://editronModules/./services/utils/isRootPointer.js","webpack://editronModules/./utils/UISchema.js","webpack://editronModules/./utils/addItem.js","webpack://editronModules/./utils/array.js","webpack://editronModules/./utils/createElement.js","webpack://editronModules/./utils/getID.js","webpack://editronModules/./utils/i18n.js","webpack://editronModules/./utils/index.js","webpack://editronModules/./utils/isNodeContext.js","webpack://editronModules/./utils/populated.js","webpack://editronModules/./utils/selectEditor.js","webpack://editronModules/external \"m\""],"names":["gp","require","Core","cores","JsonEditor","addValidator","DataService","SchemaService","ValidationService","LocationService","State","selectEditor","_createElement","addItem","UISchema","getID","plugin","i18n","isValidPointer","pointer","assertValidPointer","Error","removeEditorFrom","instances","editor","getPointer","filter","instance","length","Controller","schema","data","options","extendSchema","editors","getEditors","state","core","getValidators","forEach","validationType","validator","addFormatValidator","addKeywordValidator","e","console","log","message","schemaService","validationService","setErrorHandler","error","translateError","addDefaultData","dataService","onAfterDataUpdate","on","EVENTS","AFTER_UPDATE","bind","validateAll","resetUndoRedo","selector","attributes","element","instanceOptions","id","copyOptions","Editor","undefined","warn","get","appendChild","toElement","addInstance","$element","parentNode","removeChild","push","index","goto","join","set","format","datatype","keyword","setSchema","setData","setTimeout","destroyed","validate","getDataByReference","Object","keys","destroy","off","update","newPointer","module","exports","m","ContainerHeader","ContainerErrors","ContainerDescription","ContainerView","childContainerSelector","getChildContainer","$childContainer","querySelector","view","vnode","attrs","hideTitle","children","populated","description","trust","Array","isArray","errors","map","severity","getClass","title","icon","hasAction","classname","onadd","ondelete","onmoveup","onmovedown","name","onclick","container","containerdescription","containererrors","containerheader","overlay","overlayselecttiles","Button","button","fullscreen","header","oncreate","contentNode","dom","onClick","onAbort","titleAbort","showSave","onSave","Tile","value","toLowerCase","getDataValue","node","getAttribute","className","includes","onchange","Function","prototype","target","tile","active","getTypeClass","type","AbstractEditor","controller","createElement","getSchema","observe","notifyNestedChanges","setErrors","notifyNestedErrors","getErrorsAndWarnings","oldPointer","removeObserver","location","setCurrent","blur","removeInstance","_addError","_clearErrors","updateErrors","getId","convert","integer","converted","parseInt","isNaN","number","parseFloat","AbstractValueEditor","viewModel","editorValueType","enum","editorElementProperties","instantUpdate","onfocus","onblur","setValue","changePointer","setAttribute","render","ArrayItemView","arrayUtils","ArrayItemEditor","onAdd","add","onRemove","remove","onremove","onmove","move","$target","editorTarget","createEditor","updatePointer","parentPointer","removeItem","to","moveItem","getIndex","replace","canRemove","minItems","canAdd","maxItems","showIndex","trim","insert","preventDefault","diffpatch","View","ArrayEditor","addItemTo","Infinity","controls","updateView","$items","rebuildChildren","updateControls","previousPointer","child","changeEvent","patch","applyPatches","originalChildren","slice","newChild","indexOf","currentLocation","getCurrent","i","l","currentPointer","insertBefore","innerHTML","item","childPointer","childEditor","classList","toggle","ObjectEditor","OneOfEditor","ValueEditor","TextareaForm","OverlayService","showJSON","open","ok","save","JSON","stringify","childEditors","addDelete","delete","$children","_property","property","propertyData","code","showProperty","deleteProperty","Select","UI_PROPERTY","oneOfSchema","items","renderOneOf","childSchema","oneOf","oneOfIndex","changeChild","getIndexOf","rebuild","getTemplate","currentSchema","CheckboxForm","SelectForm","InputForm","chooseInput","config","enumOptions","components","services","utils","global","factory","define","Map","values","has","key","_delete","splice","createEvent","Event","bubbles","evt","document","initEvent","assign","ta","nodeName","heightOffset","clientWidth","cachedHeight","init","style","window","getComputedStyle","resize","boxSizing","paddingTop","paddingBottom","borderTopWidth","borderBottomWidth","changeOverflow","width","offsetWidth","overflowY","getParentOverflows","el","arr","Element","scrollTop","originalHeight","height","overflows","docTop","documentElement","endHeight","scrollHeight","styleHeight","Math","round","computed","actualHeight","offsetHeight","dispatchEvent","err","pageResize","removeEventListener","overflowX","wordWrap","addEventListener","methods","autosize","call","x","diff_match_patch","Diff_Timeout","Diff_EditCost","Diff_DualThreshold","Match_Threshold","Match_Distance","Patch_DeleteThreshold","Patch_Margin","getMaxBits","maxbits","oldi","newi","Match_MaxBits","DIFF_DELETE","DIFF_INSERT","DIFF_EQUAL","diff_main","text1","text2","opt_checklines","checklines","commonlength","diff_commonPrefix","commonprefix","substring","diff_commonSuffix","commonsuffix","diffs","diff_compute","unshift","diff_cleanupMerge","longtext","shorttext","hm","diff_halfMatch","text1_a","text1_b","text2_a","text2_b","mid_common","diffs_a","diffs_b","concat","linearray","a","diff_linesToChars","diff_map","diff_charsToLines","diff_cleanupSemantic","count_delete","count_insert","text_delete","text_insert","j","pop","lineArray","lineHash","diff_linesToCharsMunge","text","chars","lineStart","lineEnd","lineArrayLength","line","hasOwnProperty","String","fromCharCode","chars1","chars2","y","charCodeAt","ms_end","Date","getTime","text1_length","text2_length","max_d","doubleEnd","v_map1","v_map2","v1","v2","footstep","footsteps","done","front","d","k","charAt","diff_path1","diff_path2","v_map","path","last_op","pathLength","pointermin","pointermax","min","pointermid","pointerstart","floor","pointerend","dmp","diff_halfMatchI","seed","best_common","best_longtext_a","best_longtext_b","best_shorttext_a","best_shorttext_b","prefixLength","suffixLength","hm1","ceil","hm2","changes","equalities","equalitiesLength","lastequality","length_changes1","length_changes2","diff_cleanupSemanticLossless","punctuation","whitespace","linebreak","blanklineEnd","blanklineStart","diff_cleanupSemanticScore","one","two","score","match","equality1","edit","equality2","commonOffset","commonString","bestEquality1","bestEdit","bestEquality2","bestScore","diff_cleanupEfficiency","pre_ins","pre_del","post_ins","post_del","diff_xIndex","loc","last_chars1","last_chars2","diff_prettyHtml","html","op","diff_text1","diff_text2","diff_levenshtein","levenshtein","insertions","deletions","max","diff_toDelta","encodeURI","diff_fromDelta","delta","diffsLength","tokens","split","param","decodeURI","ex","n","match_main","pattern","match_bitap","s","match_alphabet","match_bitapScore","accuracy","proximity","abs","score_threshold","best_loc","lastIndexOf","matchmask","bin_min","bin_mid","bin_max","last_rd","start","finish","rd","charMatch","patch_addContext","start2","length1","padding","prefix","suffix","start1","length2","patch_make","opt_b","opt_c","patches","patch_obj","patchDiffLength","char_count1","char_count2","prepatch_text","postpatch_text","diff_type","diff_text","patch_deepCopy","patchesCopy","patchCopy","patch_apply","nullPadding","patch_addPadding","patch_splitMax","results","expected_loc","start_loc","end_loc","index1","index2","mod","paddingLength","extraLength","bigpatch","patch_size","precontext","empty","shift","postcontext","patch_toText","patch_fromText","textline","textPointer","sign","toString","coords1","coords2","isRoot","removeUndefinedItems","pointerDelete","keepArrayIndices","properties","lastProperty","defaultValue","result","run","simpleJoin","matchMutlipleSlashes","matchTildes","matchSlashes","joinList","list","isURI","encodeURIComponent","firstPointer","arguments","option","apply","array","skip","arrayIndex","test","nextKeyIsArray","current","create","addValue","keyAsIndex","matchPointerPrefixes","sanitizeProperty","sanitizeAndDecodeProperty","decodeURIComponent","sanitize","strings","Interface","Draft04","addSchema","createCustomError","createSchemaOf","each","getChildSchemaSelection","getTypeOf","isValid","iterateSchema","step","validateAsync","copy","parse","cache","rootSchema","parentSchema","variableSchema","remotes","precompile","url","addError","errorId","errorCreator","addFormat","formatType","validationFunction","validateFormat","addKeyword","typeKeywords","validateKeyword","floatingPointPrecision","propertyBlacklist","AdditionalItemsError","AdditionalPropertiesError","AnyOfError","EnumError","FormatDateTimeError","FormatEmailError","FormatUrlError","FormatUriError","FormatHostnameError","FormatIPV4Error","FormatIPV6Error","FormatRegExError","MaximumError","MaxItemsError","MaxLengthError","MaxPropertiesError","MinimumError","MinItemsError","MinLengthError","MinPropertiesError","MissingOneOfPropertyError","MissingDependencyError","MultipleOfError","MultipleOneOfError","NoAdditionalPropertiesError","NotError","OneOfError","OneOfPropertyError","PatternError","PatternPropertiesError","RequiredPropertyError","TypeError","UndefinedValueError","UnknownPropertyError","UniqueItemsError","ValueNotEmptyError","resolveRef","callback","__rootSchema","CoreInterface","resolveOneOf","Draft04Core","validateType","JsonEditorCore","dataType","nextSchema","next","emptyObject","frags","_get","resolveOneOfFuzzy","convertValue","resolvedSchema","TYPE","getDefault","template","default","itemCount","templateValue","initValue","iterate","targetPointer","ema","prop","additionalProperties","dependencies","isAbsoluteUrl","getAbsoluteRef","$ref","joinUrl","base","precompileSchema","__compiled","baseUrls","scope","thisScope","defineProperty","enumerable","flattenArray","fuzzyObjectValue","oneOfProperty","oneOfValue","missingOneOfPropertyError","oneOfPropertySchema","errorOrPromise","oneOfPropertyError","matches","schemaOfItem","fuzzyGreatest","fuzzyValue","oneOfError","multipleOneOfError","getTargetSchema","ref","targetSchema","reference","expectedType","patternProperties","regex","patterns","RegExp","unknownPropertyError","additionalItems","additionalItemsError","__","fallback","dashCase","str","isPromise","obj","Promise","isError","errorsOnly","getUrl","ucs2decode","string","output","counter","extra","getHostname","resourcePath","hostname","getJsonSchemaType","jsType","Number","isInteger","receivedType","typeError","received","expected","invalidTypeError","createErrorNotification","onError","notifyError","then","all","resolvedErrors","catch","stack","additionalPropertiesError","anyOfError","enumError","formatUrlError","formatUriError","formatDateTimeError","formatEmailError","formatHostnameError","formatIPV4Error","formatIPV6Error","formatRegExError","invalidSchemaError","maximumError","maxItemsError","maxLengthError","maxPropertiesError","minimumError","minItemsError","minLengthError","minPropertiesError","missingDependencyError","multipleOfError","noAdditionalPropertiesError","notError","patternError","patternPropertiesError","requiredPropertyError","undefinedValueError","uniqueItemsError","valueNotEmptyError","validUrl","isValidDateTime","isValidIPV4","isValidIPV6","FormatValidation","email","ipv4","ipv6","uri","isUri","isWebUri","settings","FPP","KeywordValidation","receivedProperties","expectedProperties","isObject","allOf","subSchema","anyOf","dependencyErrors","dependency","missingProperty","valueStr","itemData","itemSchema","itemErrors","maximum","exclusiveMaximum","maxLength","lengthOfString","maxProperties","propertyCount","minLength","minimum","exclusiveMinimum","minProperties","multipleOf","not","patternExample","pp","expr","patternSchema","patternFound","valErrors","keyErrors","propertiesRequired","required","requiredNotEmpty","uniqueItems","itemPointer","duplicatePointer","TypeValidation","object","boolean","null","reset","Diff","opt_deadline","MAX_VALUE","deadline","diff_compute_","diff_halfMatch_","diff_lineMode_","diff_bisect_","diff_linesToChars_","diff_charsToLines_","v_offset","v_length","k1start","k1end","k2start","k2end","k1","k1_offset","x1","y1","k2_offset","x2","diff_bisectSplit_","k2","y2","text1a","text2a","text1b","text2b","diffsb","diff_linesToCharsMunge_","diff_commonOverlap_","text_length","best","found","diff_halfMatchI_","length_insertions1","length_deletions1","length_insertions2","length_deletions2","deletion","insertion","overlap_length","diff_cleanupSemanticScore_","pattern_amp","pattern_lt","pattern_gt","pattern_para","match_bitap_","match_alphabet_","match_bitapScore_","patch_addContext_","patchHeader","cloneRegExp","re","regexMatch","exec","clone","arg","cloned","Pipe","Context","setResult","hasResult","exit","exiting","switchTo","pipe","nextPipe","parent","childName","root","nextAfterChildren","defaultClone","DiffContext","left","right","cloneDiffValues","PatchContext","ReverseContext","Processor","trivial","nested","arrays","dates","texts","DiffPatcher","processor","append","collectChildrenDiffFilter","diffFilter","objectsDiffFilter","shouldHaveResult","collectChildrenPatchFilter","patchFilter","collectChildrenReverseFilter","reverseFilter","diff","process","reverse","unpatch","lcs","ARRAY_MOVE","arrayIndexOf","arraysHaveMatchByRef","array1","array2","len1","len2","val1","val2","matchItems","context","value1","value2","objectHash","matchByPosition","hash1","hash2","hashCache1","hashCache2","arraysDiffFilter","leftIsArray","matchContext","commonHead","commonTail","_t","trimmed1","trimmed2","seq","removedItems","indices1","detectMove","includeValueOnMove","removedItemsLength","indexOnArray2","indices2","isMove","removeItemIndex1","filterName","compare","numerically","b","numericallyBy","nestedPatchFilter","toRemove","toInsert","toModify","sort","indexDiff","removedValue","toInsertLength","toModifyLength","modification","arraysReverseFilter","newName","substr","reverseArrayDeltaIndex","itemDelta","reverseIndex","deltaIndex","deltaItem","moveFromIndex","moveToIndex","deleteIndex","datesDiffFilter","defaultMatch","lengthMatrix","matrix","backtrack","sequence","subsequence","leftType","propertyFilter","nestedReverseFilter","TEXT_DIFF","DEFAULT_MIN_LENGTH","cachedDiffPatch","getDiffMatchPatch","dmpModuleName","diff_match_patch_not_found","txt1","txt2","textPatchFailed","textsDiffFilter","textDiff","diffMatchPatch","textsPatchFilter","textDeltaReverse","lines","lineTmp","headerRegex","lineHeader","lineAdd","lineRemove","textsReverseFilter","trivialMatchesDiffFilter","rightType","rightIsArray","trivialMatchesPatchFilter","regexArgs","trivialReferseFilter","filters","input","debug","resultCheck","msg","prepend","names","after","params","before","clear","should","noResult","selfOptions","pipes","lastPipe","lastContext","Symbol","nullTag","undefinedTag","symToStringTag","toStringTag","baseGetTag","freeGlobal","getPrototype","getPrototypeOf","objectProto","nativeObjectToString","getRawTag","isOwn","tag","unmasked","objectToString","overArg","func","transform","freeSelf","self","isObjectLike","objectTag","funcProto","funcToString","objectCtorString","isPlainObject","proto","Ctor","constructor","getClassNames","classNames","raised","disabled","class","event","checked","withAttr","onChange","Checkbox","Label","Errors","placeholder","getErrorClass","isVNode","RATIO_DEFAULT","isEmpty","getRatioStyle","ratio","getRatio","toFixed","dim","MetaDescription","InlineImage","maxRatio","src","onload","ImagePreview","overflowContainer","updateRatio","image","naturalWidth","ratioMax","ratioImg","naturalHeight","hasOverflow","asBackgroundImage","currentTarget","content","hasFocus","onupdate","inputAttributes","oninput","currentValue","updateEvent","Input","sanitizeValue","TYPES","$form","updateClasses","hasValue","contains","inputType","focusClass","errorClass","emptyClass","intValue","floatValue","$wrapper","rows","onbeforeremove","textareaAttributes","Textarea","checkbox","checkboxForm","inputForm","label","select","selectForm","textarea","textareaForm","imagePreview","mitt","handler","emit","c","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","clearTimeout","runTimeout","fun","runClearTimeout","marker","queue","draining","currentQueue","queueIndex","cleanUpNextTick","drainQueue","timeout","len","nextTick","args","Item","browser","env","argv","version","versions","noop","addListener","once","removeListener","removeAllListeners","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","_extends","source","parseActions","undoable","distinctState","includeAction","ifAction","excludeAction","_toConsumableArray","arr2","from","__DEBUG__","_console","_len","_key","group","debugStart","action","_console2","groupCollapsed","debugEnd","groupEnd","ActionTypes","UNDO","REDO","JUMP_TO_FUTURE","JUMP_TO_PAST","ActionCreators","undo","redo","jumpToFuture","jumpToPast","history","past","future","limit","free","present","historyOverflow","wrapState","updateState","createHistory","rawActions","reducer","rawConfig","initialState","initTypes","undoType","redoType","jumpToPastType","jumpToFutureType","initialHistory","res","some","actionType","updatedHistory","currentState","previousState","actions","applyMiddleware","middlewares","createStore","preloadedState","enhancer","store","_dispatch","dispatch","chain","middlewareAPI","getState","middleware","compose","bindActionCreators","bindActionCreator","actionCreator","actionCreators","boundActionCreators","combineReducers","getUndefinedStateErrorMessage","actionName","getUnexpectedStateShapeWarningMessage","inputState","reducers","unexpectedKeyCache","reducerKeys","argumentName","INIT","unexpectedKeys","assertReducerShape","random","finalReducers","finalReducerKeys","shapeAssertionError","combination","warningMessage","hasChanged","nextState","_i","previousStateForKey","nextStateForKey","errorMessage","funcs","reduce","_ref2","currentReducer","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","subscribe","listener","isSubscribed","unsubscribe","replaceReducer","nextReducer","observable","_ref","outerSubscribe","observer","observeState","$$observable","isCrushed","warning","symbolObservablePonyfill","is_uri","is_iri","is_http_uri","is_http_iri","is_https_uri","is_https_iri","is_web_uri","is_web_iri","isHttpUri","isHttpsUri","splitUri","splitted","scheme","authority","query","fragment","out","allowHttps","port","g","webpackPolyfill","deprecate","paths","validators","keywordValidator","isRootPointer","dataReducer","getParentPointer","getPatchesPerPointer","DEBUG","BEFORE_UPDATE","observers","emitter","register","lastUpdate","onStateChanged","info","eventLocation","parentData","parentDataType","bubbleObservers","unregister","isSynched","DATA_SET","eventType","createEventObject","bubbleEvents","cb","eventObject","notify","UIState","DELAY","PAGE_EVENT","TARGET_EVENT","nextPage","currentPage","getCurrentPage","setCurrentPage","setCurrentPointer","focus","getCurrentPointer","targetElement","getElementById","scrollTarget","offsetParent","scrollIntoView","CURRENT_PAGE_EVENT","CURRENT_POINTER_EVENT","Overlay","OVERLAY_EVENT","setOverlay","close","getElement","$el","body","jsl","resetCache","localStorage","getItem","setItem","redux","FLAG_CHANGED","subState","errorReducer","Validation","BubblingCollectionObservable","BEFORE_VALIDATION","AFTER_VALIDATION","ON_ERROR","errorHandler","currentValidation","cancel","newError","currentErrors","validationErrors","bubbledEvents","withChildErrors","selectError","withChildWarnings","SessionService","UndoActionCreators","UndoActionTypes","ERRORS_SET","newValue","prevValue","ensureItemIDs","defaultState","newState","UI_PAGE_SET","UI_OVERLAY_SET","UI_CURRENT_SET","uiReducer","ui","currentContent","Singleton","UIStateContructor","eventCollection","bubbleCollection","receiveChildEvents","p","_notify","observerPointer","sourcePointer","events","canceled","onErrorCb","onDoneCb","cbDone","cbError","onDone","onFail","validationError","_id","ID_PROPERTY","generateId","now","addMissingItemIDs","sortByPointer","findPatches","entry","propertyAdded","propertyRemoved","isArrayItem","changedKey","previousValue","isPointer","getBreadcrumps","breadcrumps","getOption","enum_titles","resolveReference","pointerToResolve","hidden","getTitle","resolveOption","optionValue","editronOptions","resolver","getDefaultOption","SelectTileComponent","selectOptions","addSelection","selection","selectedIndex","nextList","destinationIndex","moveElement","translate","addLanguage","lang","_keys","isNodeContext","UISchem","returnIf","returnElse","isPopulated","editorViews","editorOf"],"mappings":"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","file":"editron-modules.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const gp = require(\"gson-pointer\");\nconst Core = require(\"json-schema-library\").cores.JsonEditor;\nconst addValidator = require(\"json-schema-library/lib/addValidator\");\nconst DataService = require(\"./services/DataService\");\nconst SchemaService = require(\"./services/SchemaService\");\nconst ValidationService = require(\"./services/ValidationService\");\nconst LocationService = require(\"./services/LocationService\");\nconst State = require(\"./services/State\");\nconst selectEditor = require(\"./utils/selectEditor\");\nconst _createElement = require(\"./utils/createElement\");\nconst addItem = require(\"./utils/addItem\");\nconst UISchema = require(\"./utils/UISchema\");\nconst getID = require(\"./utils/getID\");\nconst plugin = require(\"./plugin\");\nconst i18n = require(\"./utils/i18n\");\n\n\nfunction isValidPointer(pointer) {\n    return pointer[0] === \"#\";\n}\n\nfunction assertValidPointer(pointer) {\n    if (isValidPointer(pointer) === false) {\n        throw new Error(`Invalid json(schema)-pointer: ${pointer}`);\n    }\n}\n\n\n// removes the editor from the instances-inventory of active editors\nfunction removeEditorFrom(instances, editor) {\n    const pointer = editor.getPointer();\n    if (instances[pointer]) {\n        instances[pointer] = instances[pointer].filter((instance) => editor !== instance);\n        if (instances[pointer].length === 0) {\n            delete instances[pointer];\n        }\n    }\n}\n\n\n/**\n * Main component to build editors. Each editor should receive the controller, which carries all required services\n * for editor initialization\n *\n * ### Usage\n *\n * Instantiate the controller\n *\n * ```js\n * import { Controller } from \"editron\";\n * // jsonSchema = { type: \"object\", required: [\"title\"], properties: { title: { type: \"string\" } } }\n * const editron = new Controller(jsonSchema);\n * ```\n *\n * or, using all parameters\n *\n * ```js\n *  import { Controller } from \"editron\";\n *  // jsonSchema = { type: \"object\", required: [\"title\"], properties: { title: { type: \"string\" } } }\n *  // data = { title: \"Hello\" } - or simply use {}\n *  // options = { editors: [ complete list of custom editors ] }\n *  const editron = new Controller(jsonSchema, data, options);\n * ```\n *\n * and start rendering editors\n *\n * ```js\n *  const editor = editron.createEditor(\"#\", document.querySelector(\"#editor\"));\n *  // render from title only: editron.createEditor(\"#/title\", document.querySelector(\"#title\"));\n * ```\n *\n * to fetch the generated data use\n *\n * ```js\n *  const data = editron.getData();\n * ```\n *\n * @param  {Object} schema          - json schema describing required data/form template\n * @param  {Any} data               - initial data for given json-schema\n * @param  {Object} [options]       - configuration options\n * @param  {Array} options.editors  - list of editron-editors/widgets to use. Order defines editor to use\n *      (based on editorOf-method)\n */\nclass Controller {\n    constructor(schema = {}, data = {}, options = {}) {\n        schema = UISchema.extendSchema(schema);\n\n        this.options = Object.assign({\n            editors: [\n                ...plugin.getEditors(),\n                require(\"./editors/oneofeditor\"),\n                require(\"./editors/arrayeditor\"),\n                require(\"./editors/objecteditor\"),\n                require(\"./editors/valueeditor\")\n            ]\n        }, options);\n\n        this.editors = this.options.editors;\n        this.state = new State();\n        this.instances = {};\n        this.core = new Core();\n\n        plugin.getValidators().forEach(([validationType, ...validator]) => {\n            try {\n                if (validationType === \"format\") {\n                    return this.addFormatValidator(...validator);\n                } else if (validationType === \"keyword\") {\n                    return this.addKeywordValidator(...validator);\n                }\n                throw new Error(`Unknown validation type '${validationType}'`);\n            } catch(e) {\n                console.log(\"Error:\", e.message);\n            }\n        });\n\n        this.schemaService = new SchemaService(schema, data, this.core);\n        this.validationService = new ValidationService(this.state, schema, this.core);\n        // enable i18n error-translations\n        this.validationService.setErrorHandler((error) => i18n.translateError(this, error));\n        // merge given data with template data\n        data = this.schemaService.addDefaultData(data, schema);\n        this.dataService = new DataService(this.state, data);\n        // start validation after data has been updated\n        this.onAfterDataUpdate = this.dataService\n            .on(DataService.EVENTS.AFTER_UPDATE, this.onAfterDataUpdate.bind(this));\n        // run initial validation\n        this.validateAll();\n    }\n\n    resetUndoRedo() {\n        this.dataService.resetUndoRedo();\n    }\n\n    /**\n     * Helper to create dom elements via mithril syntax\n     *\n     * @param  {String} selector    - a css selector describing the desired element\n     * @param  {Object} attributes  - a map of dom attribute:value of the element (reminder className = class)\n     * @return {HTMLDomElement} the resulting DOMHtml element (not attached)\n     */\n    createElement(selector, attributes) { // eslint-disable-line class-methods-use-this\n        return _createElement(selector, attributes);\n    }\n\n    /**\n     * The only entry point to create editors.\n     * Use in application and from editors to create (delegate) child editors\n     *\n     * @param  {String} pointer         - data pointer to editor in current state\n     * @param  {HTMLElement} element    - parent element of create editor. Will be appended automatically\n     * @param  {Object} [options]       - individual editor options\n     * @return {Object|undefined} created editor-instance or undefined;\n     */\n    createEditor(pointer, element, options) {\n        if (pointer == null || element == null) {\n            throw new Error(`Missing ${pointer == null ? \"pointer\" : \"element\"} in createEditor`);\n        }\n\n        assertValidPointer(pointer);\n\n        // merge schema[\"editron:ui\"] object with options. options precede\n        const instanceOptions = Object.assign(\n            { id: getID(pointer), pointer },\n            UISchema.copyOptions(pointer, this),\n            options\n        );\n\n        // find a matching editor\n        const Editor = selectEditor(this.getEditors(), pointer, this, instanceOptions);\n        if (Editor === false) {\n            return undefined;\n        }\n\n        if (Editor === undefined) {\n            console.warn(`Could not resolve an editor for ${pointer}`, this.schema().get(pointer));\n            return undefined;\n        }\n\n        // iniitialize editor and save editor in list\n        // @TODO loose reference to destroyed editors\n        const editor = new Editor(pointer, this, instanceOptions);\n        element.appendChild(editor.toElement());\n        this.addInstance(pointer, editor);\n\n        return editor;\n    }\n\n    /**\n     * Call this method, when your editor is destroyed, deregistering its instance on editron\n     * @param  {Instance} editor    - editor instance to remove\n     */\n    removeInstance(editor) {\n        // controller inserted child and removes it here again\n        const $element = editor.toElement();\n        if ($element.parentNode) {\n            $element.parentNode.removeChild($element);\n        }\n\n        removeEditorFrom(this.instances, editor);\n    }\n\n    addInstance(pointer, editor) {\n        this.instances[pointer] = this.instances[pointer] || [];\n        this.instances[pointer].push(editor);\n    }\n\n    /**\n     * Request to insert a child item (within the data) at the given pointer. If multiple options are present, a\n     * dialogue is opened to let the user select the appropriate type of child (oneof).\n     * @param {String} pointer  - to array on which to insert the child\n     * @param {Number} index    - index within array, where the child should be inserted (does not replace). Default: 0\n     */\n    addItemTo(pointer, index = 0) {\n        addItem(this.data(), this.schema(), pointer, index);\n        LocationService.goto(gp.join(pointer, index, true));\n    }\n\n    /**\n     * Get or update data from a pointer\n     * @return {DataService} DataService instance\n     */\n    data() { return this.dataService; }\n\n    /**\n     * Get the json schema from a pointer or replace the schema\n     * @return {SchemaService} SchemaService instance\n     */\n    schema() { return this.schemaService; }\n\n    /**\n     * Validate data based on a json-schema and register to generated error events\n     *\n     * - start validation\n     * - get your current errors at _pointer_\n     * - hook into validation to receive your errors at _pointer_\n     *\n     * @return {ValidationService} ValidationService instance\n     */\n    validator() { return this.validationService; }\n\n    /**\n     * ## Usage\n     *  goto(pointer) - Jump to given json pointer. This might also load another page if the root property changes.\n     *  setCurrent(pointer) - Update current pointer, but do not jump to target\n     *\n     * @return {Object} LocationService-Singleton\n     */\n    location() { return LocationService; }\n\n    /**\n     * Set the application data\n     * @param {Any} data    - json data matching registered json-schema\n     */\n    setData(data) {\n        data = this.schemaService.addDefaultData(data);\n        this.data().set(\"#\", data);\n    }\n\n    /**\n     * @param {JsonPointer} [pointer=\"#\"] - location of data to fetch. Defaults to root (all) data\n     * @return {Any} data at the given location\n     */\n    getData(pointer = \"#\") {\n        return this.data().get(pointer);\n    }\n\n    /**\n     * @return {Array} registered editor-widgets used to edit the json-data\n     */\n    getEditors() { return this.editors; }\n\n    /**\n     * @return {Object} currently active editor/widget instances\n     */\n    getInstances() { return this.instances; }\n\n    /**\n     * @param {String} format       - value of _format_\n     * @param {Function} validator  - validator function receiving (core, schema, value, pointer). Return `undefined`\n     *      for a valid _value_ and an object `{type: \"error\", message: \"err-msg\", data: { pointer }}` as error. May\n     *      als return a promise\n     */\n    addFormatValidator(format, validator) {\n        addValidator.format(this.core, format, validator);\n    }\n\n    /**\n     * @param {String} datatype     - JSON-Schema datatype to register attribute, e.g. \"string\" or \"object\"\n     * @param {String} keyword      - custom keyword\n     * @param {Function} validator  - validator function receiving (core, schema, value, pointer). Return `undefined`\n     *      for a valid _value_ and an object `{type: \"error\", message: \"err-msg\", data: { pointer }}` as error. May\n     *      als return a promise\n     */\n    addKeywordValidator(datatype, keyword, validator) {\n        addValidator.keyword(this.core, datatype, keyword, validator);\n    }\n\n    /**\n     * Change the new schema for the current data\n     * @param {Object} schema   - a valid json-schema\n     */\n    setSchema(schema) {\n        schema = UISchema.extendSchema(schema);\n        this.validationService.set(schema);\n        this.schemaService.setSchema(schema);\n    }\n\n    // update data in schema service\n    update() {\n        this.schemaService.setData(this.dataService.get());\n    }\n\n    /**\n     * Starts validation of current data\n     */\n    validateAll() {\n        setTimeout(() =>\n            this.destroyed !== true && this.validationService.validate(this.dataService.getDataByReference())\n        );\n    }\n\n    /**\n     * Destroy the editor, its widgets and services\n     */\n    destroy() {\n        // delete all editors\n        Object.keys(this.instances).forEach((pointer) => {\n            this.instances[pointer] && this.instances[pointer].forEach((instance) => instance.destroy());\n        });\n\n        this.destroyed = true;\n        this.instances = {};\n        this.schemaService.destroy();\n        this.validationService.destroy();\n        this.dataService.destroy();\n        this.dataService.off(DataService.EVENTS.AFTER_UPDATE, this.onAfterDataUpdate);\n    }\n\n    onAfterDataUpdate() {\n        this.update();\n        this.validateAll();\n    }\n\n    changePointer(newPointer, editor) {\n        removeEditorFrom(this.instances, editor);\n        this.addInstance(newPointer, editor);\n    }\n}\n\n\nmodule.exports = Controller;\n","const m = require(\"mithril\");\nconst ContainerHeader = require(\"../containerheader\");\nconst ContainerErrors = require(\"../containererrors\");\nconst ContainerDescription = require(\"../containerdescription\");\n\n\n/**\n * @view ContainerView\n *\n * A Container Component is used for any non-value like object or arrays. They hold other values. This group may expose\n * a group-title and errors. Any childnodes must go to the container '.jed-container__children'.\n *\n * @type {Object}\n */\nconst ContainerView = {\n\n    childContainerSelector: \".editron-container__children\",\n\n    getChildContainer($element) {\n        const $childContainer = $element.querySelector(ContainerView.childContainerSelector);\n        if ($childContainer == null) {\n            throw new Error(\"Container-Component hast not yet been rendered\");\n        }\n        return $childContainer;\n    },\n\n    view(vnode) {\n        return [\n            vnode.attrs.hideTitle === true ? null : m(ContainerHeader, vnode.attrs),\n            m(ContainerDescription, vnode.attrs),\n            vnode.children,\n            m(ContainerErrors, vnode.attrs),\n            m(this.childContainerSelector)\n        ];\n    }\n};\n\nmodule.exports = ContainerView;\n","const m = require(\"mithril\");\nconst populated = require(\"../../utils/populated\");\n\n\n/**\n * @name   ContainerDescription\n * @description\n * Mithril Component to render a description\n *\n * # Usage\n *\n * render by\n *\n * ```js\n *  m(ContainerDescription, { description: \"description\" }\n * ```\n *\n * which will result in a html-node like\n *\n * ```html\n *  <div class=\"editron-container__description mmf-meta\">\"description\"</div>\n * ```\n *\n * @type {Object} m.render(ContainerDescription)\n * @param {String|Object} description  - html string or mithril-vnode of a description\n */\nmodule.exports = {\n    view(vnode) {\n        return populated(vnode.attrs.description,\n            m(\".editron-container__description.mmf-meta\", m.trust(vnode.attrs.description))\n        );\n    }\n};\n","const m = require(\"mithril\");\n\n\nmodule.exports = {\n    view(vnode) {\n        if (Array.isArray(vnode.attrs.errors) === false || vnode.attrs.errors.length === 0) {\n            return null;\n        }\n\n        return m(\"ul.editron-container__errors\", vnode.attrs.errors.map((error) =>\n            m(\"li\", { \"class\": `is-${error.severity || \"error\"}` }, error.message)\n        ));\n    }\n};\n","const m = require(\"mithril\");\nconst getID = require(\"../../utils/getID\");\nconst populated = require(\"../../utils/populated\");\n\n\nfunction getClass({ title, icon, hasAction }) {\n    let classname = `${title ? \"withTitle\" : \"noTitle\"}`;\n    classname += ` ${hasAction ? \"withActions\" : \"noActions\"}`;\n    classname += ` ${icon ? \"withIcon\" : \"noIcon\"}`;\n    return classname;\n}\n\n\nmodule.exports = {\n    view(vnode) {\n        const attrs = Object.assign({\n            pointer: \"\",\n            icon: \"\",\n            title: \"\"\n            // onadd\n            // ondelete\n            // onmoveup\n            // onmovedown\n        }, vnode.attrs);\n\n        attrs.hasAction = attrs.onadd || attrs.ondelete || attrs.onmoveup || attrs.onmovedown;\n\n\n        return m(\".editron-container__header\",\n            {\n                \"class\": getClass(attrs),\n                name: getID(attrs.pointer)\n            },\n\n            m(\".editron-container__title\",\n                populated(vnode.attrs.icon, m(\"i.mmf-icon\", attrs.icon)),\n                (!attrs.hideTitle) && m(\"h2\", attrs.title)\n            ),\n\n            m(\".editron-container__actions\",\n                attrs.onmoveup ? m(\"i.mmf-icon.mmf-icon--add\", {\n                    onclick: attrs.onmoveup\n                }, \"arrow_upward\") : \"\",\n\n                attrs.onmovedown ? m(\"i.mmf-icon.mmf-icon--add\", {\n                    onclick: attrs.onmovedown\n                }, \"arrow_downward\") : \"\",\n\n                attrs.onadd ? m(\"i.mmf-icon.mmf-icon--add\", {\n                    onclick: () => attrs.onadd()\n                }, \"add\") : \"\",\n\n                attrs.ondelete ? m(\"i.mmf-icon.mmf-icon--delete\", {\n                    onclick: attrs.ondelete\n                }, \"delete\") : \"\"\n            )\n        );\n    }\n};\n","module.exports = {\n    container: require(\"./container\"),\n    containerdescription: require(\"./containerdescription\"),\n    containererrors: require(\"./containererrors\"),\n    containerheader: require(\"./containerheader\"),\n    overlay: require(\"./overlay\"),\n    // overlayjson: require(\"./overlayjson\"),\n    overlayselecttiles: require(\"./overlayselecttiles\")\n};\n","const m = require(\"mithril\");\nconst Button = require(\"mithril-material-forms\").button;\n\n\nmodule.exports = {\n\n    /**\n     * @View mithril\n     * Content overlay\n     *\n     * @param  {VNode} vnode                        - mithril virtual node\n     * @param  {VNode.attrs.container} container    - parent container\n     * @return {Object} virtual node\n     */\n    view(vnode) {\n        return m(\"section.ui-overlay__card\",\n            {\n                \"class\": vnode.attrs.fullscreen ? \"ui-overlay__card--fullscreen\" : null\n            },\n            vnode.attrs.header ? m(\".ui-card__header\",\n                m(\"h1\", vnode.attrs.header)\n            ) : \"\",\n            m(\".ui-card__content\",\n                {\n                    oncreate: (contentNode) => contentNode.dom.appendChild(vnode.attrs.container)\n                }\n            ),\n            m(\".ui-card__footer\",\n                m(Button,\n                    {\n                        onClick: vnode.attrs.onAbort\n                    },\n                    vnode.attrs.titleAbort\n                ),\n                vnode.attrs.showSave ? m(Button,\n                    {\n                        onClick: vnode.attrs.onSave\n                    },\n                    \"Speichern\"\n                ) : \"\"\n            )\n        );\n    }\n};\n","const m = require(\"mithril\");\n\n\nconst Tile = {\n    view(vnode) {\n        return m(\".editron-form-box\",\n            {\n                \"data-value\": vnode.attrs.value,\n                \"data-type\": vnode.attrs.title.toLowerCase() // @uitest\n            },\n            m(\".editron-form-box__content\",\n                m(\".editron-form-box__title\",\n                    [\n                        vnode.attrs.icon ? m(\".mmf-icon\", vnode.attrs.icon) : \"\",\n                        vnode.attrs.title\n                    ]\n                ),\n                m(\".editron-form-box__description\", vnode.attrs.description)\n            )\n        );\n    }\n};\n\n\nfunction getDataValue(node) {\n    while (\n        node.parentNode &&\n        node.getAttribute(\"data-value\") == null &&\n        node.className.includes(\"editron-form-tiles\") === false\n    ) {\n        node = node.parentNode;\n    }\n    return node.getAttribute(\"data-value\");\n}\n\n/**\n * @View mithril\n * Overlay content to pick options. Displayed as tiles\n * @type {Object}\n */\nmodule.exports = {\n    view(vnode) {\n        const attrs = Object.assign({\n            value: 0,\n            options: [{ title: \"Keine Optionen angegeben\", value: false }],\n            onchange: Function.prototype\n        }, vnode.attrs);\n\n        return m(\".editron-form-tiles\",\n            {\n                onclick: (e) => {\n                    const value = getDataValue(e.target);\n                    if (value) { // e.target can be the container element with no \"data-value\" attribute\n                        attrs.onchange(value);\n                    }\n                }\n            },\n            attrs.options.map((tile) =>\n                m(Tile, {\n                    active: attrs.value === tile.value,\n                    title: tile.title,\n                    icon: tile.icon,\n                    description: m.trust(tile.description), // allow html\n                    value: tile.value\n                })\n            )\n        );\n    }\n};\n","function getTypeClass(schema) {\n    return schema.type === \"array\" || schema.type === \"object\" ? schema.type : \"value\";\n}\n\n\n/**\n * This is an optional base class for a custom editor. Inheriting from AbstractEditor will setup most required\n * editor-methods to work by default, while still allowing custom implementations. Most of all, it removes\n * the tedious and redundant controller/serivce/pointer bootstraping.\n *\n * Still required is\n *\n *      1. a custom `static editorOf(p, c, o)`-method, to register on a schema\n *      2. an `update(patch)`-method to respond to changes of the data at _pointer_\n *      3. a custom `updatePointer(newPointer)`-method to respond to changes in the location of the editor. Most of\n *          times, the pointer will be used in rendering and/or when creating child-editors. Dont forget to call\n *          `super.updatePointer(newPointer)`\n *\n * and optionally an `updateErrors(errors)`-method to handle new (or removed) errors.\n *\n * Convenience methods are\n *\n *      - `getData()` to fetch the associated data of the current _pointer_\n *      - `setData(newValue)` to update the associated data of the current _pointer_\n *      - `getSchema()` returning the json-schema of the current _pointer_\n *      - `getErrors()` returning a list of current errors\n *      - `toElement()` gives you the root dom-node for this editor (aka render target)\n *      - `focus()` and `blur()` to manage the selection state of the current input (requires correct placement of _id_)\n *\n * @param {String} pointer          - pointer referencing the current data and schema\n * @param {Controller} controller   - editron controller instance\n * @param {Object} options          - resolved options object\n */\nclass AbstractEditor {\n\n    static editorOf(pointer, controller, options) { // eslint-disable-line\n        throw new Error(\"Missing editorOf-method in custom editor\");\n    }\n\n    constructor(pointer, controller, options) {\n        this.pointer = pointer;\n        this.controller = controller;\n        this.options = options;\n\n        this.dom = this.controller\n            .createElement(`.editron-container.editron-container--${getTypeClass(this.getSchema())}`, options.attrs);\n\n        this.update = controller.data()\n            .observe(pointer, this.update.bind(this), options.notifyNestedChanges === true);\n\n        this.setErrors = controller.validator()\n            .observe(pointer, this.setErrors.bind(this), options.notifyNestedErrors === true);\n\n        this.errors = this.controller.validator()\n            .getErrorsAndWarnings(pointer);\n    }\n\n    update() {\n        throw new Error(\"Missing implemented of method 'update' in custom editor\");\n    }\n\n    updatePointer(newPointer) {\n        const oldPointer = this.pointer;\n\n        this.controller.data().removeObserver(oldPointer, this.update);\n        this.controller.validator().removeObserver(oldPointer, this.setErrors);\n\n        this.pointer = newPointer;\n\n        this.controller.data().observe(newPointer, this.update, this.options.notifyNestedChanges === true);\n        this.setErrors = this.controller.validator().observe(newPointer, this.setErrors);\n\n        return [newPointer, oldPointer];\n    }\n\n    getData() {\n        return this.controller.data().get(this.pointer);\n    }\n\n    setData(data) {\n        return this.controller.data().set(this.pointer, data);\n    }\n\n    getErrors() {\n        return this.errors;\n    }\n\n    getSchema() {\n        return this.controller.schema().get(this.pointer);\n    }\n\n    getPointer() {\n        return this.pointer;\n    }\n\n    focus() {\n        this.controller.location().setCurrent(this.pointer);\n    }\n\n    blur() {\n        this.controller.location().blur(this.pointer);\n    }\n\n    toElement() {\n        return this.dom;\n    }\n\n    destroy() {\n        this.controller.removeInstance(this); // remove editor from editron and our html-element (dom) from the DOM\n        this.controller.data().removeObserver(this.pointer, this.update);\n        this.controller.validator().removeObserver(this.pointer, this._addError);\n        this.controller.validator().off(\"beforeValidation\", this._clearErrors);\n    }\n\n    setErrors(errors) {\n        this.errors = errors;\n        if (this.updateErrors) {\n            this.updateErrors(this.errors);\n        }\n    }\n}\n\n\nmodule.exports = AbstractEditor;\n","const m = require(\"mithril\");\nconst getId = require(\"../utils/getID\");\n\nconst convert = {\n    \"boolean\": (value) => {\n        if (value === \"true\") {\n            return true;\n        }\n        if (value === \"false\") {\n            return false;\n        }\n        return value;\n    },\n    integer: (value) => {\n        const converted = parseInt(value);\n        if (isNaN(converted) === false) {\n            return converted;\n        }\n        return value;\n    },\n    number: (value) => {\n        const converted = parseFloat(value);\n        if (isNaN(converted) === false) {\n            return converted;\n        }\n        return value;\n    }\n};\n\n\n/**\n * Convenience class, which registers required events and base methods for value-editors (not object, array)\n *\n * Usage\n * ```js\n *      MyValueEditor extends AbstractValueEditor {\n *          constructor(pointer, controller, options) {\n *              super(pointer, controller, options);\n *              this.render();\n *          }\n *          render() {\n *              m.render(this.$element, m(MyView, this.viewModel));\n *          }\n *      }\n * ```\n */\nclass AbstractValueEditor {\n\n    static editorOf(pointer, controller) {\n        const schema = controller.schema().get(pointer);\n        return schema.type !== \"object\" && schema.type !== \"array\";\n    }\n\n    /**\n     * #options\n     *      - editorValueType:String - custom type of editor value (added as classname)\n     *      - editorElementProperties:Object - add custom properties to main DOM-element\n     *      - viewModel:Object - viewModel which extends base viewmodel\n     *\n     * @param  {String} pointer         - json pointer to value\n     * @param  {Controller} controller  - json editor controller\n     * @param  {Object} options\n     */\n    constructor(pointer, controller, options) {\n        this.pointer = pointer;\n        this.controller = controller;\n\n        const schema = controller.schema().get(pointer);\n\n        options = Object.assign({\n            viewModel: null,\n            title: null,\n            description: null,\n            editorValueType: schema.enum ? \"select\" : schema.type,\n            editorElementProperties: null\n        }, options);\n\n        // create main DOM-element for view-generation\n        this.$element = controller.createElement(\n            `.editron-value.editron-value--${options.editorValueType}`,\n            Object.assign({\n                name: getId(pointer)\n            }, options.attrs)\n        );\n\n        // use this model to generate the view. may be customized with `options.viewModel`\n        this.viewModel = Object.assign({\n            pointer,\n            id: getId(pointer),\n            title: options.title,\n            description: options.description,\n            value: controller.data().get(pointer),\n            instantUpdate: options.instantUpdate,\n            schema,\n            errors: controller.validator().getErrorsAndWarnings(pointer),\n            onfocus: () => controller.location().setCurrent(pointer),\n            onblur: () => controller.location().blur(pointer),\n            onchange: (value) => {\n                if (convert[schema.type]) {\n                    value = convert[schema.type](value);\n                }\n                this.setValue(value);\n            }\n        }, options.viewModel);\n\n        // in order to deregister callbacks in destroy(), bind all callbacks to this class\n        this.update = controller.data().observe(pointer, this.update.bind(this));\n        this.setErrors = controller.validator().observe(pointer, this.setErrors.bind(this));\n\n        // this.render();\n    }\n\n    getPointer() {\n        return this.pointer;\n    }\n\n    updatePointer(pointer) {\n        if (pointer === this.pointer) {\n            return;\n        }\n\n        this.controller.changePointer(pointer, this);\n\n        const oldPointer = this.pointer;\n        this.$element.setAttribute(\"name\", `editor-${pointer}`);\n        this.pointer = pointer;\n        this.viewModel.pointer = pointer;\n        this.viewModel.id = getId(pointer);\n        this.viewModel.onfocus = () => this.controller.location().setCurrent(pointer);\n        this.controller.data().removeObserver(oldPointer, this.update);\n        this.controller.validator().removeObserver(oldPointer, this.setErrors);\n        this.controller.data().observe(pointer, this.update);\n        this.controller.validator().observe(pointer, this.setErrors);\n\n        this.update();\n    }\n\n    // update display value in view\n    update() {\n        this.viewModel.value = this.controller.data().get(this.pointer);\n        this.render();\n    }\n\n    // updates value in data-store\n    setValue(value) {\n        this.controller.data().set(this.pointer, value);\n        // do not trigger rendering here. data-observer will notify change event\n    }\n\n    // adds an error to view\n    setErrors(errors) {\n        this.viewModel.errors = errors;\n        this.render();\n    }\n\n    // update view\n    render() {\n        // this.$element.innerHTML = \"<b>Overwrite AbstractValueEditor.render() to generate your view</b>\";\n        m.render(this.$element, m(\"b\", \"Overwrite AbstractValueEditor.render() to generate view\"));\n    }\n\n    // return main dom element\n    toElement() {\n        return this.$element;\n    }\n\n    // destroy this editor\n    destroy() {\n        if (this.viewModel) {\n            this.controller.removeInstance(this);\n\n            // destroy this editor only once\n            m.render(this.$element, m(\"i\"));\n\n            this.viewModel = null;\n            this.controller.data().removeObserver(this.pointer, this.update);\n            this.controller.validator().removeObserver(this.pointer, this.setErrors);\n            this.$element = null;\n        }\n    }\n}\n\n\nmodule.exports = AbstractValueEditor;\n","const m = require(\"mithril\");\nconst gp = require(\"gson-pointer\");\nconst ArrayItemView = require(\"./ArrayItemView\");\nconst arrayUtils = require(\"../../utils/array\");\n\n\nclass ArrayItemEditor {\n\n    constructor(pointer, controller, options = {}) {\n        // eslint-disable-next-line max-len\n        this.$element = controller.createElement(\".editron-container__child.editron-container__child--array-item\", options.attrs);\n        this.controller = controller;\n\n        this.onAdd = () => this.add();\n        this.onRemove = () => this.remove();\n\n        this.viewModel = Object.assign({\n            onadd: this.onAdd,\n            onremove: this.onRemove,\n            onmove: (index) => this.move(index)\n        }, options);\n\n        this.render();\n\n        const $target = this.$element.querySelector(ArrayItemView.editorTarget);\n        this.editor = controller.createEditor(pointer, $target, {\n            ondelete: this.onRemove\n        });\n\n        this.updatePointer(pointer);\n    }\n\n    render() {\n        m.render(this.$element, m(ArrayItemView, this.viewModel));\n    }\n\n    add() {\n        arrayUtils.addItem(this.parentPointer, this.controller, this.viewModel.index + 1);\n    }\n\n    remove() {\n        arrayUtils.removeItem(this.parentPointer, this.controller, this.viewModel.index);\n    }\n\n    move(to) {\n        arrayUtils.moveItem(this.parentPointer, this.controller, this.viewModel.index, to);\n    }\n\n    updatePointer(newPointer) {\n        this.parentPointer = gp.join(newPointer, \"..\", true);\n        this.viewModel.index = ArrayItemEditor.getIndex(newPointer);\n        this.viewModel.pointer = newPointer;\n        this.viewModel.length = this.controller.data().get(this.parentPointer).length;\n        this.render();\n        this.editor && this.editor.updatePointer(newPointer);\n    }\n\n    toElement() {\n        return this.$element;\n    }\n\n    getPointer() {\n        return this.viewModel.pointer;\n    }\n\n    destroy() {\n        if (this.viewModel) {\n            this.viewModel = null;\n            this.editor && this.editor.destroy();\n            this.$element.parentNode && this.$element.parentNode.removeChild(this.$element);\n        }\n    }\n\n    static getIndex(pointer) {\n        const parentPointer = gp.join(pointer, \"..\");\n        return parseInt(pointer.replace(`${parentPointer}/`, \"\"));\n    }\n}\n\n\nmodule.exports = ArrayItemEditor;\n","const m = require(\"mithril\");\n\n\nconst ArrayItemView = {\n\n    editorTarget: \".editron-item\",\n\n    view(vnode) {\n        const canRemove = vnode.attrs.minItems < vnode.attrs.length;\n        const canAdd = vnode.attrs.maxItems > vnode.attrs.length;\n        const showIndex = vnode.attrs.showIndex === true;\n\n        return [\n            // CONTROLS\n            m(\"ul.editron-container__controls.editron-container__controls--child\",\n                (vnode.attrs.move === false || vnode.attrs.index === 0) ? \"\" : m(\"li\",\n                    { onclick: () => vnode.attrs.onmove(vnode.attrs.index - 1) },\n                    m(\"i.mmf-icon\", \"arrow_upward\")\n                ),\n                (vnode.attrs.move === false || vnode.attrs.index === vnode.attrs.length - 1) ? \"\" : m(\"li\",\n                    { onclick: () => vnode.attrs.onmove(vnode.attrs.index + 1) },\n                    m(\"i.mmf-icon\", \"arrow_downward\")\n                ),\n                (vnode.attrs.remove && vnode.attrs.ondelete && canRemove) ? m(\"li\",\n                    { onclick: () => vnode.attrs.ondelete(vnode.attrs.index) },\n                    m(\"i.mmf-icon\", \"delete\")\n                ) : \"\",\n                (vnode.attrs.add && vnode.attrs.onadd && canAdd) ? m(\"li\",\n                    { onclick: () => vnode.attrs.onadd(vnode.attrs.index) },\n                    m(\"i.mmf-icon\", \"add\")\n                ) : \"\"\n            ),\n\n            // TARGET CONTAINER FOR EDITOR\n            m(this.editorTarget, {\n                \"data-index\": `${vnode.attrs.index + 1} / ${vnode.attrs.length}`,\n                \"class\": [\n                    canRemove ? \"has-remove-enabled\" : \"has-remove-disabled\",\n                    canAdd ? \"has-add-enabled\" : \"has-add-disabled\",\n                    showIndex ? \"with-index\" : \"\"\n                ].join(\" \").trim()\n            }),\n\n            // ADD BUTTON\n            (vnode.attrs.insert && canAdd) ? m(\".editron-container__separator.mmf-row\",\n                m(\".editron-container__button--add\",\n                    {\n                        onclick: (e) => {\n                            e.preventDefault();\n                            vnode.attrs.onadd && vnode.attrs.onadd(vnode.attrs.index);\n                        }\n                    },\n                    m(\"i.mmf-icon\", \"add_circle\")\n                )\n            ) : \"\"\n        ];\n    }\n};\n\n\nmodule.exports = ArrayItemView;\n","const m = require(\"mithril\");\nconst ArrayItemEditor = require(\"./ArrayItemEditor\");\nconst diffpatch = require(\"../../services/utils/diffpatch\");\nconst View = require(\"../../components/container\");\n\n\nclass ArrayEditor {\n\n    static editorOf(pointer, controller) {\n        const schema = controller.schema().get(pointer);\n        return schema.type === \"array\";\n    }\n\n    constructor(pointer, controller, options = {}) {\n        // add id to element, since no other input-form is associated with this editor\n        options.attrs = Object.assign({ id: options.id }, options.attrs);\n        const schema = controller.schema().get(pointer);\n        const data = controller.data().get(pointer);\n\n        this.onAdd = (index = 0) => controller.addItemTo(this.pointer, index);\n\n        this.$element = controller.createElement(\".editron-container.editron-container--array.withAddButton\", options.attrs);\n        this.controller = controller;\n        this.pointer = pointer;\n        this.children = [];\n        this.viewModel = Object.assign({\n            pointer,\n            attrs: {},\n            errors: controller.validator().getErrorsAndWarnings(pointer),\n            onadd: this.onAdd,\n            length: data.length,\n            maxItems: schema.maxItems || Infinity,\n            minItems: schema.minItems || 0\n        }, options);\n\n        this.viewModel.controls = Object.assign({\n            add: false,\n            remove: true,\n            move: true,\n            insert: true,\n            showIndex: options[\"array:index\"] === true,\n            maxItems: schema.maxItems || Infinity,\n            minItems: schema.minItems || 0\n        }, options.controls);\n\n        this.updateView = controller.data().observe(pointer, this.updateView.bind(this));\n        this.setErrors = controller.validator().observe(pointer, this.setErrors.bind(this));\n\n        this.render();\n        this.$items = this.$element.querySelector(View.childContainerSelector);\n        this.rebuildChildren();\n        this.updateControls();\n    }\n\n    update() {\n        this.rebuildChildren();\n        this.updateControls();\n    }\n\n    updatePointer(newPointer) {\n        if (this.pointer === newPointer) {\n            return;\n        }\n\n        this.controller.changePointer(newPointer, this);\n\n        const previousPointer = this.pointer;\n        this.pointer = newPointer;\n        this.viewModel.pointer = newPointer;\n        this.viewModel.attrs.id = newPointer;\n\n        this.controller.data().removeObserver(previousPointer, this.updateView);\n        this.controller.validator().removeObserver(previousPointer, this.setErrors);\n        this.controller.data().observe(newPointer, this.updateView);\n        this.controller.validator().observe(newPointer, this.setErrors);\n\n        this.children.forEach((child, index) => child.updatePointer(`${newPointer}/${index}`));\n        this.render();\n    }\n\n    updateView(changeEvent) {\n        if (changeEvent && changeEvent.patch) {\n            this.applyPatches(changeEvent.patch);\n        } else {\n            this.rebuildChildren();\n        }\n        this.updateControls();\n    }\n\n    applyPatches(patch) {\n        // fetch a copy of the original list\n        const originalChildren = this.children.slice(0);\n        // and patch the current list\n        diffpatch.patch(this.children, patch);\n\n        // search for inserted children\n        this.children.forEach((child, index) => {\n            if (child instanceof ArrayItemEditor === false) {\n                const newChild = new ArrayItemEditor(`${this.pointer}/${index}`, this.controller, this.viewModel.controls);\n                // @insert?\n                this.children[index] = newChild;\n            }\n        });\n\n        // search for removed children\n        originalChildren.forEach((child) => {\n            if (this.children.indexOf(child) === -1) {\n                child.destroy();\n            }\n        });\n\n        // update view: move and inserts nodes\n        const currentLocation = this.controller.location().getCurrent();\n\n        for (let i = 0, l = this.children.length; i < l; i += 1) {\n            const previousPointer = this.children[i].getPointer();\n            const currentPointer = `${this.pointer}/${i}`;\n\n            // update current location\n            if (currentLocation.indexOf(previousPointer) === 0) {\n                this.controller.location().setCurrent(currentLocation.replace(previousPointer, currentPointer));\n            }\n\n            // update child views to match patched list\n            this.children[i].updatePointer(currentPointer);\n            if (this.$items.children[i] === this.children[i].toElement()) {\n                // skip moving node, already in place\n                continue;\n            } else if (i + 1 < this.$items.children.length) {\n                // move node to correct position\n                this.$items.insertBefore(this.children[i].toElement(), this.$items.children[i + 1]);\n            } else {\n                // remaining nodes may be simply appended\n                this.$items.appendChild(this.children[i].toElement());\n            }\n        }\n    }\n\n    rebuildChildren() {\n        const data = this.controller.data().get(this.pointer);\n\n        // delete all child editors\n        this.children.forEach((editor) => editor.destroy());\n        this.children.length = 0;\n        this.$items.innerHTML = \"\";\n\n        // recreate child editors\n        data.forEach((item, index) => {\n            const childPointer = `${this.pointer}/${index}`;\n            const childEditor = new ArrayItemEditor(childPointer, this.controller, this.viewModel.controls);\n            this.$items.appendChild(childEditor.toElement());\n            this.children.push(childEditor);\n        });\n    }\n\n    updateControls() {\n        this.viewModel.length = this.children.length;\n        this.viewModel.onadd = this.viewModel.maxItems > this.children.length ? this.onAdd : false;\n\n        this.$element.classList.toggle(\"has-add-disabled\", this.viewModel.maxItems <= this.children.length);\n        this.$element.classList.toggle(\"has-remove-disabled\", this.viewModel.minItems >= this.children.length);\n    }\n\n    getPointer() {\n        return this.pointer;\n    }\n\n    setErrors(errors) {\n        this.viewModel.errors = errors;\n        this.render();\n    }\n\n    render() {\n        m.render(this.$element, m(View, this.viewModel));\n    }\n\n    toElement() {\n        return this.$element;\n    }\n\n    destroy() {\n        if (this.viewModel) {\n            this.controller.removeInstance(this);\n\n            this.viewModel = null;\n            m.render(this.$element, m(\"i\"));\n            this.controller.data().removeObserver(this.pointer, this.updateView);\n            this.controller.validator().removeObserver(this.pointer, this.setErrors);\n            this.children.forEach((editor) => editor.destroy());\n        }\n    }\n}\n\n\nmodule.exports = ArrayEditor;\n","module.exports = {\n    AbstractEditor: require(\"./AbstractEditor\"),\n    AbstractValueEditor: require(\"./AbstractValueEditor\"),\n    ArrayEditor: require(\"./arrayeditor\"),\n    ObjectEditor: require(\"./objecteditor\"),\n    OneOfEditor: require(\"./oneofeditor\"),\n    ValueEditor: require(\"./valueeditor\")\n};\n","const m = require(\"mithril\");\nconst TextareaForm = require(\"mithril-material-forms/components/textareaform\");\nconst OverlayService = require(\"../../services/OverlayService\");\nconst View = require(\"../../components/container\");\n\n\nfunction showJSON(controller, data, title) {\n    const element = controller.createElement(\".overlay__item.overlay__item--json\");\n    OverlayService.open(element, { ok: true, save: false });\n    // render textarea after it is injected into dom, to correctly update textarea size\n    m.render(element, m(TextareaForm, { title, value: JSON.stringify(data, null, 4) }));\n}\n\n\nclass ObjectEditor {\n\n    static editorOf(pointer, controller) {\n        const schema = controller.schema().get(pointer);\n        return schema.type === \"object\";\n    }\n\n    constructor(pointer, controller, options = {}) {\n        // add id to element, since no other input-form is associated with this editor\n        options.attrs = Object.assign({ id: options.id }, options.attrs);\n\n        this.$element = controller.createElement(\".editron-container.editron-container--object\", options.attrs);\n        this.pointer = pointer;\n        this.options = options;\n        this.controller = controller;\n        this.childEditors = [];\n        this.viewModel = Object.assign({\n            pointer,\n            icon: options.icon,\n            errors: [],\n            attrs: {},\n            hideTitle: options.hideTitle,\n            title: options.title,\n            description: options.description\n        }, options);\n\n        if (options.addDelete) {\n            this.viewModel.ondelete = () => controller.data().delete(pointer);\n        }\n\n        this.rebuildChildren = controller.data().observe(pointer, this.rebuildChildren.bind(this));\n        this.setErrors = controller.validator().observe(pointer, this.setErrors.bind(this));\n\n        this.setErrors(controller.validator().getErrorsAndWarnings(pointer));\n        this.render();\n        this.$children = this.$element.querySelector(View.childContainerSelector);\n        this.rebuildChildren();\n    }\n\n    updatePointer(pointer) {\n        if (this.pointer === pointer || this.viewModel == null) {\n            return;\n        }\n\n        this.controller.changePointer(pointer, this);\n\n        const oldPointer = this.pointer;\n        this.$element.id = pointer;\n\n        const controller = this.controller;\n        this.options.attrs.id = pointer;\n        this.pointer = pointer;\n        this.viewModel.pointer = pointer;\n        if (this.options.addDelete) {\n            // console.log(\"Update ondelete\", pointer);\n            this.viewModel.ondelete = () => controller.data().delete(pointer);\n        }\n        controller.data().removeObserver(oldPointer, this.rebuildChildren);\n        controller.validator().removeObserver(oldPointer, this.setErrors);\n        controller.data().observe(pointer, this.rebuildChildren);\n        controller.validator().observe(pointer, this.setErrors);\n\n        this.childEditors.forEach((editor) => {\n            editor.updatePointer(`${this.pointer}/${editor._property}`);\n        });\n\n        this.render();\n    }\n\n    update() {\n        this.rebuildChildren();\n    }\n\n    rebuildChildren() {\n        if (this.viewModel == null) {\n            console.error(\"destroyed ObjectEditor receives an update event - this may be invoked through oneOf-Editor\", this);\n            return;\n        }\n\n        // fetch latest data\n        const data = this.controller.data().get(this.pointer);\n        // destroy child editor\n        this.childEditors.forEach((editor) => editor.destroy());\n        this.childEditors.length = 0;\n        // clear html\n        this.$children.innerHTML = \"\";\n        // rebuild children\n        if (data) {\n            Object.keys(data).forEach((property) => {\n                const editor = this.controller.createEditor(`${this.pointer}/${property}`, this.$children);\n                if (editor) {\n                    editor._property = property;\n                    this.childEditors.push(editor);\n                }\n            });\n        }\n\n        this.render();\n    }\n\n    deleteProperty(property) {\n        console.log(\"DELETE PROPERTY\", property);\n        const data = this.controller.data().get(this.pointer);\n        delete data[property];\n        this.controller.data().set(this.pointer, data);\n    }\n\n    showProperty(property) {\n        const propertyData = this.controller.data().get(`${this.pointer}/${property}`);\n        showJSON(this.controller, propertyData, property);\n    }\n\n    setErrors(errors) {\n        // if we receive errors here, a property may be missing (which should go to schema.getTemplate) or additional,\n        // but prohibited properties exist. For the latter, add an option to show and/or delete the property. Within\n        // arrays this should come per default, as the may insert in add items...\n        this.viewModel.errors = errors.map((error) => {\n            if (error.code === \"no-additional-properties-error\") {\n                const message = error.message;\n                const property = error.data.property;\n                return {\n                    severity: error.type || \"error\",\n                    message: m(\".editron-error.editron-error--object-property\",\n                        m(\"span\", m.trust(message)),\n                        m(\"a.mmf-icon\", { onclick: () => this.showProperty(property) }, \"visibility\"),\n                        m(\"a.mmf-icon\", { onclick: () => this.deleteProperty(property) }, \"clear\")\n                    )\n                };\n            }\n            return error;\n        });\n        this.render();\n    }\n\n    render() {\n        m.render(this.$element, m(View, this.viewModel));\n    }\n\n    toElement() {\n        return this.$element;\n    }\n\n    getPointer() {\n        return this.pointer;\n    }\n\n    destroy() {\n        if (this.viewModel) {\n            this.controller.removeInstance(this);\n\n            m.render(this.$element, m(\"i\"));\n            this.controller.data().removeObserver(this.pointer, this.rebuildChildren);\n            this.controller.validator().removeObserver(this.pointer, this.setErrors);\n\n            this.childEditors.forEach((editor) => editor.destroy());\n            this.childEditors.length = 0;\n            this.$children.innerHTML = \"\";\n            this.viewModel = null;\n        }\n    }\n}\n\n\nmodule.exports = ObjectEditor;\n","const m = require(\"mithril\");\nconst gp = require(\"gson-pointer\");\nconst Select = require(\"mithril-material-forms/components/select\");\nconst getId = require(\"../../utils/getID\");\nconst View = require(\"../../components/container\");\nconst UI_PROPERTY = require(\"../../utils/UISchema\").UI_PROPERTY;\n\n\nclass OneOfEditor {\n    static editorOf(pointer, controller, options) {\n        const schema = controller.schema().get(pointer);\n        return schema.oneOfSchema && !schema.items && !options.renderOneOf;\n    }\n\n    constructor(pointer, controller, options) {\n        const childSchema = controller.schema().get(pointer);\n        // @special case. Our options lie in `schema.oneOfSchema`\n        const schema = childSchema.oneOfSchema;\n        const attrs = gp.get(schema, `#/${UI_PROPERTY}/attrs`);\n\n        this.schema = schema;\n        this.childSchema = childSchema;\n\n        // ensure requried titles are set\n        schema.oneOf.forEach((oneOfSchema, index) => (oneOfSchema.title = oneOfSchema.title || `${index}.`));\n\n        this.$element = controller.createElement(\".editron-container.editron-container--oneof\", attrs);\n        this.controller = controller;\n        this.pointer = pointer;\n        this.viewModel = {\n            id: getId(pointer),\n            pointer,\n            options: schema.oneOf.map((oneOf, index) => ({ title: oneOf.title, value: index })),\n            onchange: (oneOfIndex) => {\n                this.changeChild(schema.oneOf[oneOfIndex]);\n            },\n            value: this.getIndexOf(childSchema),\n            title: schema.title,\n            description: schema.description\n        };\n\n        // use bubble=true to catch inner changes (changes are compared by a diff which may not notify parent pointer)\n        this.update = controller.data().observe(pointer, this.update.bind(this), true);\n\n        this.render();\n        this.$childContainer = this.$element.querySelector(View.childContainerSelector);\n        this.rebuild();\n    }\n\n    changeChild(schema) {\n        this.childEditor && this.childEditor.destroy();\n        const data = this.controller.schema().getTemplate(schema);\n        this.controller.data().set(this.pointer, data);\n    }\n\n    getIndexOf(currentSchema) {\n        for (let i = 0, l = this.schema.oneOf.length; i < l; i += 1) {\n            if (this.schema.oneOf[i].title === currentSchema.title) {\n                return i;\n            }\n        }\n        return 0;\n    }\n\n    updatePointer(newPointer) {\n        const oldPointer = this.getPointer();\n        if (oldPointer === newPointer) {\n            return;\n        }\n\n        this.controller.changePointer(newPointer, this);\n\n        this.pointer = newPointer;\n        this.viewModel.id = getId(newPointer);\n        this.viewModel.pointer = newPointer;\n        this.$element.id = newPointer;\n        this.controller.data().removeObserver(oldPointer, this.update);\n        this.controller.data().observe(newPointer, this.update, true);\n\n        if (this.childEditor) {\n            this.childEditor.updatePointer(newPointer);\n        }\n\n        this.render();\n    }\n\n    update() {\n        const currentSchema = this.controller.schema().get(this.pointer);\n        delete currentSchema.oneOfSchema; // is recreated each time\n        if (currentSchema.title === this.childSchema.title) {\n            return;\n        }\n\n        this.viewModel.value = this.getIndexOf(currentSchema);\n        this.childSchema = currentSchema;\n        this.rebuild();\n    }\n\n    rebuild() {\n        this.childEditor && this.childEditor.destroy();\n        this.$childContainer.innerHTML = \"\";\n        this.childEditor = this.controller.createEditor(this.pointer, this.$childContainer, {\n            // @attention this is very important or else we create an infinite loop through selectEditor\n            renderOneOf: true\n        });\n\n        this.render();\n    }\n\n    render() {\n        m.render(this.$element, m(View, this.viewModel,\n            m(\".editron-value\",\n                m(Select, this.viewModel)\n            )\n        ));\n    }\n\n    toElement() {\n        return this.$element;\n    }\n\n    getPointer() {\n        return this.pointer;\n    }\n\n    destroy() {\n        if (this.viewModel) {\n            this.controller.removeInstance(this);\n\n            this.viewModel = null;\n            m.render(this.$element, \"i\");\n            this.controller.data().removeObserver(this.pointer, this.update);\n        }\n    }\n}\n\n\nmodule.exports = OneOfEditor;\n","const m = require(\"mithril\");\n\nconst CheckboxForm = require(\"mithril-material-forms/components/checkboxform\");\nconst SelectForm = require(\"mithril-material-forms/components/selectform\");\nconst TextareaForm = require(\"mithril-material-forms/components/textareaform\");\nconst InputForm = require(\"mithril-material-forms/components/inputform\");\nconst UISchema = require(\"../../utils/UISchema\");\n\n\nfunction chooseInput(attrs) {\n    const schema = attrs.schema;\n    const config = Object.assign({\n        type: schema.type,\n        title: schema.title,\n        description: schema.description,\n        onblur: attrs.onblur || Function.prototype,\n        onfocus: attrs.onfocus || Function.prototype,\n        onchange: attrs.onchange || Function.prototype\n    }, attrs);\n\n    if (schema.enum && schema.enum.length > 0) {\n        config.options = UISchema.enumOptions(schema);\n        return m(SelectForm, config);\n    }\n    if (schema.type === \"boolean\") {\n        return m(CheckboxForm, config);\n    }\n    if (schema.type === \"string\" && schema.format === \"html\") {\n        return m(TextareaForm, config);\n    }\n    if (schema.type === \"string\" && schema.format === \"textarea\") {\n        return m(TextareaForm, config);\n    }\n    return m(InputForm, config);\n}\n\n\nmodule.exports = {\n    view(vnode) {\n        return chooseInput(vnode.attrs);\n    }\n};\n","const m = require(\"mithril\");\nconst View = require(\"./View\");\nconst AbstractValueEditor = require(\"../AbstractValueEditor\");\n\n\nclass ValueEditor extends AbstractValueEditor {\n\n    static editorOf(pointer, controller) {\n        const schema = controller.schema().get(pointer);\n        return schema.type !== \"object\" && schema.type !== \"array\";\n    }\n\n    constructor(pointer, controller, options = {}) {\n        super(pointer, controller, options);\n        this.render();\n    }\n\n    render() {\n        m.render(this.$element, m(View, this.viewModel));\n    }\n}\n\n\nmodule.exports = ValueEditor;\n","/**\n * Editron-Core. Depending on your build setup, use\n *\n * ```js\n * import { Controller } from \"editron\";\n * // or\n * const { Controller } = require(\"editron\");\n * ```\n * to get the editron core entry point for a enjoyable formular world\n *\n *\n * @type {Package} exported methods and utilities\n * @property {Controller} Controller    - the main Editron-Class you want to start all form applications\n * @property {Object} components        - mithril components, for default html-generation of headers and containers\n * @property {Object} editors           - basic editron editors for object, array and simple value reprensentation\n * @property {Object} services          - services to work on data, json-schema, validation and more\n * @property {Object} utils             - utility functions, to generate ids, translate strings and resolve editors\n * @property {Object} plugin            - basic plugin implementation for editor registration\n */\nmodule.exports = {\n    Controller: require(\"./Controller\"),\n    components: require(\"./components\"),\n    editors: require(\"./editors\"),\n    services: require(\"./services\"),\n    utils: require(\"./utils\"),\n    plugin: require(\"./plugin\")\n};\n","module.exports = __webpack_public_path__ + \"editron.css\";","/*!\n\tAutosize 3.0.21\n\tlicense: MIT\n\thttp://www.jacklmoore.com/autosize\n*/\n(function (global, factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(['exports', 'module'], factory);\n\t} else if (typeof exports !== 'undefined' && typeof module !== 'undefined') {\n\t\tfactory(exports, module);\n\t} else {\n\t\tvar mod = {\n\t\t\texports: {}\n\t\t};\n\t\tfactory(mod.exports, mod);\n\t\tglobal.autosize = mod.exports;\n\t}\n})(this, function (exports, module) {\n\t'use strict';\n\n\tvar map = typeof Map === \"function\" ? new Map() : (function () {\n\t\tvar keys = [];\n\t\tvar values = [];\n\n\t\treturn {\n\t\t\thas: function has(key) {\n\t\t\t\treturn keys.indexOf(key) > -1;\n\t\t\t},\n\t\t\tget: function get(key) {\n\t\t\t\treturn values[keys.indexOf(key)];\n\t\t\t},\n\t\t\tset: function set(key, value) {\n\t\t\t\tif (keys.indexOf(key) === -1) {\n\t\t\t\t\tkeys.push(key);\n\t\t\t\t\tvalues.push(value);\n\t\t\t\t}\n\t\t\t},\n\t\t\t'delete': function _delete(key) {\n\t\t\t\tvar index = keys.indexOf(key);\n\t\t\t\tif (index > -1) {\n\t\t\t\t\tkeys.splice(index, 1);\n\t\t\t\t\tvalues.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t})();\n\n\tvar createEvent = function createEvent(name) {\n\t\treturn new Event(name, { bubbles: true });\n\t};\n\ttry {\n\t\tnew Event('test');\n\t} catch (e) {\n\t\t// IE does not support `new Event()`\n\t\tcreateEvent = function (name) {\n\t\t\tvar evt = document.createEvent('Event');\n\t\t\tevt.initEvent(name, true, false);\n\t\t\treturn evt;\n\t\t};\n\t}\n\n\tfunction assign(ta) {\n\t\tif (!ta || !ta.nodeName || ta.nodeName !== 'TEXTAREA' || map.has(ta)) return;\n\n\t\tvar heightOffset = null;\n\t\tvar clientWidth = ta.clientWidth;\n\t\tvar cachedHeight = null;\n\n\t\tfunction init() {\n\t\t\tvar style = window.getComputedStyle(ta, null);\n\n\t\t\tif (style.resize === 'vertical') {\n\t\t\t\tta.style.resize = 'none';\n\t\t\t} else if (style.resize === 'both') {\n\t\t\t\tta.style.resize = 'horizontal';\n\t\t\t}\n\n\t\t\tif (style.boxSizing === 'content-box') {\n\t\t\t\theightOffset = -(parseFloat(style.paddingTop) + parseFloat(style.paddingBottom));\n\t\t\t} else {\n\t\t\t\theightOffset = parseFloat(style.borderTopWidth) + parseFloat(style.borderBottomWidth);\n\t\t\t}\n\t\t\t// Fix when a textarea is not on document body and heightOffset is Not a Number\n\t\t\tif (isNaN(heightOffset)) {\n\t\t\t\theightOffset = 0;\n\t\t\t}\n\n\t\t\tupdate();\n\t\t}\n\n\t\tfunction changeOverflow(value) {\n\t\t\t{\n\t\t\t\t// Chrome/Safari-specific fix:\n\t\t\t\t// When the textarea y-overflow is hidden, Chrome/Safari do not reflow the text to account for the space\n\t\t\t\t// made available by removing the scrollbar. The following forces the necessary text reflow.\n\t\t\t\tvar width = ta.style.width;\n\t\t\t\tta.style.width = '0px';\n\t\t\t\t// Force reflow:\n\t\t\t\t/* jshint ignore:start */\n\t\t\t\tta.offsetWidth;\n\t\t\t\t/* jshint ignore:end */\n\t\t\t\tta.style.width = width;\n\t\t\t}\n\n\t\t\tta.style.overflowY = value;\n\t\t}\n\n\t\tfunction getParentOverflows(el) {\n\t\t\tvar arr = [];\n\n\t\t\twhile (el && el.parentNode && el.parentNode instanceof Element) {\n\t\t\t\tif (el.parentNode.scrollTop) {\n\t\t\t\t\tarr.push({\n\t\t\t\t\t\tnode: el.parentNode,\n\t\t\t\t\t\tscrollTop: el.parentNode.scrollTop\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tel = el.parentNode;\n\t\t\t}\n\n\t\t\treturn arr;\n\t\t}\n\n\t\tfunction resize() {\n\t\t\tvar originalHeight = ta.style.height;\n\t\t\tvar overflows = getParentOverflows(ta);\n\t\t\tvar docTop = document.documentElement && document.documentElement.scrollTop; // Needed for Mobile IE (ticket #240)\n\n\t\t\tta.style.height = 'auto';\n\n\t\t\tvar endHeight = ta.scrollHeight + heightOffset;\n\n\t\t\tif (ta.scrollHeight === 0) {\n\t\t\t\t// If the scrollHeight is 0, then the element probably has display:none or is detached from the DOM.\n\t\t\t\tta.style.height = originalHeight;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tta.style.height = endHeight + 'px';\n\n\t\t\t// used to check if an update is actually necessary on window.resize\n\t\t\tclientWidth = ta.clientWidth;\n\n\t\t\t// prevents scroll-position jumping\n\t\t\toverflows.forEach(function (el) {\n\t\t\t\tel.node.scrollTop = el.scrollTop;\n\t\t\t});\n\n\t\t\tif (docTop) {\n\t\t\t\tdocument.documentElement.scrollTop = docTop;\n\t\t\t}\n\t\t}\n\n\t\tfunction update() {\n\t\t\tresize();\n\n\t\t\tvar styleHeight = Math.round(parseFloat(ta.style.height));\n\t\t\tvar computed = window.getComputedStyle(ta, null);\n\n\t\t\t// Using offsetHeight as a replacement for computed.height in IE, because IE does not account use of border-box\n\t\t\tvar actualHeight = computed.boxSizing === 'content-box' ? Math.round(parseFloat(computed.height)) : ta.offsetHeight;\n\n\t\t\t// The actual height not matching the style height (set via the resize method) indicates that\n\t\t\t// the max-height has been exceeded, in which case the overflow should be allowed.\n\t\t\tif (actualHeight !== styleHeight) {\n\t\t\t\tif (computed.overflowY === 'hidden') {\n\t\t\t\t\tchangeOverflow('scroll');\n\t\t\t\t\tresize();\n\t\t\t\t\tactualHeight = computed.boxSizing === 'content-box' ? Math.round(parseFloat(window.getComputedStyle(ta, null).height)) : ta.offsetHeight;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Normally keep overflow set to hidden, to avoid flash of scrollbar as the textarea expands.\n\t\t\t\tif (computed.overflowY !== 'hidden') {\n\t\t\t\t\tchangeOverflow('hidden');\n\t\t\t\t\tresize();\n\t\t\t\t\tactualHeight = computed.boxSizing === 'content-box' ? Math.round(parseFloat(window.getComputedStyle(ta, null).height)) : ta.offsetHeight;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (cachedHeight !== actualHeight) {\n\t\t\t\tcachedHeight = actualHeight;\n\t\t\t\tvar evt = createEvent('autosize:resized');\n\t\t\t\ttry {\n\t\t\t\t\tta.dispatchEvent(evt);\n\t\t\t\t} catch (err) {\n\t\t\t\t\t// Firefox will throw an error on dispatchEvent for a detached element\n\t\t\t\t\t// https://bugzilla.mozilla.org/show_bug.cgi?id=889376\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tvar pageResize = function pageResize() {\n\t\t\tif (ta.clientWidth !== clientWidth) {\n\t\t\t\tupdate();\n\t\t\t}\n\t\t};\n\n\t\tvar destroy = (function (style) {\n\t\t\twindow.removeEventListener('resize', pageResize, false);\n\t\t\tta.removeEventListener('input', update, false);\n\t\t\tta.removeEventListener('keyup', update, false);\n\t\t\tta.removeEventListener('autosize:destroy', destroy, false);\n\t\t\tta.removeEventListener('autosize:update', update, false);\n\n\t\t\tObject.keys(style).forEach(function (key) {\n\t\t\t\tta.style[key] = style[key];\n\t\t\t});\n\n\t\t\tmap['delete'](ta);\n\t\t}).bind(ta, {\n\t\t\theight: ta.style.height,\n\t\t\tresize: ta.style.resize,\n\t\t\toverflowY: ta.style.overflowY,\n\t\t\toverflowX: ta.style.overflowX,\n\t\t\twordWrap: ta.style.wordWrap\n\t\t});\n\n\t\tta.addEventListener('autosize:destroy', destroy, false);\n\n\t\t// IE9 does not fire onpropertychange or oninput for deletions,\n\t\t// so binding to onkeyup to catch most of those events.\n\t\t// There is no way that I know of to detect something like 'cut' in IE9.\n\t\tif ('onpropertychange' in ta && 'oninput' in ta) {\n\t\t\tta.addEventListener('keyup', update, false);\n\t\t}\n\n\t\twindow.addEventListener('resize', pageResize, false);\n\t\tta.addEventListener('input', update, false);\n\t\tta.addEventListener('autosize:update', update, false);\n\t\tta.style.overflowX = 'hidden';\n\t\tta.style.wordWrap = 'break-word';\n\n\t\tmap.set(ta, {\n\t\t\tdestroy: destroy,\n\t\t\tupdate: update\n\t\t});\n\n\t\tinit();\n\t}\n\n\tfunction destroy(ta) {\n\t\tvar methods = map.get(ta);\n\t\tif (methods) {\n\t\t\tmethods.destroy();\n\t\t}\n\t}\n\n\tfunction update(ta) {\n\t\tvar methods = map.get(ta);\n\t\tif (methods) {\n\t\t\tmethods.update();\n\t\t}\n\t}\n\n\tvar autosize = null;\n\n\t// Do nothing in Node.js environment and IE8 (or lower)\n\tif (typeof window === 'undefined' || typeof window.getComputedStyle !== 'function') {\n\t\tautosize = function (el) {\n\t\t\treturn el;\n\t\t};\n\t\tautosize.destroy = function (el) {\n\t\t\treturn el;\n\t\t};\n\t\tautosize.update = function (el) {\n\t\t\treturn el;\n\t\t};\n\t} else {\n\t\tautosize = function (el, options) {\n\t\t\tif (el) {\n\t\t\t\tArray.prototype.forEach.call(el.length ? el : [el], function (x) {\n\t\t\t\t\treturn assign(x, options);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn el;\n\t\t};\n\t\tautosize.destroy = function (el) {\n\t\t\tif (el) {\n\t\t\t\tArray.prototype.forEach.call(el.length ? el : [el], destroy);\n\t\t\t}\n\t\t\treturn el;\n\t\t};\n\t\tautosize.update = function (el) {\n\t\t\tif (el) {\n\t\t\t\tArray.prototype.forEach.call(el.length ? el : [el], update);\n\t\t\t}\n\t\t\treturn el;\n\t\t};\n\t}\n\n\tmodule.exports = autosize;\n});","/**\n * Diff Match and Patch\n *\n * Copyright 2006 Google Inc.\n * http://code.google.com/p/google-diff-match-patch/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Computes the difference between two texts to create a patch.\n * Applies the patch onto another text, allowing for errors.\n * @author fraser@google.com (Neil Fraser)\n */\n\n/**\n * Class containing the diff, match and patch methods.\n * @constructor\n */\nfunction diff_match_patch() {\n\n  // Defaults.\n  // Redefine these in your program to override the defaults.\n\n  // Number of seconds to map a diff before giving up (0 for infinity).\n  this.Diff_Timeout = 1.0;\n  // Cost of an empty edit operation in terms of edit characters.\n  this.Diff_EditCost = 4;\n  // The size beyond which the double-ended diff activates.\n  // Double-ending is twice as fast, but less accurate.\n  this.Diff_DualThreshold = 32;\n  // At what point is no match declared (0.0 = perfection, 1.0 = very loose).\n  this.Match_Threshold = 0.5;\n  // How far to search for a match (0 = exact location, 1000+ = broad match).\n  // A match this many characters away from the expected location will add\n  // 1.0 to the score (0.0 is a perfect match).\n  this.Match_Distance = 1000;\n  // When deleting a large block of text (over ~64 characters), how close does\n  // the contents have to match the expected contents. (0.0 = perfection,\n  // 1.0 = very loose).  Note that Match_Threshold controls how closely the\n  // end points of a delete need to match.\n  this.Patch_DeleteThreshold = 0.5;\n  // Chunk size for context length.\n  this.Patch_Margin = 4;\n\n  /**\n   * Compute the number of bits in an int.\n   * The normal answer for JavaScript is 32.\n   * @return {number} Max bits\n   */\n  function getMaxBits() {\n    var maxbits = 0;\n    var oldi = 1;\n    var newi = 2;\n    while (oldi != newi) {\n      maxbits++;\n      oldi = newi;\n      newi = newi << 1;\n    }\n    return maxbits;\n  }\n  // How many bits in a number?\n  this.Match_MaxBits = getMaxBits();\n}\n\n\n//  DIFF FUNCTIONS\n\n\n/**\n * The data structure representing a diff is an array of tuples:\n * [[DIFF_DELETE, 'Hello'], [DIFF_INSERT, 'Goodbye'], [DIFF_EQUAL, ' world.']]\n * which means: delete 'Hello', add 'Goodbye' and keep ' world.'\n */\nvar DIFF_DELETE = -1;\nvar DIFF_INSERT = 1;\nvar DIFF_EQUAL = 0;\n\n\n/**\n * Find the differences between two texts.  Simplifies the problem by stripping\n * any common prefix or suffix off the texts before diffing.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {boolean} opt_checklines Optional speedup flag.  If present and false,\n *     then don't run a line-level diff first to identify the changed areas.\n *     Defaults to true, which does a faster, slightly less optimal diff\n * @return {Array.<Array.<number|string>>} Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_main = function(text1, text2, opt_checklines) {\n  // Check for null inputs.\n  if (text1 == null || text2 == null) {\n    throw new Error('Null input. (diff_main)');\n  }\n\n  // Check for equality (speedup).\n  if (text1 == text2) {\n    return [[DIFF_EQUAL, text1]];\n  }\n\n  if (typeof opt_checklines == 'undefined') {\n    opt_checklines = true;\n  }\n  var checklines = opt_checklines;\n\n  // Trim off common prefix (speedup).\n  var commonlength = this.diff_commonPrefix(text1, text2);\n  var commonprefix = text1.substring(0, commonlength);\n  text1 = text1.substring(commonlength);\n  text2 = text2.substring(commonlength);\n\n  // Trim off common suffix (speedup).\n  commonlength = this.diff_commonSuffix(text1, text2);\n  var commonsuffix = text1.substring(text1.length - commonlength);\n  text1 = text1.substring(0, text1.length - commonlength);\n  text2 = text2.substring(0, text2.length - commonlength);\n\n  // Compute the diff on the middle block.\n  var diffs = this.diff_compute(text1, text2, checklines);\n\n  // Restore the prefix and suffix.\n  if (commonprefix) {\n    diffs.unshift([DIFF_EQUAL, commonprefix]);\n  }\n  if (commonsuffix) {\n    diffs.push([DIFF_EQUAL, commonsuffix]);\n  }\n  this.diff_cleanupMerge(diffs);\n  return diffs;\n};\n\n\n/**\n * Find the differences between two texts.  Assumes that the texts do not\n * have any common prefix or suffix.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {boolean} checklines Speedup flag.  If false, then don't run a\n *     line-level diff first to identify the changed areas.\n *     If true, then run a faster, slightly less optimal diff\n * @return {Array.<Array.<number|string>>} Array of diff tuples.\n * @private\n */\ndiff_match_patch.prototype.diff_compute = function(text1, text2, checklines) {\n  var diffs;\n\n  if (!text1) {\n    // Just add some text (speedup).\n    return [[DIFF_INSERT, text2]];\n  }\n\n  if (!text2) {\n    // Just delete some text (speedup).\n    return [[DIFF_DELETE, text1]];\n  }\n\n  var longtext = text1.length > text2.length ? text1 : text2;\n  var shorttext = text1.length > text2.length ? text2 : text1;\n  var i = longtext.indexOf(shorttext);\n  if (i != -1) {\n    // Shorter text is inside the longer text (speedup).\n    diffs = [[DIFF_INSERT, longtext.substring(0, i)],\n             [DIFF_EQUAL, shorttext],\n             [DIFF_INSERT, longtext.substring(i + shorttext.length)]];\n    // Swap insertions for deletions if diff is reversed.\n    if (text1.length > text2.length) {\n      diffs[0][0] = diffs[2][0] = DIFF_DELETE;\n    }\n    return diffs;\n  }\n  longtext = shorttext = null;  // Garbage collect.\n\n  // Check to see if the problem can be split in two.\n  var hm = this.diff_halfMatch(text1, text2);\n  if (hm) {\n    // A half-match was found, sort out the return data.\n    var text1_a = hm[0];\n    var text1_b = hm[1];\n    var text2_a = hm[2];\n    var text2_b = hm[3];\n    var mid_common = hm[4];\n    // Send both pairs off for separate processing.\n    var diffs_a = this.diff_main(text1_a, text2_a, checklines);\n    var diffs_b = this.diff_main(text1_b, text2_b, checklines);\n    // Merge the results.\n    return diffs_a.concat([[DIFF_EQUAL, mid_common]], diffs_b);\n  }\n\n  // Perform a real diff.\n  if (checklines && (text1.length < 100 || text2.length < 100)) {\n    // Too trivial for the overhead.\n    checklines = false;\n  }\n  var linearray;\n  if (checklines) {\n    // Scan the text on a line-by-line basis first.\n    var a = this.diff_linesToChars(text1, text2);\n    text1 = a[0];\n    text2 = a[1];\n    linearray = a[2];\n  }\n  diffs = this.diff_map(text1, text2);\n  if (!diffs) {\n    // No acceptable result.\n    diffs = [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];\n  }\n  if (checklines) {\n    // Convert the diff back to original text.\n    this.diff_charsToLines(diffs, linearray);\n    // Eliminate freak matches (e.g. blank lines)\n    this.diff_cleanupSemantic(diffs);\n\n    // Rediff any replacement blocks, this time character-by-character.\n    // Add a dummy entry at the end.\n    diffs.push([DIFF_EQUAL, '']);\n    var pointer = 0;\n    var count_delete = 0;\n    var count_insert = 0;\n    var text_delete = '';\n    var text_insert = '';\n    while (pointer < diffs.length) {\n      switch (diffs[pointer][0]) {\n        case DIFF_INSERT:\n          count_insert++;\n          text_insert += diffs[pointer][1];\n          break;\n        case DIFF_DELETE:\n          count_delete++;\n          text_delete += diffs[pointer][1];\n          break;\n        case DIFF_EQUAL:\n          // Upon reaching an equality, check for prior redundancies.\n          if (count_delete >= 1 && count_insert >= 1) {\n            // Delete the offending records and add the merged ones.\n            var a = this.diff_main(text_delete, text_insert, false);\n            diffs.splice(pointer - count_delete - count_insert,\n                         count_delete + count_insert);\n            pointer = pointer - count_delete - count_insert;\n            for (var j = a.length - 1; j >= 0; j--) {\n              diffs.splice(pointer, 0, a[j]);\n            }\n            pointer = pointer + a.length;\n          }\n          count_insert = 0;\n          count_delete = 0;\n          text_delete = '';\n          text_insert = '';\n          break;\n      }\n     pointer++;\n    }\n    diffs.pop();  // Remove the dummy entry at the end.\n  }\n  return diffs;\n};\n\n\n/**\n * Split two texts into an array of strings.  Reduce the texts to a string of\n * hashes where each Unicode character represents one line.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {Array.<string|Array.<string>>} Three element Array, containing the\n *     encoded text1, the encoded text2 and the array of unique strings.  The\n *     zeroth element of the array of unique strings is intentionally blank.\n * @private\n */\ndiff_match_patch.prototype.diff_linesToChars = function(text1, text2) {\n  var lineArray = [];  // e.g. lineArray[4] == 'Hello\\n'\n  var lineHash = {};   // e.g. lineHash['Hello\\n'] == 4\n\n  // '\\x00' is a valid character, but various debuggers don't like it.\n  // So we'll insert a junk entry to avoid generating a null character.\n  lineArray[0] = '';\n\n  /**\n   * Split a text into an array of strings.  Reduce the texts to a string of\n   * hashes where each Unicode character represents one line.\n   * Modifies linearray and linehash through being a closure.\n   * @param {string} text String to encode.\n   * @return {string} Encoded string.\n   * @private\n   */\n  function diff_linesToCharsMunge(text) {\n    var chars = '';\n    // Walk the text, pulling out a substring for each line.\n    // text.split('\\n') would would temporarily double our memory footprint.\n    // Modifying text would create many large strings to garbage collect.\n    var lineStart = 0;\n    var lineEnd = -1;\n    // Keeping our own length variable is faster than looking it up.\n    var lineArrayLength = lineArray.length;\n    while (lineEnd < text.length - 1) {\n      lineEnd = text.indexOf('\\n', lineStart);\n      if (lineEnd == -1) {\n        lineEnd = text.length - 1;\n      }\n      var line = text.substring(lineStart, lineEnd + 1);\n      lineStart = lineEnd + 1;\n\n      if (lineHash.hasOwnProperty ? lineHash.hasOwnProperty(line) :\n          (lineHash[line] !== undefined)) {\n        chars += String.fromCharCode(lineHash[line]);\n      } else {\n        chars += String.fromCharCode(lineArrayLength);\n        lineHash[line] = lineArrayLength;\n        lineArray[lineArrayLength++] = line;\n      }\n    }\n    return chars;\n  }\n\n  var chars1 = diff_linesToCharsMunge(text1);\n  var chars2 = diff_linesToCharsMunge(text2);\n  return [chars1, chars2, lineArray];\n};\n\n\n/**\n * Rehydrate the text in a diff from a string of line hashes to real lines of\n * text.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n * @param {Array.<string>} lineArray Array of unique strings.\n * @private\n */\ndiff_match_patch.prototype.diff_charsToLines = function(diffs, lineArray) {\n  for (var x = 0; x < diffs.length; x++) {\n    var chars = diffs[x][1];\n    var text = [];\n    for (var y = 0; y < chars.length; y++) {\n      text[y] = lineArray[chars.charCodeAt(y)];\n    }\n    diffs[x][1] = text.join('');\n  }\n};\n\n\n/**\n * Explore the intersection points between the two texts.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @return {?Array.<Array.<number|string>>} Array of diff tuples or null if no\n *     diff available.\n * @private\n */\ndiff_match_patch.prototype.diff_map = function(text1, text2) {\n  // Don't run for too long.\n  var ms_end = (new Date()).getTime() + this.Diff_Timeout * 1000;\n  // Cache the text lengths to prevent multiple calls.\n  var text1_length = text1.length;\n  var text2_length = text2.length;\n  var max_d = text1_length + text2_length - 1;\n  var doubleEnd = this.Diff_DualThreshold * 2 < max_d;\n  // JavaScript efficiency note: (x << 32) + y doesn't work since numbers are\n  // only 32 bit.  Use x + ',' + y to create a hash instead.\n  var v_map1 = [];\n  var v_map2 = [];\n  var v1 = {};\n  var v2 = {};\n  v1[1] = 0;\n  v2[1] = 0;\n  var x, y;\n  var footstep;  // Used to track overlapping paths.\n  var footsteps = {};\n  var done = false;\n  // If the total number of characters is odd, then the front path will collide\n  // with the reverse path.\n  var front = (text1_length + text2_length) % 2;\n  for (var d = 0; d < max_d; d++) {\n    // Bail out if timeout reached.\n    if (this.Diff_Timeout > 0 && (new Date()).getTime() > ms_end) {\n      return null;\n    }\n\n    // Walk the front path one step.\n    v_map1[d] = {};\n    for (var k = -d; k <= d; k += 2) {\n      if (k == -d || k != d && v1[k - 1] < v1[k + 1]) {\n        x = v1[k + 1];\n      } else {\n        x = v1[k - 1] + 1;\n      }\n      y = x - k;\n      if (doubleEnd) {\n        footstep = x + ',' + y;\n        if (front && footsteps[footstep] !== undefined) {\n          done = true;\n        }\n        if (!front) {\n          footsteps[footstep] = d;\n        }\n      }\n      while (!done && x < text1_length && y < text2_length &&\n             text1.charAt(x) == text2.charAt(y)) {\n        x++;\n        y++;\n        if (doubleEnd) {\n          footstep = x + ',' + y;\n          if (front && footsteps[footstep] !== undefined) {\n            done = true;\n          }\n          if (!front) {\n            footsteps[footstep] = d;\n          }\n        }\n      }\n      v1[k] = x;\n      v_map1[d][x + ',' + y] = true;\n      if (x == text1_length && y == text2_length) {\n        // Reached the end in single-path mode.\n        return this.diff_path1(v_map1, text1, text2);\n      } else if (done) {\n        // Front path ran over reverse path.\n        v_map2 = v_map2.slice(0, footsteps[footstep] + 1);\n        var a = this.diff_path1(v_map1, text1.substring(0, x),\n                                text2.substring(0, y));\n        return a.concat(this.diff_path2(v_map2, text1.substring(x),\n                                        text2.substring(y)));\n      }\n    }\n\n    if (doubleEnd) {\n      // Walk the reverse path one step.\n      v_map2[d] = {};\n      for (var k = -d; k <= d; k += 2) {\n        if (k == -d || k != d && v2[k - 1] < v2[k + 1]) {\n          x = v2[k + 1];\n        } else {\n          x = v2[k - 1] + 1;\n        }\n        y = x - k;\n        footstep = (text1_length - x) + ',' + (text2_length - y);\n        if (!front && footsteps[footstep] !== undefined) {\n          done = true;\n        }\n        if (front) {\n          footsteps[footstep] = d;\n        }\n        while (!done && x < text1_length && y < text2_length &&\n               text1.charAt(text1_length - x - 1) ==\n               text2.charAt(text2_length - y - 1)) {\n          x++;\n          y++;\n          footstep = (text1_length - x) + ',' + (text2_length - y);\n          if (!front && footsteps[footstep] !== undefined) {\n            done = true;\n          }\n          if (front) {\n            footsteps[footstep] = d;\n          }\n        }\n        v2[k] = x;\n        v_map2[d][x + ',' + y] = true;\n        if (done) {\n          // Reverse path ran over front path.\n          v_map1 = v_map1.slice(0, footsteps[footstep] + 1);\n          var a = this.diff_path1(v_map1, text1.substring(0, text1_length - x),\n                                  text2.substring(0, text2_length - y));\n          return a.concat(this.diff_path2(v_map2,\n                          text1.substring(text1_length - x),\n                          text2.substring(text2_length - y)));\n        }\n      }\n    }\n  }\n  // Number of diffs equals number of characters, no commonality at all.\n  return null;\n};\n\n\n/**\n * Work from the middle back to the start to determine the path.\n * @param {Array.<Object>} v_map Array of paths.\n * @param {string} text1 Old string fragment to be diffed.\n * @param {string} text2 New string fragment to be diffed.\n * @return {Array.<Array.<number|string>>} Array of diff tuples.\n * @private\n */\ndiff_match_patch.prototype.diff_path1 = function(v_map, text1, text2) {\n  var path = [];\n  var x = text1.length;\n  var y = text2.length;\n  /** @type {?number} */\n  var last_op = null;\n  for (var d = v_map.length - 2; d >= 0; d--) {\n    while (1) {\n      if (v_map[d][(x - 1) + ',' + y] !== undefined) {\n        x--;\n        if (last_op === DIFF_DELETE) {\n          path[0][1] = text1.charAt(x) + path[0][1];\n        } else {\n          path.unshift([DIFF_DELETE, text1.charAt(x)]);\n        }\n        last_op = DIFF_DELETE;\n        break;\n      } else if (v_map[d][x + ',' + (y - 1)] !== undefined) {\n        y--;\n        if (last_op === DIFF_INSERT) {\n          path[0][1] = text2.charAt(y) + path[0][1];\n        } else {\n          path.unshift([DIFF_INSERT, text2.charAt(y)]);\n        }\n        last_op = DIFF_INSERT;\n        break;\n      } else {\n        x--;\n        y--;\n        if (text1.charAt(x) != text2.charAt(y)) {\n          throw new Error('No diagonal.  Can\\'t happen. (diff_path1)');\n        }\n        if (last_op === DIFF_EQUAL) {\n          path[0][1] = text1.charAt(x) + path[0][1];\n        } else {\n          path.unshift([DIFF_EQUAL, text1.charAt(x)]);\n        }\n        last_op = DIFF_EQUAL;\n      }\n    }\n  }\n  return path;\n};\n\n\n/**\n * Work from the middle back to the end to determine the path.\n * @param {Array.<Object>} v_map Array of paths.\n * @param {string} text1 Old string fragment to be diffed.\n * @param {string} text2 New string fragment to be diffed.\n * @return {Array.<Array.<number|string>>} Array of diff tuples.\n * @private\n */\ndiff_match_patch.prototype.diff_path2 = function(v_map, text1, text2) {\n  var path = [];\n  var pathLength = 0;\n  var x = text1.length;\n  var y = text2.length;\n  /** @type {?number} */\n  var last_op = null;\n  for (var d = v_map.length - 2; d >= 0; d--) {\n    while (1) {\n      if (v_map[d][(x - 1) + ',' + y] !== undefined) {\n        x--;\n        if (last_op === DIFF_DELETE) {\n          path[pathLength - 1][1] += text1.charAt(text1.length - x - 1);\n        } else {\n          path[pathLength++] =\n              [DIFF_DELETE, text1.charAt(text1.length - x - 1)];\n        }\n        last_op = DIFF_DELETE;\n        break;\n      } else if (v_map[d][x + ',' + (y - 1)] !== undefined) {\n        y--;\n        if (last_op === DIFF_INSERT) {\n          path[pathLength - 1][1] += text2.charAt(text2.length - y - 1);\n        } else {\n          path[pathLength++] =\n              [DIFF_INSERT, text2.charAt(text2.length - y - 1)];\n        }\n        last_op = DIFF_INSERT;\n        break;\n      } else {\n        x--;\n        y--;\n        if (text1.charAt(text1.length - x - 1) !=\n            text2.charAt(text2.length - y - 1)) {\n          throw new Error('No diagonal.  Can\\'t happen. (diff_path2)');\n        }\n        if (last_op === DIFF_EQUAL) {\n          path[pathLength - 1][1] += text1.charAt(text1.length - x - 1);\n        } else {\n          path[pathLength++] =\n              [DIFF_EQUAL, text1.charAt(text1.length - x - 1)];\n        }\n        last_op = DIFF_EQUAL;\n      }\n    }\n  }\n  return path;\n};\n\n\n/**\n * Determine the common prefix of two strings\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {number} The number of characters common to the start of each\n *     string.\n */\ndiff_match_patch.prototype.diff_commonPrefix = function(text1, text2) {\n  // Quick check for common null cases.\n  if (!text1 || !text2 || text1.charAt(0) != text2.charAt(0)) {\n    return 0;\n  }\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  var pointermin = 0;\n  var pointermax = Math.min(text1.length, text2.length);\n  var pointermid = pointermax;\n  var pointerstart = 0;\n  while (pointermin < pointermid) {\n    if (text1.substring(pointerstart, pointermid) ==\n        text2.substring(pointerstart, pointermid)) {\n      pointermin = pointermid;\n      pointerstart = pointermin;\n    } else {\n      pointermax = pointermid;\n    }\n    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);\n  }\n  return pointermid;\n};\n\n\n/**\n * Determine the common suffix of two strings\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {number} The number of characters common to the end of each string.\n */\ndiff_match_patch.prototype.diff_commonSuffix = function(text1, text2) {\n  // Quick check for common null cases.\n  if (!text1 || !text2 || text1.charAt(text1.length - 1) !=\n                          text2.charAt(text2.length - 1)) {\n    return 0;\n  }\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  var pointermin = 0;\n  var pointermax = Math.min(text1.length, text2.length);\n  var pointermid = pointermax;\n  var pointerend = 0;\n  while (pointermin < pointermid) {\n    if (text1.substring(text1.length - pointermid, text1.length - pointerend) ==\n        text2.substring(text2.length - pointermid, text2.length - pointerend)) {\n      pointermin = pointermid;\n      pointerend = pointermin;\n    } else {\n      pointermax = pointermid;\n    }\n    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);\n  }\n  return pointermid;\n};\n\n\n/**\n * Do the two texts share a substring which is at least half the length of the\n * longer text?\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {?Array.<string>} Five element Array, containing the prefix of\n *     text1, the suffix of text1, the prefix of text2, the suffix of\n *     text2 and the common middle.  Or null if there was no match.\n */\ndiff_match_patch.prototype.diff_halfMatch = function(text1, text2) {\n  var longtext = text1.length > text2.length ? text1 : text2;\n  var shorttext = text1.length > text2.length ? text2 : text1;\n  if (longtext.length < 10 || shorttext.length < 1) {\n    return null;  // Pointless.\n  }\n  var dmp = this;  // 'this' becomes 'window' in a closure.\n\n  /**\n   * Does a substring of shorttext exist within longtext such that the substring\n   * is at least half the length of longtext?\n   * Closure, but does not reference any external variables.\n   * @param {string} longtext Longer string.\n   * @param {string} shorttext Shorter string.\n   * @param {number} i Start index of quarter length substring within longtext\n   * @return {?Array.<string>} Five element Array, containing the prefix of\n   *     longtext, the suffix of longtext, the prefix of shorttext, the suffix\n   *     of shorttext and the common middle.  Or null if there was no match.\n   * @private\n   */\n  function diff_halfMatchI(longtext, shorttext, i) {\n    // Start with a 1/4 length substring at position i as a seed.\n    var seed = longtext.substring(i, i + Math.floor(longtext.length / 4));\n    var j = -1;\n    var best_common = '';\n    var best_longtext_a, best_longtext_b, best_shorttext_a, best_shorttext_b;\n    while ((j = shorttext.indexOf(seed, j + 1)) != -1) {\n      var prefixLength = dmp.diff_commonPrefix(longtext.substring(i),\n                                               shorttext.substring(j));\n      var suffixLength = dmp.diff_commonSuffix(longtext.substring(0, i),\n                                               shorttext.substring(0, j));\n      if (best_common.length < suffixLength + prefixLength) {\n        best_common = shorttext.substring(j - suffixLength, j) +\n            shorttext.substring(j, j + prefixLength);\n        best_longtext_a = longtext.substring(0, i - suffixLength);\n        best_longtext_b = longtext.substring(i + prefixLength);\n        best_shorttext_a = shorttext.substring(0, j - suffixLength);\n        best_shorttext_b = shorttext.substring(j + prefixLength);\n      }\n    }\n    if (best_common.length >= longtext.length / 2) {\n      return [best_longtext_a, best_longtext_b,\n              best_shorttext_a, best_shorttext_b, best_common];\n    } else {\n      return null;\n    }\n  }\n\n  // First check if the second quarter is the seed for a half-match.\n  var hm1 = diff_halfMatchI(longtext, shorttext,\n                            Math.ceil(longtext.length / 4));\n  // Check again based on the third quarter.\n  var hm2 = diff_halfMatchI(longtext, shorttext,\n                            Math.ceil(longtext.length / 2));\n  var hm;\n  if (!hm1 && !hm2) {\n    return null;\n  } else if (!hm2) {\n    hm = hm1;\n  } else if (!hm1) {\n    hm = hm2;\n  } else {\n    // Both matched.  Select the longest.\n    hm = hm1[4].length > hm2[4].length ? hm1 : hm2;\n  }\n\n  // A half-match was found, sort out the return data.\n  var text1_a, text1_b, text2_a, text2_b;\n  if (text1.length > text2.length) {\n    text1_a = hm[0];\n    text1_b = hm[1];\n    text2_a = hm[2];\n    text2_b = hm[3];\n  } else {\n    text2_a = hm[0];\n    text2_b = hm[1];\n    text1_a = hm[2];\n    text1_b = hm[3];\n  }\n  var mid_common = hm[4];\n  return [text1_a, text1_b, text2_a, text2_b, mid_common];\n};\n\n\n/**\n * Reduce the number of edits by eliminating semantically trivial equalities.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupSemantic = function(diffs) {\n  var changes = false;\n  var equalities = [];  // Stack of indices where equalities are found.\n  var equalitiesLength = 0;  // Keeping our own length var is faster in JS.\n  var lastequality = null;  // Always equal to equalities[equalitiesLength-1][1]\n  var pointer = 0;  // Index of current position.\n  // Number of characters that changed prior to the equality.\n  var length_changes1 = 0;\n  // Number of characters that changed after the equality.\n  var length_changes2 = 0;\n  while (pointer < diffs.length) {\n    if (diffs[pointer][0] == DIFF_EQUAL) {  // equality found\n      equalities[equalitiesLength++] = pointer;\n      length_changes1 = length_changes2;\n      length_changes2 = 0;\n      lastequality = diffs[pointer][1];\n    } else {  // an insertion or deletion\n      length_changes2 += diffs[pointer][1].length;\n      if (lastequality !== null && (lastequality.length <= length_changes1) &&\n          (lastequality.length <= length_changes2)) {\n        // Duplicate record\n        diffs.splice(equalities[equalitiesLength - 1], 0,\n                     [DIFF_DELETE, lastequality]);\n        // Change second copy to insert.\n        diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT;\n        // Throw away the equality we just deleted.\n        equalitiesLength--;\n        // Throw away the previous equality (it needs to be reevaluated).\n        equalitiesLength--;\n        pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1;\n        length_changes1 = 0;  // Reset the counters.\n        length_changes2 = 0;\n        lastequality = null;\n        changes = true;\n      }\n    }\n    pointer++;\n  }\n  if (changes) {\n    this.diff_cleanupMerge(diffs);\n  }\n  this.diff_cleanupSemanticLossless(diffs);\n};\n\n\n/**\n * Look for single edits surrounded on both sides by equalities\n * which can be shifted sideways to align the edit to a word boundary.\n * e.g: The c<ins>at c</ins>ame. -> The <ins>cat </ins>came.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupSemanticLossless = function(diffs) {\n  // Define some regex patterns for matching boundaries.\n  var punctuation = /[^a-zA-Z0-9]/;\n  var whitespace = /\\s/;\n  var linebreak = /[\\r\\n]/;\n  var blanklineEnd = /\\n\\r?\\n$/;\n  var blanklineStart = /^\\r?\\n\\r?\\n/;\n\n  /**\n   * Given two strings, compute a score representing whether the internal\n   * boundary falls on logical boundaries.\n   * Scores range from 5 (best) to 0 (worst).\n   * Closure, makes reference to regex patterns defined above.\n   * @param {string} one First string.\n   * @param {string} two Second string.\n   * @return {number} The score.\n   */\n  function diff_cleanupSemanticScore(one, two) {\n    if (!one || !two) {\n      // Edges are the best.\n      return 5;\n    }\n\n    // Each port of this function behaves slightly differently due to\n    // subtle differences in each language's definition of things like\n    // 'whitespace'.  Since this function's purpose is largely cosmetic,\n    // the choice has been made to use each language's native features\n    // rather than force total conformity.\n    var score = 0;\n    // One point for non-alphanumeric.\n    if (one.charAt(one.length - 1).match(punctuation) ||\n        two.charAt(0).match(punctuation)) {\n      score++;\n      // Two points for whitespace.\n      if (one.charAt(one.length - 1).match(whitespace) ||\n          two.charAt(0).match(whitespace)) {\n        score++;\n        // Three points for line breaks.\n        if (one.charAt(one.length - 1).match(linebreak) ||\n            two.charAt(0).match(linebreak)) {\n          score++;\n          // Four points for blank lines.\n          if (one.match(blanklineEnd) || two.match(blanklineStart)) {\n            score++;\n          }\n        }\n      }\n    }\n    return score;\n  }\n\n  var pointer = 1;\n  // Intentionally ignore the first and last element (don't need checking).\n  while (pointer < diffs.length - 1) {\n    if (diffs[pointer - 1][0] == DIFF_EQUAL &&\n        diffs[pointer + 1][0] == DIFF_EQUAL) {\n      // This is a single edit surrounded by equalities.\n      var equality1 = diffs[pointer - 1][1];\n      var edit = diffs[pointer][1];\n      var equality2 = diffs[pointer + 1][1];\n\n      // First, shift the edit as far left as possible.\n      var commonOffset = this.diff_commonSuffix(equality1, edit);\n      if (commonOffset) {\n        var commonString = edit.substring(edit.length - commonOffset);\n        equality1 = equality1.substring(0, equality1.length - commonOffset);\n        edit = commonString + edit.substring(0, edit.length - commonOffset);\n        equality2 = commonString + equality2;\n      }\n\n      // Second, step character by character right, looking for the best fit.\n      var bestEquality1 = equality1;\n      var bestEdit = edit;\n      var bestEquality2 = equality2;\n      var bestScore = diff_cleanupSemanticScore(equality1, edit) +\n          diff_cleanupSemanticScore(edit, equality2);\n      while (edit.charAt(0) === equality2.charAt(0)) {\n        equality1 += edit.charAt(0);\n        edit = edit.substring(1) + equality2.charAt(0);\n        equality2 = equality2.substring(1);\n        var score = diff_cleanupSemanticScore(equality1, edit) +\n            diff_cleanupSemanticScore(edit, equality2);\n        // The >= encourages trailing rather than leading whitespace on edits.\n        if (score >= bestScore) {\n          bestScore = score;\n          bestEquality1 = equality1;\n          bestEdit = edit;\n          bestEquality2 = equality2;\n        }\n      }\n\n      if (diffs[pointer - 1][1] != bestEquality1) {\n        // We have an improvement, save it back to the diff.\n        if (bestEquality1) {\n          diffs[pointer - 1][1] = bestEquality1;\n        } else {\n          diffs.splice(pointer - 1, 1);\n          pointer--;\n        }\n        diffs[pointer][1] = bestEdit;\n        if (bestEquality2) {\n          diffs[pointer + 1][1] = bestEquality2;\n        } else {\n          diffs.splice(pointer + 1, 1);\n          pointer--;\n        }\n      }\n    }\n    pointer++;\n  }\n};\n\n\n/**\n * Reduce the number of edits by eliminating operationally trivial equalities.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupEfficiency = function(diffs) {\n  var changes = false;\n  var equalities = [];  // Stack of indices where equalities are found.\n  var equalitiesLength = 0;  // Keeping our own length var is faster in JS.\n  var lastequality = '';  // Always equal to equalities[equalitiesLength-1][1]\n  var pointer = 0;  // Index of current position.\n  // Is there an insertion operation before the last equality.\n  var pre_ins = false;\n  // Is there a deletion operation before the last equality.\n  var pre_del = false;\n  // Is there an insertion operation after the last equality.\n  var post_ins = false;\n  // Is there a deletion operation after the last equality.\n  var post_del = false;\n  while (pointer < diffs.length) {\n    if (diffs[pointer][0] == DIFF_EQUAL) {  // equality found\n      if (diffs[pointer][1].length < this.Diff_EditCost &&\n          (post_ins || post_del)) {\n        // Candidate found.\n        equalities[equalitiesLength++] = pointer;\n        pre_ins = post_ins;\n        pre_del = post_del;\n        lastequality = diffs[pointer][1];\n      } else {\n        // Not a candidate, and can never become one.\n        equalitiesLength = 0;\n        lastequality = '';\n      }\n      post_ins = post_del = false;\n    } else {  // an insertion or deletion\n      if (diffs[pointer][0] == DIFF_DELETE) {\n        post_del = true;\n      } else {\n        post_ins = true;\n      }\n      /*\n       * Five types to be split:\n       * <ins>A</ins><del>B</del>XY<ins>C</ins><del>D</del>\n       * <ins>A</ins>X<ins>C</ins><del>D</del>\n       * <ins>A</ins><del>B</del>X<ins>C</ins>\n       * <ins>A</del>X<ins>C</ins><del>D</del>\n       * <ins>A</ins><del>B</del>X<del>C</del>\n       */\n      if (lastequality && ((pre_ins && pre_del && post_ins && post_del) ||\n                           ((lastequality.length < this.Diff_EditCost / 2) &&\n                            (pre_ins + pre_del + post_ins + post_del) == 3))) {\n        // Duplicate record\n        diffs.splice(equalities[equalitiesLength - 1], 0,\n                     [DIFF_DELETE, lastequality]);\n        // Change second copy to insert.\n        diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT;\n        equalitiesLength--;  // Throw away the equality we just deleted;\n        lastequality = '';\n        if (pre_ins && pre_del) {\n          // No changes made which could affect previous entry, keep going.\n          post_ins = post_del = true;\n          equalitiesLength = 0;\n        } else {\n          equalitiesLength--;  // Throw away the previous equality;\n          pointer = equalitiesLength > 0 ?\n              equalities[equalitiesLength - 1] : -1;\n          post_ins = post_del = false;\n        }\n        changes = true;\n      }\n    }\n    pointer++;\n  }\n\n  if (changes) {\n    this.diff_cleanupMerge(diffs);\n  }\n};\n\n\n/**\n * Reorder and merge like edit sections.  Merge equalities.\n * Any edit section can move as long as it doesn't cross an equality.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupMerge = function(diffs) {\n  diffs.push([DIFF_EQUAL, '']);  // Add a dummy entry at the end.\n  var pointer = 0;\n  var count_delete = 0;\n  var count_insert = 0;\n  var text_delete = '';\n  var text_insert = '';\n  var commonlength;\n  while (pointer < diffs.length) {\n    switch (diffs[pointer][0]) {\n      case DIFF_INSERT:\n        count_insert++;\n        text_insert += diffs[pointer][1];\n        pointer++;\n        break;\n      case DIFF_DELETE:\n        count_delete++;\n        text_delete += diffs[pointer][1];\n        pointer++;\n        break;\n      case DIFF_EQUAL:\n        // Upon reaching an equality, check for prior redundancies.\n        if (count_delete !== 0 || count_insert !== 0) {\n          if (count_delete !== 0 && count_insert !== 0) {\n            // Factor out any common prefixies.\n            commonlength = this.diff_commonPrefix(text_insert, text_delete);\n            if (commonlength !== 0) {\n              if ((pointer - count_delete - count_insert) > 0 &&\n                  diffs[pointer - count_delete - count_insert - 1][0] ==\n                  DIFF_EQUAL) {\n                diffs[pointer - count_delete - count_insert - 1][1] +=\n                    text_insert.substring(0, commonlength);\n              } else {\n                diffs.splice(0, 0, [DIFF_EQUAL,\n                    text_insert.substring(0, commonlength)]);\n                pointer++;\n              }\n              text_insert = text_insert.substring(commonlength);\n              text_delete = text_delete.substring(commonlength);\n            }\n            // Factor out any common suffixies.\n            commonlength = this.diff_commonSuffix(text_insert, text_delete);\n            if (commonlength !== 0) {\n              diffs[pointer][1] = text_insert.substring(text_insert.length -\n                  commonlength) + diffs[pointer][1];\n              text_insert = text_insert.substring(0, text_insert.length -\n                  commonlength);\n              text_delete = text_delete.substring(0, text_delete.length -\n                  commonlength);\n            }\n          }\n          // Delete the offending records and add the merged ones.\n          if (count_delete === 0) {\n            diffs.splice(pointer - count_delete - count_insert,\n                count_delete + count_insert, [DIFF_INSERT, text_insert]);\n          } else if (count_insert === 0) {\n            diffs.splice(pointer - count_delete - count_insert,\n                count_delete + count_insert, [DIFF_DELETE, text_delete]);\n          } else {\n            diffs.splice(pointer - count_delete - count_insert,\n                count_delete + count_insert, [DIFF_DELETE, text_delete],\n                [DIFF_INSERT, text_insert]);\n          }\n          pointer = pointer - count_delete - count_insert +\n                    (count_delete ? 1 : 0) + (count_insert ? 1 : 0) + 1;\n        } else if (pointer !== 0 && diffs[pointer - 1][0] == DIFF_EQUAL) {\n          // Merge this equality with the previous one.\n          diffs[pointer - 1][1] += diffs[pointer][1];\n          diffs.splice(pointer, 1);\n        } else {\n          pointer++;\n        }\n        count_insert = 0;\n        count_delete = 0;\n        text_delete = '';\n        text_insert = '';\n        break;\n    }\n  }\n  if (diffs[diffs.length - 1][1] === '') {\n    diffs.pop();  // Remove the dummy entry at the end.\n  }\n\n  // Second pass: look for single edits surrounded on both sides by equalities\n  // which can be shifted sideways to eliminate an equality.\n  // e.g: A<ins>BA</ins>C -> <ins>AB</ins>AC\n  var changes = false;\n  pointer = 1;\n  // Intentionally ignore the first and last element (don't need checking).\n  while (pointer < diffs.length - 1) {\n    if (diffs[pointer - 1][0] == DIFF_EQUAL &&\n        diffs[pointer + 1][0] == DIFF_EQUAL) {\n      // This is a single edit surrounded by equalities.\n      if (diffs[pointer][1].substring(diffs[pointer][1].length -\n          diffs[pointer - 1][1].length) == diffs[pointer - 1][1]) {\n        // Shift the edit over the previous equality.\n        diffs[pointer][1] = diffs[pointer - 1][1] +\n            diffs[pointer][1].substring(0, diffs[pointer][1].length -\n                                        diffs[pointer - 1][1].length);\n        diffs[pointer + 1][1] = diffs[pointer - 1][1] + diffs[pointer + 1][1];\n        diffs.splice(pointer - 1, 1);\n        changes = true;\n      } else if (diffs[pointer][1].substring(0, diffs[pointer + 1][1].length) ==\n          diffs[pointer + 1][1]) {\n        // Shift the edit over the next equality.\n        diffs[pointer - 1][1] += diffs[pointer + 1][1];\n        diffs[pointer][1] =\n            diffs[pointer][1].substring(diffs[pointer + 1][1].length) +\n            diffs[pointer + 1][1];\n        diffs.splice(pointer + 1, 1);\n        changes = true;\n      }\n    }\n    pointer++;\n  }\n  // If shifts were made, the diff needs reordering and another shift sweep.\n  if (changes) {\n    this.diff_cleanupMerge(diffs);\n  }\n};\n\n\n/**\n * loc is a location in text1, compute and return the equivalent location in\n * text2.\n * e.g. 'The cat' vs 'The big cat', 1->1, 5->8\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n * @param {number} loc Location within text1.\n * @return {number} Location within text2.\n */\ndiff_match_patch.prototype.diff_xIndex = function(diffs, loc) {\n  var chars1 = 0;\n  var chars2 = 0;\n  var last_chars1 = 0;\n  var last_chars2 = 0;\n  var x;\n  for (x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_INSERT) {  // Equality or deletion.\n      chars1 += diffs[x][1].length;\n    }\n    if (diffs[x][0] !== DIFF_DELETE) {  // Equality or insertion.\n      chars2 += diffs[x][1].length;\n    }\n    if (chars1 > loc) {  // Overshot the location.\n      break;\n    }\n    last_chars1 = chars1;\n    last_chars2 = chars2;\n  }\n  // Was the location was deleted?\n  if (diffs.length != x && diffs[x][0] === DIFF_DELETE) {\n    return last_chars2;\n  }\n  // Add the remaining character length.\n  return last_chars2 + (loc - last_chars1);\n};\n\n\n/**\n * Convert a diff array into a pretty HTML report.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n * @return {string} HTML representation.\n */\ndiff_match_patch.prototype.diff_prettyHtml = function(diffs) {\n  var html = [];\n  var i = 0;\n  for (var x = 0; x < diffs.length; x++) {\n    var op = diffs[x][0];    // Operation (insert, delete, equal)\n    var data = diffs[x][1];  // Text of change.\n    var text = data.replace(/&/g, '&amp;').replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;').replace(/\\n/g, '&para;<BR>');\n    switch (op) {\n      case DIFF_INSERT:\n        html[x] = '<INS STYLE=\"background:#E6FFE6;\" TITLE=\"i=' + i + '\">' +\n                text + '</INS>';\n        break;\n      case DIFF_DELETE:\n        html[x] = '<DEL STYLE=\"background:#FFE6E6;\" TITLE=\"i=' + i + '\">' +\n                text + '</DEL>';\n        break;\n      case DIFF_EQUAL:\n        html[x] = '<SPAN TITLE=\"i=' + i + '\">' + text + '</SPAN>';\n        break;\n    }\n    if (op !== DIFF_DELETE) {\n      i += data.length;\n    }\n  }\n  return html.join('');\n};\n\n\n/**\n * Compute and return the source text (all equalities and deletions).\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n * @return {string} Source text.\n */\ndiff_match_patch.prototype.diff_text1 = function(diffs) {\n  var text = [];\n  for (var x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_INSERT) {\n      text[x] = diffs[x][1];\n    }\n  }\n  return text.join('');\n};\n\n\n/**\n * Compute and return the destination text (all equalities and insertions).\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n * @return {string} Destination text.\n */\ndiff_match_patch.prototype.diff_text2 = function(diffs) {\n  var text = [];\n  for (var x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_DELETE) {\n      text[x] = diffs[x][1];\n    }\n  }\n  return text.join('');\n};\n\n\n/**\n * Compute the Levenshtein distance; the number of inserted, deleted or\n * substituted characters.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n * @return {number} Number of changes.\n */\ndiff_match_patch.prototype.diff_levenshtein = function(diffs) {\n  var levenshtein = 0;\n  var insertions = 0;\n  var deletions = 0;\n  for (var x = 0; x < diffs.length; x++) {\n    var op = diffs[x][0];\n    var data = diffs[x][1];\n    switch (op) {\n      case DIFF_INSERT:\n        insertions += data.length;\n        break;\n      case DIFF_DELETE:\n        deletions += data.length;\n        break;\n      case DIFF_EQUAL:\n        // A deletion and an insertion is one substitution.\n        levenshtein += Math.max(insertions, deletions);\n        insertions = 0;\n        deletions = 0;\n        break;\n    }\n  }\n  levenshtein += Math.max(insertions, deletions);\n  return levenshtein;\n};\n\n\n/**\n * Crush the diff into an encoded string which describes the operations\n * required to transform text1 into text2.\n * E.g. =3\\t-2\\t+ing  -> Keep 3 chars, delete 2 chars, insert 'ing'.\n * Operations are tab-separated.  Inserted text is escaped using %xx notation.\n * @param {Array.<Array.<number|string>>} diffs Array of diff tuples.\n * @return {string} Delta text.\n */\ndiff_match_patch.prototype.diff_toDelta = function(diffs) {\n  var text = [];\n  for (var x = 0; x < diffs.length; x++) {\n    switch (diffs[x][0]) {\n      case DIFF_INSERT:\n        text[x] = '+' + encodeURI(diffs[x][1]);\n        break;\n      case DIFF_DELETE:\n        text[x] = '-' + diffs[x][1].length;\n        break;\n      case DIFF_EQUAL:\n        text[x] = '=' + diffs[x][1].length;\n        break;\n    }\n  }\n  // Opera doesn't know how to encode char 0.\n  return text.join('\\t').replace(/\\x00/g, '%00').replace(/%20/g, ' ');\n};\n\n\n/**\n * Given the original text1, and an encoded string which describes the\n * operations required to transform text1 into text2, compute the full diff.\n * @param {string} text1 Source string for the diff.\n * @param {string} delta Delta text.\n * @return {Array.<Array.<number|string>>} Array of diff tuples.\n * @throws {Error} If invalid input.\n */\ndiff_match_patch.prototype.diff_fromDelta = function(text1, delta) {\n  var diffs = [];\n  var diffsLength = 0;  // Keeping our own length var is faster in JS.\n  var pointer = 0;  // Cursor in text1\n  // Opera doesn't know how to decode char 0.\n  delta = delta.replace(/%00/g, '\\0');\n  var tokens = delta.split(/\\t/g);\n  for (var x = 0; x < tokens.length; x++) {\n    // Each token begins with a one character parameter which specifies the\n    // operation of this token (delete, insert, equality).\n    var param = tokens[x].substring(1);\n    switch (tokens[x].charAt(0)) {\n      case '+':\n        try {\n          diffs[diffsLength++] = [DIFF_INSERT, decodeURI(param)];\n        } catch (ex) {\n          // Malformed URI sequence.\n          throw new Error('Illegal escape in diff_fromDelta: ' + param);\n        }\n        break;\n      case '-':\n        // Fall through.\n      case '=':\n        var n = parseInt(param, 10);\n        if (isNaN(n) || n < 0) {\n          throw new Error('Invalid number in diff_fromDelta: ' + param);\n        }\n        var text = text1.substring(pointer, pointer += n);\n        if (tokens[x].charAt(0) == '=') {\n          diffs[diffsLength++] = [DIFF_EQUAL, text];\n        } else {\n          diffs[diffsLength++] = [DIFF_DELETE, text];\n        }\n        break;\n      default:\n        // Blank tokens are ok (from a trailing \\t).\n        // Anything else is an error.\n        if (tokens[x]) {\n          throw new Error('Invalid diff operation in diff_fromDelta: ' +\n                          tokens[x]);\n        }\n    }\n  }\n  if (pointer != text1.length) {\n    throw new Error('Delta length (' + pointer +\n        ') does not equal source text length (' + text1.length + ').');\n  }\n  return diffs;\n};\n\n\n//  MATCH FUNCTIONS\n\n\n/**\n * Locate the best instance of 'pattern' in 'text' near 'loc'.\n * @param {string} text The text to search.\n * @param {string} pattern The pattern to search for.\n * @param {number} loc The location to search around.\n * @return {number} Best match index or -1.\n */\ndiff_match_patch.prototype.match_main = function(text, pattern, loc) {\n  // Check for null inputs.\n  if (text == null || pattern == null || loc == null) {\n    throw new Error('Null input. (match_main)');\n  }\n\n  loc = Math.max(0, Math.min(loc, text.length));\n  if (text == pattern) {\n    // Shortcut (potentially not guaranteed by the algorithm)\n    return 0;\n  } else if (!text.length) {\n    // Nothing to match.\n    return -1;\n  } else if (text.substring(loc, loc + pattern.length) == pattern) {\n    // Perfect match at the perfect spot!  (Includes case of null pattern)\n    return loc;\n  } else {\n    // Do a fuzzy compare.\n    return this.match_bitap(text, pattern, loc);\n  }\n};\n\n\n/**\n * Locate the best instance of 'pattern' in 'text' near 'loc' using the\n * Bitap algorithm.\n * @param {string} text The text to search.\n * @param {string} pattern The pattern to search for.\n * @param {number} loc The location to search around.\n * @return {number} Best match index or -1.\n * @private\n */\ndiff_match_patch.prototype.match_bitap = function(text, pattern, loc) {\n  if (pattern.length > this.Match_MaxBits) {\n    throw new Error('Pattern too long for this browser.');\n  }\n\n  // Initialise the alphabet.\n  var s = this.match_alphabet(pattern);\n\n  var dmp = this;  // 'this' becomes 'window' in a closure.\n\n  /**\n   * Compute and return the score for a match with e errors and x location.\n   * Accesses loc and pattern through being a closure.\n   * @param {number} e Number of errors in match.\n   * @param {number} x Location of match.\n   * @return {number} Overall score for match (0.0 = good, 1.0 = bad).\n   * @private\n   */\n  function match_bitapScore(e, x) {\n    var accuracy = e / pattern.length;\n    var proximity = Math.abs(loc - x);\n    if (!dmp.Match_Distance) {\n      // Dodge divide by zero error.\n      return proximity ? 1.0 : accuracy;\n    }\n    return accuracy + (proximity / dmp.Match_Distance);\n  }\n\n  // Highest score beyond which we give up.\n  var score_threshold = this.Match_Threshold;\n  // Is there a nearby exact match? (speedup)\n  var best_loc = text.indexOf(pattern, loc);\n  if (best_loc != -1) {\n    score_threshold = Math.min(match_bitapScore(0, best_loc), score_threshold);\n    // What about in the other direction? (speedup)\n    best_loc = text.lastIndexOf(pattern, loc + pattern.length);\n    if (best_loc != -1) {\n      score_threshold =\n          Math.min(match_bitapScore(0, best_loc), score_threshold);\n    }\n  }\n\n  // Initialise the bit arrays.\n  var matchmask = 1 << (pattern.length - 1);\n  best_loc = -1;\n\n  var bin_min, bin_mid;\n  var bin_max = pattern.length + text.length;\n  var last_rd;\n  for (var d = 0; d < pattern.length; d++) {\n    // Scan for the best match; each iteration allows for one more error.\n    // Run a binary search to determine how far from 'loc' we can stray at this\n    // error level.\n    bin_min = 0;\n    bin_mid = bin_max;\n    while (bin_min < bin_mid) {\n      if (match_bitapScore(d, loc + bin_mid) <= score_threshold) {\n        bin_min = bin_mid;\n      } else {\n        bin_max = bin_mid;\n      }\n      bin_mid = Math.floor((bin_max - bin_min) / 2 + bin_min);\n    }\n    // Use the result from this iteration as the maximum for the next.\n    bin_max = bin_mid;\n    var start = Math.max(1, loc - bin_mid + 1);\n    var finish = Math.min(loc + bin_mid, text.length) + pattern.length;\n\n    var rd = Array(finish + 2);\n    rd[finish + 1] = (1 << d) - 1;\n    for (var j = finish; j >= start; j--) {\n      // The alphabet (s) is a sparse hash, so the following line generates\n      // warnings.\n      var charMatch = s[text.charAt(j - 1)];\n      if (d === 0) {  // First pass: exact match.\n        rd[j] = ((rd[j + 1] << 1) | 1) & charMatch;\n      } else {  // Subsequent passes: fuzzy match.\n        rd[j] = ((rd[j + 1] << 1) | 1) & charMatch |\n                (((last_rd[j + 1] | last_rd[j]) << 1) | 1) |\n                last_rd[j + 1];\n      }\n      if (rd[j] & matchmask) {\n        var score = match_bitapScore(d, j - 1);\n        // This match will almost certainly be better than any existing match.\n        // But check anyway.\n        if (score <= score_threshold) {\n          // Told you so.\n          score_threshold = score;\n          best_loc = j - 1;\n          if (best_loc > loc) {\n            // When passing loc, don't exceed our current distance from loc.\n            start = Math.max(1, 2 * loc - best_loc);\n          } else {\n            // Already passed loc, downhill from here on in.\n            break;\n          }\n        }\n      }\n    }\n    // No hope for a (better) match at greater error levels.\n    if (match_bitapScore(d + 1, loc) > score_threshold) {\n      break;\n    }\n    last_rd = rd;\n  }\n  return best_loc;\n};\n\n\n/**\n * Initialise the alphabet for the Bitap algorithm.\n * @param {string} pattern The text to encode.\n * @return {Object} Hash of character locations.\n * @private\n */\ndiff_match_patch.prototype.match_alphabet = function(pattern) {\n  var s = {};\n  for (var i = 0; i < pattern.length; i++) {\n    s[pattern.charAt(i)] = 0;\n  }\n  for (var i = 0; i < pattern.length; i++) {\n    s[pattern.charAt(i)] |= 1 << (pattern.length - i - 1);\n  }\n  return s;\n};\n\n\n//  PATCH FUNCTIONS\n\n\n/**\n * Increase the context until it is unique,\n * but don't let the pattern expand beyond Match_MaxBits.\n * @param {patch_obj} patch The patch to grow.\n * @param {string} text Source text.\n * @private\n */\ndiff_match_patch.prototype.patch_addContext = function(patch, text) {\n  if (text.length == 0) {\n    return;\n  }\n  var pattern = text.substring(patch.start2, patch.start2 + patch.length1);\n  var padding = 0;\n\n  // Look for the first and last matches of pattern in text.  If two different\n  // matches are found, increase the pattern length.\n  while (text.indexOf(pattern) != text.lastIndexOf(pattern) &&\n         pattern.length < this.Match_MaxBits - this.Patch_Margin -\n         this.Patch_Margin) {\n    padding += this.Patch_Margin;\n    pattern = text.substring(patch.start2 - padding,\n                             patch.start2 + patch.length1 + padding);\n  }\n  // Add one chunk for good luck.\n  padding += this.Patch_Margin;\n\n  // Add the prefix.\n  var prefix = text.substring(patch.start2 - padding, patch.start2);\n  if (prefix) {\n    patch.diffs.unshift([DIFF_EQUAL, prefix]);\n  }\n  // Add the suffix.\n  var suffix = text.substring(patch.start2 + patch.length1,\n                              patch.start2 + patch.length1 + padding);\n  if (suffix) {\n    patch.diffs.push([DIFF_EQUAL, suffix]);\n  }\n\n  // Roll back the start points.\n  patch.start1 -= prefix.length;\n  patch.start2 -= prefix.length;\n  // Extend the lengths.\n  patch.length1 += prefix.length + suffix.length;\n  patch.length2 += prefix.length + suffix.length;\n};\n\n\n/**\n * Compute a list of patches to turn text1 into text2.\n * Use diffs if provided, otherwise compute it ourselves.\n * There are four ways to call this function, depending on what data is\n * available to the caller:\n * Method 1:\n * a = text1, b = text2\n * Method 2:\n * a = diffs\n * Method 3 (optimal):\n * a = text1, b = diffs\n * Method 4 (deprecated, use method 3):\n * a = text1, b = text2, c = diffs\n *\n * @param {string|Array.<Array.<number|string>>} a text1 (methods 1,3,4) or\n * Array of diff tuples for text1 to text2 (method 2).\n * @param {string|Array.<Array.<number|string>>} opt_b text2 (methods 1,4) or\n * Array of diff tuples for text1 to text2 (method 3) or undefined (method 2).\n * @param {string|Array.<Array.<number|string>>} opt_c Array of diff tuples for\n * text1 to text2 (method 4) or undefined (methods 1,2,3).\n * @return {Array.<patch_obj>} Array of patch objects.\n */\ndiff_match_patch.prototype.patch_make = function(a, opt_b, opt_c) {\n  var text1, diffs;\n  if (typeof a == 'string' && typeof opt_b == 'string' &&\n      typeof opt_c == 'undefined') {\n    // Method 1: text1, text2\n    // Compute diffs from text1 and text2.\n    text1 = a;\n    diffs = this.diff_main(text1, opt_b, true);\n    if (diffs.length > 2) {\n      this.diff_cleanupSemantic(diffs);\n      this.diff_cleanupEfficiency(diffs);\n    }\n  } else if (a && typeof a == 'object' && typeof opt_b == 'undefined' &&\n      typeof opt_c == 'undefined') {\n    // Method 2: diffs\n    // Compute text1 from diffs.\n    diffs = a;\n    text1 = this.diff_text1(diffs);\n  } else if (typeof a == 'string' && opt_b && typeof opt_b == 'object' &&\n      typeof opt_c == 'undefined') {\n    // Method 3: text1, diffs\n    text1 = a;\n    diffs = opt_b;\n  } else if (typeof a == 'string' && typeof opt_b == 'string' &&\n      opt_c && typeof opt_c == 'object') {\n    // Method 4: text1, text2, diffs\n    // text2 is not used.\n    text1 = a;\n    diffs = opt_c;\n  } else {\n    throw new Error('Unknown call format to patch_make.');\n  }\n\n  if (diffs.length === 0) {\n    return [];  // Get rid of the null case.\n  }\n  var patches = [];\n  var patch = new patch_obj();\n  var patchDiffLength = 0;  // Keeping our own length var is faster in JS.\n  var char_count1 = 0;  // Number of characters into the text1 string.\n  var char_count2 = 0;  // Number of characters into the text2 string.\n  // Start with text1 (prepatch_text) and apply the diffs until we arrive at\n  // text2 (postpatch_text).  We recreate the patches one by one to determine\n  // context info.\n  var prepatch_text = text1;\n  var postpatch_text = text1;\n  for (var x = 0; x < diffs.length; x++) {\n    var diff_type = diffs[x][0];\n    var diff_text = diffs[x][1];\n\n    if (!patchDiffLength && diff_type !== DIFF_EQUAL) {\n      // A new patch starts here.\n      patch.start1 = char_count1;\n      patch.start2 = char_count2;\n    }\n\n    switch (diff_type) {\n      case DIFF_INSERT:\n        patch.diffs[patchDiffLength++] = diffs[x];\n        patch.length2 += diff_text.length;\n        postpatch_text = postpatch_text.substring(0, char_count2) + diff_text +\n                         postpatch_text.substring(char_count2);\n        break;\n      case DIFF_DELETE:\n        patch.length1 += diff_text.length;\n        patch.diffs[patchDiffLength++] = diffs[x];\n        postpatch_text = postpatch_text.substring(0, char_count2) +\n                         postpatch_text.substring(char_count2 +\n                             diff_text.length);\n        break;\n      case DIFF_EQUAL:\n        if (diff_text.length <= 2 * this.Patch_Margin &&\n            patchDiffLength && diffs.length != x + 1) {\n          // Small equality inside a patch.\n          patch.diffs[patchDiffLength++] = diffs[x];\n          patch.length1 += diff_text.length;\n          patch.length2 += diff_text.length;\n        } else if (diff_text.length >= 2 * this.Patch_Margin) {\n          // Time for a new patch.\n          if (patchDiffLength) {\n            this.patch_addContext(patch, prepatch_text);\n            patches.push(patch);\n            patch = new patch_obj();\n            patchDiffLength = 0;\n            // Unlike Unidiff, our patch lists have a rolling context.\n            // http://code.google.com/p/google-diff-match-patch/wiki/Unidiff\n            // Update prepatch text & pos to reflect the application of the\n            // just completed patch.\n            prepatch_text = postpatch_text;\n            char_count1 = char_count2;\n          }\n        }\n        break;\n    }\n\n    // Update the current character count.\n    if (diff_type !== DIFF_INSERT) {\n      char_count1 += diff_text.length;\n    }\n    if (diff_type !== DIFF_DELETE) {\n      char_count2 += diff_text.length;\n    }\n  }\n  // Pick up the leftover patch if not empty.\n  if (patchDiffLength) {\n    this.patch_addContext(patch, prepatch_text);\n    patches.push(patch);\n  }\n\n  return patches;\n};\n\n\n/**\n * Given an array of patches, return another array that is identical.\n * @param {Array.<patch_obj>} patches Array of patch objects.\n * @return {Array.<patch_obj>} Array of patch objects.\n */\ndiff_match_patch.prototype.patch_deepCopy = function(patches) {\n  // Making deep copies is hard in JavaScript.\n  var patchesCopy = [];\n  for (var x = 0; x < patches.length; x++) {\n    var patch = patches[x];\n    var patchCopy = new patch_obj();\n    patchCopy.diffs = [];\n    for (var y = 0; y < patch.diffs.length; y++) {\n      patchCopy.diffs[y] = patch.diffs[y].slice();\n    }\n    patchCopy.start1 = patch.start1;\n    patchCopy.start2 = patch.start2;\n    patchCopy.length1 = patch.length1;\n    patchCopy.length2 = patch.length2;\n    patchesCopy[x] = patchCopy;\n  }\n  return patchesCopy;\n};\n\n\n/**\n * Merge a set of patches onto the text.  Return a patched text, as well\n * as a list of true/false values indicating which patches were applied.\n * @param {Array.<patch_obj>} patches Array of patch objects.\n * @param {string} text Old text.\n * @return {Array.<string|Array.<boolean>>} Two element Array, containing the\n *      new text and an array of boolean values.\n */\ndiff_match_patch.prototype.patch_apply = function(patches, text) {\n  if (patches.length == 0) {\n    return [text, []];\n  }\n\n  // Deep copy the patches so that no changes are made to originals.\n  patches = this.patch_deepCopy(patches);\n\n  var nullPadding = this.patch_addPadding(patches);\n  text = nullPadding + text + nullPadding;\n\n  this.patch_splitMax(patches);\n  // delta keeps track of the offset between the expected and actual location\n  // of the previous patch.  If there are patches expected at positions 10 and\n  // 20, but the first patch was found at 12, delta is 2 and the second patch\n  // has an effective expected position of 22.\n  var delta = 0;\n  var results = [];\n  for (var x = 0; x < patches.length; x++) {\n    var expected_loc = patches[x].start2 + delta;\n    var text1 = this.diff_text1(patches[x].diffs);\n    var start_loc;\n    var end_loc = -1;\n    if (text1.length > this.Match_MaxBits) {\n      // patch_splitMax will only provide an oversized pattern in the case of\n      // a monster delete.\n      start_loc = this.match_main(text, text1.substring(0, this.Match_MaxBits),\n                                  expected_loc);\n      if (start_loc != -1) {\n        end_loc = this.match_main(text,\n            text1.substring(text1.length - this.Match_MaxBits),\n            expected_loc + text1.length - this.Match_MaxBits);\n        if (end_loc == -1 || start_loc >= end_loc) {\n          // Can't find valid trailing context.  Drop this patch.\n          start_loc = -1;\n        }\n      }\n    } else {\n      start_loc = this.match_main(text, text1, expected_loc);\n    }\n    if (start_loc == -1) {\n      // No match found.  :(\n      results[x] = false;\n      // Subtract the delta for this failed patch from subsequent patches.\n      delta -= patches[x].length2 - patches[x].length1;\n    } else {\n      // Found a match.  :)\n      results[x] = true;\n      delta = start_loc - expected_loc;\n      var text2;\n      if (end_loc == -1) {\n        text2 = text.substring(start_loc, start_loc + text1.length);\n      } else {\n        text2 = text.substring(start_loc, end_loc + this.Match_MaxBits);\n      }\n      if (text1 == text2) {\n        // Perfect match, just shove the replacement text in.\n        text = text.substring(0, start_loc) +\n               this.diff_text2(patches[x].diffs) +\n               text.substring(start_loc + text1.length);\n      } else {\n        // Imperfect match.  Run a diff to get a framework of equivalent\n        // indices.\n        var diffs = this.diff_main(text1, text2, false);\n        if (text1.length > this.Match_MaxBits &&\n            this.diff_levenshtein(diffs) / text1.length >\n            this.Patch_DeleteThreshold) {\n          // The end points match, but the content is unacceptably bad.\n          results[x] = false;\n        } else {\n          this.diff_cleanupSemanticLossless(diffs);\n          var index1 = 0;\n          var index2;\n          for (var y = 0; y < patches[x].diffs.length; y++) {\n            var mod = patches[x].diffs[y];\n            if (mod[0] !== DIFF_EQUAL) {\n              index2 = this.diff_xIndex(diffs, index1);\n            }\n            if (mod[0] === DIFF_INSERT) {  // Insertion\n              text = text.substring(0, start_loc + index2) + mod[1] +\n                     text.substring(start_loc + index2);\n            } else if (mod[0] === DIFF_DELETE) {  // Deletion\n              text = text.substring(0, start_loc + index2) +\n                     text.substring(start_loc + this.diff_xIndex(diffs,\n                         index1 + mod[1].length));\n            }\n            if (mod[0] !== DIFF_DELETE) {\n              index1 += mod[1].length;\n            }\n          }\n        }\n      }\n    }\n  }\n  // Strip the padding off.\n  text = text.substring(nullPadding.length, text.length - nullPadding.length);\n  return [text, results];\n};\n\n\n/**\n * Add some padding on text start and end so that edges can match something.\n * Intended to be called only from within patch_apply.\n * @param {Array.<patch_obj>} patches Array of patch objects.\n * @return {string} The padding string added to each side.\n */\ndiff_match_patch.prototype.patch_addPadding = function(patches) {\n  var paddingLength = this.Patch_Margin;\n  var nullPadding = '';\n  for (var x = 1; x <= paddingLength; x++) {\n    nullPadding += String.fromCharCode(x);\n  }\n\n  // Bump all the patches forward.\n  for (var x = 0; x < patches.length; x++) {\n    patches[x].start1 += paddingLength;\n    patches[x].start2 += paddingLength;\n  }\n\n  // Add some padding on start of first diff.\n  var patch = patches[0];\n  var diffs = patch.diffs;\n  if (diffs.length == 0 || diffs[0][0] != DIFF_EQUAL) {\n    // Add nullPadding equality.\n    diffs.unshift([DIFF_EQUAL, nullPadding]);\n    patch.start1 -= paddingLength;  // Should be 0.\n    patch.start2 -= paddingLength;  // Should be 0.\n    patch.length1 += paddingLength;\n    patch.length2 += paddingLength;\n  } else if (paddingLength > diffs[0][1].length) {\n    // Grow first equality.\n    var extraLength = paddingLength - diffs[0][1].length;\n    diffs[0][1] = nullPadding.substring(diffs[0][1].length) + diffs[0][1];\n    patch.start1 -= extraLength;\n    patch.start2 -= extraLength;\n    patch.length1 += extraLength;\n    patch.length2 += extraLength;\n  }\n\n  // Add some padding on end of last diff.\n  patch = patches[patches.length - 1];\n  diffs = patch.diffs;\n  if (diffs.length == 0 || diffs[diffs.length - 1][0] != DIFF_EQUAL) {\n    // Add nullPadding equality.\n    diffs.push([DIFF_EQUAL, nullPadding]);\n    patch.length1 += paddingLength;\n    patch.length2 += paddingLength;\n  } else if (paddingLength > diffs[diffs.length - 1][1].length) {\n    // Grow last equality.\n    var extraLength = paddingLength - diffs[diffs.length - 1][1].length;\n    diffs[diffs.length - 1][1] += nullPadding.substring(0, extraLength);\n    patch.length1 += extraLength;\n    patch.length2 += extraLength;\n  }\n\n  return nullPadding;\n};\n\n\n/**\n * Look through the patches and break up any which are longer than the maximum\n * limit of the match algorithm.\n * @param {Array.<patch_obj>} patches Array of patch objects.\n */\ndiff_match_patch.prototype.patch_splitMax = function(patches) {\n  for (var x = 0; x < patches.length; x++) {\n    if (patches[x].length1 > this.Match_MaxBits) {\n      var bigpatch = patches[x];\n      // Remove the big old patch.\n      patches.splice(x--, 1);\n      var patch_size = this.Match_MaxBits;\n      var start1 = bigpatch.start1;\n      var start2 = bigpatch.start2;\n      var precontext = '';\n      while (bigpatch.diffs.length !== 0) {\n        // Create one of several smaller patches.\n        var patch = new patch_obj();\n        var empty = true;\n        patch.start1 = start1 - precontext.length;\n        patch.start2 = start2 - precontext.length;\n        if (precontext !== '') {\n          patch.length1 = patch.length2 = precontext.length;\n          patch.diffs.push([DIFF_EQUAL, precontext]);\n        }\n        while (bigpatch.diffs.length !== 0 &&\n               patch.length1 < patch_size - this.Patch_Margin) {\n          var diff_type = bigpatch.diffs[0][0];\n          var diff_text = bigpatch.diffs[0][1];\n          if (diff_type === DIFF_INSERT) {\n            // Insertions are harmless.\n            patch.length2 += diff_text.length;\n            start2 += diff_text.length;\n            patch.diffs.push(bigpatch.diffs.shift());\n            empty = false;\n          } else if (diff_type === DIFF_DELETE && patch.diffs.length == 1 &&\n                     patch.diffs[0][0] == DIFF_EQUAL &&\n                     diff_text.length > 2 * patch_size) {\n            // This is a large deletion.  Let it pass in one chunk.\n            patch.length1 += diff_text.length;\n            start1 += diff_text.length;\n            empty = false;\n            patch.diffs.push([diff_type, diff_text]);\n            bigpatch.diffs.shift();\n          } else {\n            // Deletion or equality.  Only take as much as we can stomach.\n            diff_text = diff_text.substring(0, patch_size - patch.length1 -\n                                               this.Patch_Margin);\n            patch.length1 += diff_text.length;\n            start1 += diff_text.length;\n            if (diff_type === DIFF_EQUAL) {\n              patch.length2 += diff_text.length;\n              start2 += diff_text.length;\n            } else {\n              empty = false;\n            }\n            patch.diffs.push([diff_type, diff_text]);\n            if (diff_text == bigpatch.diffs[0][1]) {\n              bigpatch.diffs.shift();\n            } else {\n              bigpatch.diffs[0][1] =\n                  bigpatch.diffs[0][1].substring(diff_text.length);\n            }\n          }\n        }\n        // Compute the head context for the next patch.\n        precontext = this.diff_text2(patch.diffs);\n        precontext =\n            precontext.substring(precontext.length - this.Patch_Margin);\n        // Append the end context for this patch.\n        var postcontext = this.diff_text1(bigpatch.diffs)\n                              .substring(0, this.Patch_Margin);\n        if (postcontext !== '') {\n          patch.length1 += postcontext.length;\n          patch.length2 += postcontext.length;\n          if (patch.diffs.length !== 0 &&\n              patch.diffs[patch.diffs.length - 1][0] === DIFF_EQUAL) {\n            patch.diffs[patch.diffs.length - 1][1] += postcontext;\n          } else {\n            patch.diffs.push([DIFF_EQUAL, postcontext]);\n          }\n        }\n        if (!empty) {\n          patches.splice(++x, 0, patch);\n        }\n      }\n    }\n  }\n};\n\n\n/**\n * Take a list of patches and return a textual representation.\n * @param {Array.<patch_obj>} patches Array of patch objects.\n * @return {string} Text representation of patches.\n */\ndiff_match_patch.prototype.patch_toText = function(patches) {\n  var text = [];\n  for (var x = 0; x < patches.length; x++) {\n    text[x] = patches[x];\n  }\n  return text.join('');\n};\n\n\n/**\n * Parse a textual representation of patches and return a list of patch objects.\n * @param {string} textline Text representation of patches.\n * @return {Array.<patch_obj>} Array of patch objects.\n * @throws {Error} If invalid input.\n */\ndiff_match_patch.prototype.patch_fromText = function(textline) {\n  var patches = [];\n  if (!textline) {\n    return patches;\n  }\n  // Opera doesn't know how to decode char 0.\n  textline = textline.replace(/%00/g, '\\0');\n  var text = textline.split('\\n');\n  var textPointer = 0;\n  while (textPointer < text.length) {\n    var m = text[textPointer].match(/^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/);\n    if (!m) {\n      throw new Error('Invalid patch string: ' + text[textPointer]);\n    }\n    var patch = new patch_obj();\n    patches.push(patch);\n    patch.start1 = parseInt(m[1], 10);\n    if (m[2] === '') {\n      patch.start1--;\n      patch.length1 = 1;\n    } else if (m[2] == '0') {\n      patch.length1 = 0;\n    } else {\n      patch.start1--;\n      patch.length1 = parseInt(m[2], 10);\n    }\n\n    patch.start2 = parseInt(m[3], 10);\n    if (m[4] === '') {\n      patch.start2--;\n      patch.length2 = 1;\n    } else if (m[4] == '0') {\n      patch.length2 = 0;\n    } else {\n      patch.start2--;\n      patch.length2 = parseInt(m[4], 10);\n    }\n    textPointer++;\n\n    while (textPointer < text.length) {\n      var sign = text[textPointer].charAt(0);\n      try {\n        var line = decodeURI(text[textPointer].substring(1));\n      } catch (ex) {\n        // Malformed URI sequence.\n        throw new Error('Illegal escape in patch_fromText: ' + line);\n      }\n      if (sign == '-') {\n        // Deletion.\n        patch.diffs.push([DIFF_DELETE, line]);\n      } else if (sign == '+') {\n        // Insertion.\n        patch.diffs.push([DIFF_INSERT, line]);\n      } else if (sign == ' ') {\n        // Minor equality.\n        patch.diffs.push([DIFF_EQUAL, line]);\n      } else if (sign == '@') {\n        // Start of next patch.\n        break;\n      } else if (sign === '') {\n        // Blank line?  Whatever.\n      } else {\n        // WTF?\n        throw new Error('Invalid patch mode \"' + sign + '\" in: ' + line);\n      }\n      textPointer++;\n    }\n  }\n  return patches;\n};\n\n\n/**\n * Class representing one patch operation.\n * @constructor\n */\nfunction patch_obj() {\n  /** @type {Array.<Array.<number|string>>} */\n  this.diffs = [];\n  /** @type {?number} */\n  this.start1 = null;\n  /** @type {?number} */\n  this.start2 = null;\n  /** @type {number} */\n  this.length1 = 0;\n  /** @type {number} */\n  this.length2 = 0;\n}\n\n\n/**\n * Emmulate GNU diff's format.\n * Header: @@ -382,8 +481,9 @@\n * Indicies are printed as 1-based, not 0-based.\n * @return {string} The GNU diff string.\n */\npatch_obj.prototype.toString = function() {\n  var coords1, coords2;\n  if (this.length1 === 0) {\n    coords1 = this.start1 + ',0';\n  } else if (this.length1 == 1) {\n    coords1 = this.start1 + 1;\n  } else {\n    coords1 = (this.start1 + 1) + ',' + this.length1;\n  }\n  if (this.length2 === 0) {\n    coords2 = this.start2 + ',0';\n  } else if (this.length2 == 1) {\n    coords2 = this.start2 + 1;\n  } else {\n    coords2 = (this.start2 + 1) + ',' + this.length2;\n  }\n  var text = ['@@ -' + coords1 + ' +' + coords2 + ' @@\\n'];\n  var op;\n  // Escape the body of the patch with %xx notation.\n  for (var x = 0; x < this.diffs.length; x++) {\n    switch (this.diffs[x][0]) {\n      case DIFF_INSERT:\n        op = '+';\n        break;\n      case DIFF_DELETE:\n        op = '-';\n        break;\n      case DIFF_EQUAL:\n        op = ' ';\n        break;\n    }\n    text[x + 1] = op + encodeURI(this.diffs[x][1]) + '\\n';\n  }\n  // Opera doesn't know how to encode char 0.\n  return text.join('').replace(/\\x00/g, '%00').replace(/%20/g, ' ');\n};\n\n\n// Export these global variables so that they survive Google's JS compiler.\n/*changed by lfborjas: changed `window` for `exports` to make it suitable for the node.js module conventions*/\nexports['diff_match_patch'] = diff_match_patch;\nexports['patch_obj'] = patch_obj;\nexports['DIFF_DELETE'] = DIFF_DELETE;\nexports['DIFF_INSERT'] = DIFF_INSERT;\nexports['DIFF_EQUAL'] = DIFF_EQUAL;\n","\"use strict\";\n\n\nexports.get = require(\"./lib/get\");\nexports.set = require(\"./lib/set\");\nexports.delete = require(\"./lib/delete\");\nexports.join = require(\"./lib/join\");\nexports.split = require(\"./lib/split\");\n\nexports.isRoot = require(\"./lib/isRoot\");\n","\"use strict\";\n\n\nvar split = require(\"./split\");\nvar get = require(\"./get\");\nvar removeUndefinedItems = require(\"./removeUndefinedItems\");\n\n\nfunction pointerDelete(data, pointer, keepArrayIndices) {\n\tvar properties = split(pointer);\n\tvar lastProperty = properties.pop();\n\tvar target = get(data, properties);\n\tif (target) {\n\t\tdelete target[lastProperty];\n\t}\n\tif (Array.isArray(target) && keepArrayIndices !== true) {\n\t\tremoveUndefinedItems(target);\n\t}\n\treturn data;\n}\n\n\nmodule.exports = pointerDelete;\n","\"use strict\";\n\nvar split = require(\"./split\");\nvar isRoot = require(\"./isRoot\");\n\n\nfunction get(data, pointer, defaultValue) {\n\tif (pointer == null || data == null) {\n\t\treturn defaultValue;\n\t}\n\tif (isRoot(pointer)) {\n\t\treturn data;\n\t}\n\tconst result = run(data, split(pointer));\n\tif (result === undefined) {\n\t\treturn defaultValue;\n\t}\n\treturn result;\n}\n\nfunction run(data, path) {\n\tvar property = path.shift();\n\tif (data === undefined) {\n\t\treturn;\n\t} else if (property !== undefined) {\n\t\treturn run(data[property], path);\n\t}\n\treturn data;\n}\n\n\nmodule.exports = get;\n","module.exports = function isRoot(pointer) {\n\treturn pointer === \"#\" || pointer === \"\";\n};\n","\"use strict\";\n\n\nvar split = require(\"./split\");\nvar toString = Object.prototype.toString;\nvar simpleJoin = Array.prototype.join;\nvar matchMutlipleSlashes = /\\/+/g;\nvar matchTildes = /~/g;\nvar matchSlashes = /\\//g;\n\n\nfunction joinList(list, isURI) {\n\tif (list.length === 0) {\n\t\treturn isURI ? \"#\" : \"\";\n\t}\n\n\tvar pointer = list.join(\"/\");\n\tfor (var i = 0, l = list.length; i < l; i += 1) {\n\t\tlist[i] = list[i].replace(matchTildes, \"~0\").replace(matchSlashes, \"~1\");\n\t\tif (isURI) {\n\t\t\tlist[i] = encodeURIComponent(list[i]);\n\t\t}\n\t}\n\n\tvar pointer = (isURI ? \"#/\" : \"/\") + list.join(\"/\");\n\treturn pointer.replace(matchMutlipleSlashes, \"/\");\n}\n\n\nfunction join(firstPointer) {\n\tvar result = [];\n\tif (Array.isArray(firstPointer)) {\n\t\treturn joinList(firstPointer, arguments[1] === true);\n\t}\n\n\t// determine type of pointer\n\tvar option = arguments[arguments.length - 1];\n\tvar isURI = (typeof option === \"boolean\") ? option : (firstPointer && firstPointer[0] === \"#\");\n\n\tfor (var i = 0, l = arguments.length; i < l; i += 1) {\n\t\tresult.push.apply(result, split(arguments[i]));\n\t}\n\n\t// build final list of properties\n\tvar pointer = [];\n\tfor (var i = 0, l = result.length; i < l; i += 1) {\n\t\tif (result[i] === \"..\") {\n\t\t\tif (pointer.length === 0) {\n\t\t\t\treturn isURI ? \"#\" : \"\";\n\t\t\t}\n\t\t\tpointer.pop();\n\t\t} else {\n\t\t\tpointer.push(result[i]);\n\t\t}\n\t}\n\n\treturn joinList(pointer, isURI);\n}\n\n\nmodule.exports = join;\n","\"use strict\";\n\n\nfunction removeUndefinedItems(array) {\n\tvar i = 0;\n\tvar skip = 0;\n\twhile ((i + skip) < array.length) {\n\t\tif (array[i + skip] === undefined) {\n\t\t\tskip += 1;\n\t\t}\n\t\tarray[i] = array[i + skip];\n\t\ti += 1;\n\t}\n\tarray.length = array.length - skip;\n\treturn array;\n}\n\n\nmodule.exports = removeUndefinedItems;\n","\"use strict\";\n\n\nvar split = require(\"./split\");\nvar isArray = /^\\[.*\\]$/;\nvar arrayIndex = /^\\[(.+)\\]$/;\n\n\nfunction set(data, pointer, value) {\n\tif (pointer == null) {\n\t\treturn data;\n\t}\n\n\tvar properties = split(pointer);\n\tif (properties.length === 0) {\n\t\treturn data;\n\t}\n\n\tif (data == null) {\n\t\tdata = isArray.test(properties[0]) ? [] : {};\n\t}\n\n\tvar key, nextKeyIsArray, current = data;\n\twhile (properties.length > 1) {\n\t\tkey = properties.shift();\n\t\tnextKeyIsArray = isArray.test(properties[0]);\n\t\tcurrent = create(current, key, nextKeyIsArray);\n\t}\n\tkey = properties.pop();\n\taddValue(current, key, value);\n\treturn data;\n}\n\n\nfunction addValue(data, key, value) {\n\tvar index;\n\tvar keyAsIndex = key.match(arrayIndex);\n\tif (key === \"[]\" && Array.isArray(data)) {\n\t\tdata.push(value);\n\t} else if (keyAsIndex) {\n\t\tindex = keyAsIndex.pop();\n\t\tdata[index] = value;\n\t} else {\n\t\tdata[key] = value;\n\t}\n}\n\n\nfunction create(data, key, isArray) {\n\tif (data[key] != null) {\n\t\treturn data[key];\n\t}\n\tvar value = isArray ? [] : {};\n\taddValue(data, key, value);\n\treturn value;\n}\n\n\nmodule.exports = set;\n","\"use strict\";\n\nvar isRoot = require(\"./isRoot\");\n\nvar matchSlashes = /~1/g;\nvar matchTildes = /~0/g;\nvar matchMutlipleSlashes = /\\/+/g;\nvar matchPointerPrefixes = /(^[#/]*|\\/+$)/g;\n\n\nfunction sanitizeProperty(property) {\n\treturn property.replace(matchSlashes, \"/\").replace(matchTildes, \"~\");\n}\n\n\nfunction sanitizeAndDecodeProperty(property) {\n\treturn sanitizeProperty(decodeURIComponent(property));\n}\n\n\nfunction split(pointer) {\n\tif (pointer == null || typeof pointer !== \"string\" || isRoot(pointer)) {\n\t\treturn Array.isArray(pointer) ? pointer : [];\n\t}\n\tconst sanitize = pointer.indexOf(\"#\") >= 0 ? sanitizeAndDecodeProperty : sanitizeProperty;\n\tpointer = pointer.replace(matchMutlipleSlashes, \"/\");\n\tpointer = pointer.replace(matchPointerPrefixes, \"\");\n\n\tvar result = pointer.split(\"/\");\n\tfor (var i = 0, l = result.length; i < l; i += 1) {\n\t\tresult[i] = sanitize(result[i]);\n\t}\n\treturn result;\n}\n\n\nmodule.exports = split;","module.exports = {\n    config: {\n        strings: require(\"./lib/config/strings\")\n    },\n    cores: {\n        Interface: require(\"./lib/cores/CoreInterface\"),\n        Draft04: require(\"./lib/cores/Draft04\"), // core implementing draft04 specs\n        JsonEditor: require(\"./lib/cores/JsonEditor\") // adjusted core of draft04 to better support the json-editor\n    },\n    addSchema: require(\"./lib/addSchema\"),\n    createCustomError: require(\"./lib/utils/createCustomError\"),\n    addValidator: require(\"./lib/addValidator\"), // add validation for keyword, format, datatype and customize errors\n    createSchemaOf: require(\"./lib/createSchemaOf\"), // creates a simple schema based on the given data\n    each: require(\"./lib/each\"), // iterate over data, receiving each data-entry with its schema\n    getSchema: require(\"./lib/getSchema\"), // get schema of data\n    getChildSchemaSelection: require(\"./lib/getChildSchemaSelection\"), // get available child schemas\n    getTemplate: require(\"./lib/getTemplate\"), // create data based which validates the given schema\n    getTypeOf: require(\"./lib/getTypeOf\"), // returns the javascript datatype\n    isValid: require(\"./lib/isValid\"), // returns a boolean if the schema is valid\n    iterateSchema: require(\"./lib/iterateSchema\"), // iterates over a json-schema\n    SchemaService: require(\"./lib/SchemaService\"),\n    step: require(\"./lib/step\"), // steps into a json-schema, returning the matching child-schema\n    validate: require(\"./lib/validate\"), // validates data by a schema\n    validateAsync: require(\"./lib/validateAsync\") // async validation of data by a schema\n};\n","const getSchema = require(\"./getSchema\");\nconst Core = require(\"./cores/JsonEditor\");\nconst gp = require(\"gson-pointer\");\n\n\nfunction copy(value) {\n    return JSON.parse(JSON.stringify(value));\n}\n\n\nclass SchemaService {\n\n    constructor(schema, data) {\n        this.core = new Core(schema);\n        this.schema = schema;\n        this.data = data;\n        this.cache = {};\n    }\n\n    updateData(data) {\n        this.data = data;\n        this.cache = {};\n    }\n\n    updateSchema(schema) {\n        this.schema = schema;\n        this.core.rootSchema = schema;\n        this.cache = {};\n    }\n\n    get(pointer, data) {\n        if (data) { // possibly separate entry point\n            const schema = getSchema(this.core, this.schema, data, pointer);\n            return copy(schema);\n        }\n\n        if (pointer === \"#\") { // root\n            return this.schema;\n        }\n\n        if (this.cache[pointer]) { // return cached result\n            return this.cache[pointer];\n        }\n\n        const parentPointer = gp.join(pointer, \"..\");\n        let parentSchema = this.cache[parentPointer];\n        if (parentSchema == null) {\n            // store parent (major performance improvement if its within oneof)\n            parentSchema = getSchema(this.core, this.schema, this.data, parentPointer);\n            if (parentSchema.variableSchema !== true) {\n                this.cache[parentPointer] = copy(parentSchema);\n            }\n        }\n\n        // step from parent to child\n        const key = gp.split(pointer).pop();\n        let schema = getSchema(this.core, this.cache[parentPointer], gp.get(this.data, parentPointer), key);\n        schema = copy(schema);\n        if (schema.variableSchema !== true) {\n            this.cache[pointer] = schema;\n        }\n        return schema;\n    }\n}\n\n\nmodule.exports = SchemaService;\n","const remotes = require(\"../remotes\");\nconst precompile = require(\"./precompileSchema\");\n\n\nmodule.exports = function addSchema(url, schema) {\n    schema.id = schema.id || url;\n    remotes[url] = precompile(null, schema);\n};\n","/**\n * @throws Error\n * Adds a custom error. May override existing errors\n *\n * @param {Core} core\n * @param {String} errorId          - id of error @see /lib/validation/errors\n * @param {Function} errorCreator   - function returning an error-object @see /lib/utils/createCustomError\n */\nfunction addError(core, errorId, errorCreator) {\n    if (typeof errorCreator !== \"function\") {\n        throw new Error(`Error callback 'errorCreator' must be of type function. Received ${typeof errorCreator}`);\n    }\n    core.errors[errorId] = errorCreator;\n}\n\n/**\n * Adds a custom format validator. Existing format may not be overriden (may still be modified manually)\n * @param {Core} core\n * @param {String} formatType           - format type (i.e. `format: \"html\"`)\n * @param {Function} validationFunction - called with (core, schema, value, pointer)\n */\nfunction addFormat(core, formatType, validationFunction) {\n    if (typeof validationFunction !== \"function\") {\n        throw new Error(`Validation function expected. Received ${typeof validationFunction}`);\n    }\n    if (core.validateFormat[formatType] == null) {\n        core.validateFormat[formatType] = validationFunction;\n        return;\n    }\n    throw new Error(`A format '${formatType}' is already registered to validation`);\n}\n\n/**\n * Adds a custom keyword validation to a specific type. May not override existing keywords.\n *\n * @param {Core} core\n * @param {String} datatype             - valid datatype like \"object\", \"array\", \"string\", etc\n * @param {String} keyword              - The keyword to add, i.e. `minWidth: ...`\n * @param {Function} validationFunction - called with (core, schema, value, pointer)\n */\nfunction addKeyword(core, datatype, keyword, validationFunction) {\n    if (typeof validationFunction !== \"function\") {\n        throw new Error(`Validation function expected. Received ${typeof validationFunction}`);\n    }\n    if (core.typeKeywords[datatype] == null) {\n        throw new Error(`Unknown datatype ${datatype}. Failed adding custom keyword validation.`);\n    }\n    if (core.typeKeywords[datatype].includes(keyword) === false) {\n        core.typeKeywords[datatype].push(keyword);\n    }\n    core.validateKeyword[keyword] = validationFunction;\n}\n\n\nmodule.exports = {\n    error: addError,\n    format: addFormat,\n    keyword: addKeyword\n};\n","module.exports = {\n\n    floatingPointPrecision: 10000,\n    propertyBlacklist: [\"_id\"]\n};\n","/* eslint max-len: 0 */\nmodule.exports = {\n    // validation errors\n    AdditionalItemsError: \"Array at `{{pointer}}` may not have an additional item `{{key}}`\",\n    AdditionalPropertiesError: \"Additional property `{{property}}` on `{{pointer}}` does not match schema `{{schema}}`\",\n    AnyOfError: \"Value `{{value}}` at `{{pointer}}` does not match any schema of `{{anyOf}}`\",\n    EnumError: \"Expected given value `{{value}}` in `{{pointer}}` to be one of `{{values}}`\",\n    FormatDateTimeError: \"Value `{{value}}` at `{{pointer}}` is not a valid date-time\",\n    FormatEmailError: \"Value `{{value}}` at `{{pointer}}` is not a valid email\",\n    FormatUrlError: \"Value `{{value}}` at `{{pointer}}` is not a valid url\",\n    FormatUriError: \"Value `{{value}}` at `{{pointer}}` is not a valid uri\",\n    FormatHostnameError: \"Value `{{value}}` at `{{pointer}}` is not a valid hostname\",\n    FormatIPV4Error: \"Value `{{value}}` at `{{pointer}}` is not a valid IPv4 address\",\n    FormatIPV6Error: \"Value `{{value}}` at `{{pointer}}` is not a valid IPv6 address\",\n    FormatRegExError: \"Value `{{value}}` at `{{pointer}}` is not a valid regular expression\",\n    MaximumError: \"Value in `{{pointer}}` is `{{length}}`, but should be `{{maximum}}` at maximum\",\n    MaxItemsError: \"Too many items in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`\",\n    MaxLengthError: \"Value `{{pointer}}` should have a maximum length of `{{maxLength}}`, but got `{{length}}`.\",\n    MaxPropertiesError: \"Too many properties in `{{pointer}}`, should be `{{maximum}}` at most, but got `{{length}}`\",\n    MinimumError: \"Value in `{{pointer}}` is `{{length}}`, but should be `{{minimum}}` at minimum\",\n    MinItemsError: \"Too few items in `{{pointer}}`, should be at least `{{minimum}}`, but got `{{length}}`\",\n    MinLengthError: \"Value `{{pointer}}` should have a minimum length of `{{minLength}}`, but got `{{length}}`.\",\n    MinPropertiesError: \"Too few properties in `{{pointer}}`, should be at least `{{minimum}}`, but got `{{length}}`\",\n    MissingOneOfPropertyError: \"Value at `{{pointer}}aroperty `{{property}}`\",\n    MissingDependencyError: \"The required propery '{{missingProperty}}' in `{{pointer}}` is missing\",\n    MultipleOfError: \"Expected `{{value}}` in `{{pointer}}` to be multiple of `{{multipleOf}}`\",\n    MultipleOneOfError: \"Value `{{value}}` should not match multiple schemas in oneOf `{{matches}}`\",\n    NoAdditionalPropertiesError: \"Additional property `{{property}}` in `{{pointer}}` is not allowed\",\n    NotError: \"Value `{{value}}` at pointer should not match schema `{{not}}`\",\n    OneOfError: \"Value `{{value}}` in `{{pointer}}` does not match any given oneof schema\",\n    OneOfPropertyError: \"Failed finding a matching oneOfProperty schema in `{{pointer}}` where `{{property}}` matches `{{value}}`\",\n    PatternError: \"Value in `{{pointer}}` should match `{{description}}`, but received `{{received}}`\",\n    PatternPropertiesError: \"Property `{{key}}` does not match any patterns in `{{pointer}}`. Valid patterns are: {{patterns}}\",\n    RequiredPropertyError: \"The required property `{{key}}` is missing at `{{pointer}}`\",\n    TypeError: \"Expected `{{value}}` ({{received}}) in `{{pointer}}` to be of type `{{expected}}`\",\n    UndefinedValueError: \"Value must not be undefined in `{{pointer}}`\",\n    UnknownPropertyError: \"Could not find a valid schema for property `{{pointer}}` within object\",\n    UniqueItemsError: \"Expected unique items in {{pointer}}: duplicate value `{{value}}` found at {{itemPointer}} and {{duplicatePointer}}\",\n    ValueNotEmptyError: \"A value for `{{property}}` is required at `{{pointer}}`\"\n};\n","const resolveRef = require(\"../resolveRef.withOverwrite\");\nconst precompile = require(\"../precompileSchema\");\n\n/* eslint no-unused-vars: 0 no-empty-function: 0 */\nmodule.exports = class CoreInterface {\n\n    constructor(schema) {\n        this.setSchema(schema);\n    }\n\n    get rootSchema() {\n        return this.__rootSchema;\n    }\n\n    set rootSchema(rootSchema) {\n        if (rootSchema == null) {\n            return;\n        }\n        // initially resolve any $refs on rootschema (in case this is a reference to a remote or self-referenced schema)\n        const schema = precompile(this, rootSchema);\n        this.__rootSchema = resolveRef(schema, schema);\n    }\n\n    each(schema, data, callback, pointer = \"#\") {\n        return new Error(\"function 'each' is not implemented\");\n    }\n\n    step(key, schema, data, pointer = \"#\") {\n        return new Error(\"function 'step' is not implemented\");\n    }\n\n    validate(schema, data, pointer = \"#\") {\n        return [new Error(\"function 'validate' is not implemented\")];\n    }\n\n    isValid(schema, data, pointer = \"#\") {\n        return new Error(\"function 'isValid' is not implemented\");\n    }\n\n    resolveOneOf(schema, data, pointer = \"#\") {\n        return new Error(\"function 'resolveOneOf' is not implemented\");\n    }\n\n    resolveRef(schema) {\n        return new Error(\"function 'resolveRef' is not implemented\");\n    }\n\n    getSchema(schema, data, pointer = \"#\") {\n        return new Error(\"function 'getSchema' is not implemented\");\n    }\n\n    getTemplate(schema, data) {\n        return new Error(\"function 'getTemplate' is not implemented\");\n    }\n\n    setSchema(schema) {\n        this.rootSchema = schema;\n    }\n};\n","const CoreInterface = require(\"./CoreInterface\");\nconst step = require(\"../step\");\nconst validate = require(\"../validate\");\nconst resolveOneOf = require(\"../resolveOneOf.strict\");\nconst resolveRef = require(\"../resolveRef.strict\");\nconst getTemplate = require(\"../getTemplate\");\nconst getSchema = require(\"../getSchema\");\nconst each = require(\"../each\");\nconst precompile = require(\"../precompileSchema\");\n\n\nclass Draft04Core extends CoreInterface {\n\n    constructor(schema) {\n        super(schema);\n        this.typeKeywords = JSON.parse(JSON.stringify(require(\"../validation/typeKeywordMapping\")));\n        this.validateKeyword = Object.assign({}, require(\"../validation/keyword\"));\n        this.validateType = Object.assign({}, require(\"../validation/type\"));\n        this.validateFormat = Object.assign({}, require(\"../validation/format\"));\n        this.errors = Object.assign({}, require(\"../validation/errors\"));\n    }\n\n    each(schema, data, callback, pointer = \"#\") {\n        each(this, schema, data, callback, pointer);\n    }\n\n    step(key, schema, data, pointer) {\n        return step(this, key, schema, data, pointer);\n    }\n\n    validate(schema, data, pointer = \"#\") {\n        schema = precompile(this, schema);\n        return validate(this, schema, data, pointer);\n    }\n\n    isValid(schema, data, pointer = \"#\") {\n        return this.validate(schema, data, pointer).length === 0;\n    }\n\n    resolveOneOf(schema, data, pointer) {\n        return resolveOneOf(this, schema, data, pointer);\n    }\n\n    resolveRef(schema) {\n        return resolveRef(schema, this.rootSchema);\n    }\n\n    getSchema(schema, data, pointer = \"#\") {\n        return getSchema(this, schema, data, pointer);\n    }\n\n    getTemplate(schema, data) {\n        return getTemplate(this, schema, data, this.rootSchema);\n    }\n}\n\n\nmodule.exports = Draft04Core;\n","const CoreInterface = require(\"./CoreInterface\");\nconst step = require(\"../step\");\nconst validate = require(\"../validate\");\nconst resolveOneOf = require(\"../resolveOneOf.fuzzy\");\nconst resolveRef = require(\"../resolveRef.withOverwrite\");\nconst getTemplate = require(\"../getTemplate\");\nconst getSchema = require(\"../getSchema\");\nconst each = require(\"../each\");\nconst precompile = require(\"../precompileSchema\");\n\n\nclass JsonEditorCore extends CoreInterface {\n\n    constructor(schema) {\n        super(schema);\n        this.typeKeywords = JSON.parse(JSON.stringify(require(\"../validation/typeKeywordMapping\")));\n        this.validateKeyword = Object.assign({}, require(\"../validation/keyword\"));\n        // set properties required per default and prevent no duplicate errors.\n        // This is required for fuzzy resolveOneOf\n        // this.validateKeyword.properties = this.validateKeyword.propertiesRequired;\n        // this.validateKeyword.required = this.validateKeyword.requiredNotEmpty;\n        this.validateType = Object.assign({}, require(\"../validation/type\"));\n        this.validateFormat = Object.assign({}, require(\"../validation/format\"));\n        this.errors = Object.assign({}, require(\"../validation/errors\"));\n    }\n\n    each(schema, data, callback, pointer = \"#\") {\n        each(this, schema, data, callback, pointer);\n    }\n\n    step(key, schema, data, pointer) {\n        return step(this, key, schema, data, pointer);\n    }\n\n    validate(schema, data, pointer = \"#\") {\n        schema = precompile(this, schema);\n        return validate(this, schema, data, pointer);\n    }\n\n    isValid(schema, data, pointer = \"#\") {\n        return this.validate(schema, data, pointer).length === 0;\n    }\n\n    resolveOneOf(schema, data, pointer) {\n        return resolveOneOf(this, schema, data, pointer);\n    }\n\n    resolveRef(schema) {\n        return resolveRef(schema, this.rootSchema);\n    }\n\n    getSchema(schema, data, pointer = \"#\") {\n        return getSchema(this, schema, data, pointer);\n    }\n\n    getTemplate(schema, data) {\n        return getTemplate(this, schema, data, this.rootSchema);\n    }\n}\n\n\nmodule.exports = JsonEditorCore;\n","const getTypeOf = require(\"./getTypeOf\");\n\n\n/**\n * Create a simple json schema for the given input data\n * @param  {Mixed} data     - data to get json schema for\n * @return {Object} schema\n */\nfunction createSchemaOf(data) {\n    const schema = {\n        type: getTypeOf(data)\n    };\n\n    if (schema.type === \"object\") {\n        schema.properties = {};\n        Object.keys(data).forEach((key) => {\n            schema.properties[key] = createSchemaOf(data[key]);\n        });\n    }\n\n    if (schema.type === \"array\" && data.length === 1) {\n        schema.items = createSchemaOf(data[0]);\n\n    } else if (schema.type === \"array\") {\n        schema.items = data.map(createSchemaOf);\n    }\n\n    return schema;\n}\n\n\nmodule.exports = createSchemaOf;\n\n","const getTypeOf = require(\"./getTypeOf\");\n\n\n/**\n * Iterates over data, retrieving its schema\n *\n * @param  {CoreInterface} core - validator\n * @param  {Object} schema      - the schema matching the data\n * @param  {Mixed} data         - the data to iterate\n * @param  {Function} callback  - will be called with (schema, data, pointer) on each item\n * @param  {String} pointer     - pointer to given data\n */\nfunction each(core, schema, data, callback, pointer = \"#\") {\n    callback(schema, data, pointer);\n    const dataType = getTypeOf(data);\n\n    if (dataType === \"object\") {\n        Object.keys(data).forEach((key) => {\n            const nextSchema = core.step(key, schema, data, pointer); // not save\n            const next = data[key]; // save\n            core.each(nextSchema, next, callback, `${pointer}/${key}`);\n        });\n    } else if (dataType === \"array\") {\n        data.forEach((next, key) => {\n            const nextSchema = core.step(key, schema, data, pointer);\n            core.each(nextSchema, next, callback, `${pointer}/${key}`);\n        });\n    }\n}\n\n\nmodule.exports = each;\n","\n/**\n * Returns a list of possible child-schemas for the given property key. In case of a oneOf selection, multiple schemas\n * could be added at the given property (e.g. item-index), thus an array of options is returned. In all other cases\n * a list with a single item will be returned\n *\n * @param  {Core} core      - core to use\n * @param  {Object} schema  - parent schema of following property\n * @param  {String} schema  - parent schema of following property\n * @return {[type]}        [description]\n */\nmodule.exports = function getChildSchemaSelection(core, schema, property) {\n    const result = core.step(property, schema, {}, \"#\");\n\n    if (result.type === \"error\") {\n        if (result.code === \"one-of-error\") {\n            return result.data.oneOf;\n        }\n        return result;\n    }\n\n    return [result];\n};\n","const gp = require(\"gson-pointer\");\nconst emptyObject = {};\n\n\n/**\n * Returns the json-schema of a data-json-pointer.\n *\n *  Notes\n *      - Uses core.step to walk through data and schema\n *\n * @param  {CoreInterface} core\n * @param  {Object} schema      - the json schema (root)\n * @param  {Mixed} data         - the data object, which includes the json pointers value. This is optional, as long as\n *                                  no oneOf, anyOf, etc statement is part of the pointers schema\n * @param  {String} pointer     - json pointer in data to get the json schema for\n * @return {Object|Error} json schema object of the json-pointer or an error\n */\nfunction getSchema(core, schema, data, pointer = \"#\") {\n    const frags = gp.split(pointer);\n    return _get(core, schema, frags, pointer, data);\n}\n\n\nfunction _get(core, schema, frags, pointer, data = emptyObject) {\n    if (frags.length === 0) {\n        return schema;\n    }\n\n    const key = frags.shift(); // step key\n    schema = core.step(key, schema, data, pointer); // step schema\n    if (schema && schema.type === \"error\") {\n        return schema;\n    }\n    data = data[key]; // step data\n    return _get(core, schema, frags, `${pointer}/${key}`, data);\n}\n\n\nmodule.exports = getSchema;\n","/* eslint quote-props: 0 */\nconst resolveOneOfFuzzy = require(\"./resolveOneOf.fuzzy\");\nconst getTypeOf = require(\"./getTypeOf\");\n\nfunction convertValue(type, value) {\n    if (type === \"string\") {\n        return JSON.stringify(value);\n    } else if (typeof value !== \"string\") {\n        return null;\n    }\n\n    try {\n        value = JSON.parse(value);\n        if (typeof value === type) {\n            return value;\n        }\n    } catch (e) {\n        return null;\n    }\n}\n\n\n/**\n * Create data object matching the given schema\n *\n * @param  {CoreInterface} core     - json schema core\n * @param  {Object} schema          - json schema\n * @param  {Mixed} [data]           - optional template data\n * @return {Mixed} created template data\n */\nfunction getTemplate(core, schema, data) {\n    if (schema == null) {\n        throw new Error(\"geTemplate: missing schema for data\", data);\n    }\n\n    if (schema.oneOf) {\n        // find correct schema for data\n        const resolvedSchema = resolveOneOfFuzzy(core, schema, data);\n        if (data == null && resolvedSchema.type === \"error\") {\n            schema = schema.oneOf[0];\n        } else if (resolvedSchema.type === \"error\") {\n            return resolvedSchema;\n\n        } else {\n            schema = resolvedSchema;\n        }\n    }\n\n    // resolve $ref references\n    schema = core.resolveRef(schema);\n\n    if (schema.type == null) {\n        console.warn(`Invalid json-schema: missing property 'type' for ${data && JSON.stringify(data)}`);\n        return \"\";\n    }\n\n    if (data != null && getTypeOf(data) !== schema.type) {\n        // reset invalid type\n        // console.error(\"Schema does not match data\", data, \"schema:\", schema);\n        data = convertValue(schema.type, data);\n    }\n\n    // eslint-disable-next-line no-use-before-define\n    if (TYPE[schema.type] == null) {\n        throw new Error(`Unsupported type '${schema.type} in ${JSON.stringify(schema)}'`);\n    }\n\n    // eslint-disable-next-line no-use-before-define\n    return TYPE[schema.type](core, schema, data);\n}\n\n\nconst TYPE = {\n    \"string\": (core, schema, data) => getDefault(schema, data, \"\"),\n    \"number\": (core, schema, data) => getDefault(schema, data, 0),\n    \"integer\": (core, schema, data) => getDefault(schema, data, 0),\n    \"boolean\": (core, schema, data) => getDefault(schema, data, false),\n    \"object\": (core, schema, data) => {\n        const template = schema.default === undefined ? {} : schema.default;\n        data = data || {};\n\n        if (schema.properties) {\n            Object.keys(schema.properties).forEach((key) => {\n                data[key] = core.getTemplate(schema.properties[key], data[key] == null ? template[key] : data[key]);\n            });\n        }\n\n        return data;\n    },\n    \"array\": (core, schema, data) => {\n        const template = schema.default === undefined ? [] : schema.default;\n        data = data || [];\n        schema.minItems = schema.minItems || 0;\n        if (schema.items == null) {\n            return data;\n        } else if (schema.items.oneOf && data.length === 0) {\n            for (let i = 0; i < schema.minItems; i += 1) {\n                data[i] = core.getTemplate(schema.items.oneOf[0], data[i] == null ? template[i] : data[i]);\n            }\n        } else if (schema.items.oneOf && data.length > 0) {\n            const itemCount = Math.max(schema.minItems, data.length);\n            for (let i = 0; i < itemCount; i += 1) {\n                const value = data[i] == null ? template[i] : data[i];\n                const one = resolveOneOfFuzzy(core, schema.items, value);\n                if (one) {\n                    data[i] = core.getTemplate(one, value);\n                } else {\n                    data[i] = value;\n                }\n            }\n        } else if (schema.items.type) {\n            for (let i = 0; i < schema.minItems; i += 1) {\n                data[i] = core.getTemplate(schema.items, data[i] == null ? template[i] : data[i]);\n            }\n        } else if (Array.isArray(schema.items)) {\n            for (let i = 0, l = Math.min(schema.minItems, schema.items.length); i < l; i += 1) {\n                data[i] = core.getTemplate(schema.items[i], data[i] == null ? template[i] : data[i]);\n            }\n        }\n\n        return data;\n    }\n};\n\n\nfunction getDefault(schema, templateValue, initValue) {\n    if (templateValue != null) {\n        return templateValue;\n    } else if (schema.default === undefined && Array.isArray(schema.enum)) {\n        return schema.enum[0];\n    } else if (schema.default === undefined) {\n        return initValue;\n    }\n    return schema.default;\n}\n\n\nmodule.exports = getTemplate;\n","const toString = Object.prototype.toString;\n\nmodule.exports = function getTypeOf(value) {\n    // eslint-disable-next-line newline-per-chained-call\n    return toString.call(value).match(/\\s([^\\]]+)\\]/).pop().toLowerCase();\n};\n","/**\n * Test if the data is valid according to the given schema\n *\n * @param  {CoreInterface} core - validator\n * @param  {Schema} schema      - json schema\n * @param  {Mixed} value        - value to validate\n * @param  {String} [pointer]   - json pointer pointing to value\n * @return {Boolean} if schema does match given value\n */\nmodule.exports = function isValid(core, schema, value, pointer = \"#\") {\n    return core.validate(schema, value, pointer).length === 0;\n};\n","const getTypeOf = require(\"./getTypeOf\");\nconst gp = require(\"gson-pointer\");\n\n\nfunction iterate(schema, callback, pointer, property) {\n    const target = schema[property];\n    if (schema == null || schema[property] == null) {\n        return;\n    }\n\n    const type = getTypeOf(target);\n    if (type !== \"array\" && type !== \"object\") {\n        return;\n    }\n\n    const targetPointer = `${pointer}/properties`;\n    if (type === \"array\") {\n        target.forEach((ema, index) => iterateSchema(ema, callback, `${targetPointer}/${index}`));\n        return;\n    }\n\n    Object.keys(target).forEach((prop) => iterateSchema(target[prop], callback, `${targetPointer}/${prop}`));\n}\n\n\n/**\n * Iterate over each property and item of a schema.\n *\n * @param  {Object}   schema    - schema to iterate\n * @param  {Function} callback  - callback executed with (schema)\n * @param  {String} pointer     - current pointer of schema\n */\nfunction iterateSchema(schema, callback, pointer = \"#\") {\n    callback(schema, pointer);\n\n    // @todo resolve $ref and definitions\n    iterate(schema, callback, pointer, \"definitions\");\n    iterate(schema, callback, pointer, \"oneOf\");\n    iterate(schema, callback, pointer, \"anyOf\");\n    iterate(schema, callback, pointer, \"allOf\");\n    iterate(schema, callback, pointer, \"properties\");\n\n    if (schema.additionalProperties) {\n        iterateSchema(schema.additionalProperties, callback, `${pointer}/additionalProperties`);\n    }\n\n    if (schema.items) {\n        const type = getTypeOf(schema.items);\n\n        if (type === \"array\") {\n            iterate(schema, callback, pointer, \"items\");\n        } else if (type === \"object\" && Array.isArray(schema.items.oneOf)) {\n            iterate(schema.items, callback, `${pointer}/items`, \"oneOf\");\n        } else if (type === \"object\") {\n            iterateSchema(schema.items, callback, gp.join(pointer, \"items\"));\n        }\n    }\n\n    if (schema.dependencies && getTypeOf(schema.dependencies) === \"object\") {\n        Object.keys(schema.dependencies).forEach((property) => {\n            if (getTypeOf(schema.dependencies[property]) === \"object\") {\n                iterateSchema(schema.dependencies[property], callback, `${pointer}/dependencies/${property}`);\n            }\n        });\n    }\n}\n\nmodule.exports = iterateSchema;\n","const iterateSchema = require(\"./iterateSchema\");\nconst remotes = require(\"../remotes\");\nconst getTypeOf = require(\"./getTypeOf\");\n\nconst isAbsoluteUrl = /^(https?|file):\\/\\//;\n\n\nfunction getAbsoluteRef($ref, currentLocation = \"#\") {\n    const pointer = getPointer($ref);\n    const url = $ref.replace(/#.*$/, \"\");\n    if (url === \"\" && $ref[0] === \"#\" && isAbsoluteUrl.test(currentLocation)) {\n        return `${currentLocation}${$ref}`;\n    }\n    if (!url) {\n        return $ref;\n    }\n    if (isAbsoluteUrl.test(url)) {\n        return `${url}${pointer}`;\n    }\n    if (isAbsoluteUrl.test(currentLocation)) {\n        return `${currentLocation.replace(/[^/]*$/, \"\")}${url}${pointer}`;\n    }\n    return $ref;\n}\n\nfunction getPointer($ref) {\n    return $ref.includes(\"#\") ? decodeURIComponent(`#${$ref.replace(/^.*#/, \"\")}`) : \"\";\n}\n\nfunction joinUrl(url, base = \"\") {\n    if (url == null) {\n        return base;\n    }\n    if (isAbsoluteUrl.test(url)) {\n        return url;\n    }\n    return `${base.replace(/\\/[^/]*$/, \"\")}/${url.replace(/(^\\/|\\/$)/, \"\")}/`;\n}\n\n\n/**\n * Experimental precompilation of an input json-schema. It resolves scopes and remote relative $ref pointers, to prepare\n * for remote $ref resolution without requiring changes within api\n *\n * @param  {Core} core\n * @param  {Object} rootSchema\n * @return {Object} compiled copy of schema\n */\nfunction precompileSchema(core, rootSchema) {\n    if (rootSchema.__compiled) {\n        return rootSchema;\n    }\n    rootSchema = JSON.parse(JSON.stringify(rootSchema));\n    // a list of baseUrls to be retrieved from the current path. This prevents mixing up current baseUrls\n    const baseUrls = {};\n\n    iterateSchema(rootSchema, (schema, pointer) => {\n        if (getTypeOf(schema) !== \"object\") {\n            throw new Error(`Invalid json-schema at ${pointer}: ${JSON.stringify(schema, null, 2)}`);\n        }\n\n        // json-schema pointers may not exactly match the parent (properties the target property/end of pointer), thus\n        // we have to check both values, e.g. for #/properties/list (parent) and #/items/items (previous)\n        const previousPointer = pointer.replace(/\\/[^/]+$/, \"\");\n        const parentPointer = pointer.replace(/\\/[^/]+\\/[^/]+$/, \"\");\n        const scope = baseUrls[previousPointer] || baseUrls[parentPointer];\n\n        const thisScope = joinUrl(schema.id, scope);\n        if (schema.id) {\n            schema.id = thisScope;\n        } else {\n            Object.defineProperty(schema, \"id\", { enumerable: false, value: thisScope });\n        }\n\n        if (scope !== schema.id) {\n            remotes[schema.id] = schema;\n        }\n\n        if (schema.$ref) {\n            schema.$ref = getAbsoluteRef(schema.$ref, schema.id);\n        }\n\n        baseUrls[pointer] = schema.id;\n        Object.defineProperty(schema, \"__compiled\", { enumerable: false, value: true });\n    });\n\n    return rootSchema;\n}\n\n\nmodule.exports = precompileSchema;\n","const filter = require(\"./utils/filter\");\nconst flattenArray = require(\"./utils/flattenArray\");\nconst getTypeOf = require(\"./getTypeOf\");\n\n\n/**\n * Returns a ranking for the data and given schema\n *\n * @param  {CoreInterface} core\n * @param  {Object} one     - json schema type: object\n * @param  {Object} data\n * @param  {String} pointer\n * @return {Number} ranking value (higher is better)\n */\nfunction fuzzyObjectValue(core, one, data, pointer) {\n    if (data == null || one.properties == null) {\n        return -1;\n    }\n\n    let value = 0;\n    const keys = Object.keys(one.properties);\n    for (var i = 0; i < keys.length; i += 1) {\n        const key = keys[i];\n        if (data[key] != null && core.isValid(one.properties[key], data[key], pointer)) {\n            value += 1;\n        }\n    }\n\n    return value;\n}\n\n/**\n * Selects and returns a oneOf schema for the given data\n *\n * @param  {CoreInterface} core - validator\n * @param  {Object} schema      - current json schema containing property oneOf\n * @param  {Mixed} data\n * @param  {String} pointer     - json pointer to data\n * @return {Object|Error} oneOf schema or an error\n */\nmodule.exports = function resolveOneOf(core, schema, data, pointer) {\n\n    // !keyword: oneOfProperty\n    // an additional `oneOfProperty` on the schema will exactly determine the oneOf value (if set in data)\n\n    // @fixme\n    // abort if no data is given an oneOfProperty is set (used by getChildSchemaSelection)\n    // this case (data != null) should not be necessary\n    if (data != null && schema.oneOfProperty) {\n\n        const errors = [];\n        const oneOfProperty = schema.oneOfProperty;\n        const oneOfValue = data[schema.oneOfProperty];\n\n        if (oneOfValue === undefined) {\n            return core.errors.missingOneOfPropertyError({ property: oneOfProperty, pointer });\n        }\n\n        for (let i = 0; i < schema.oneOf.length; i += 1) {\n            const one = core.resolveRef(schema.oneOf[i]);\n            const oneOfPropertySchema = core.step(oneOfProperty, one, data, pointer);\n\n            if (oneOfPropertySchema && oneOfPropertySchema.type === \"error\") {\n                return oneOfPropertySchema;\n            }\n\n            let result = flattenArray(core.validate(oneOfPropertySchema, oneOfValue, pointer));\n            result = result.filter(filter.errorOrPromise);\n\n            if (result.length > 0) {\n                errors.push(...result);\n            } else {\n                return schema.oneOf[i];\n            }\n        }\n\n        return core.errors.oneOfPropertyError({ property: oneOfProperty, value: oneOfValue, pointer, errors });\n    }\n\n    // keyword: oneOf\n    const matches = [];\n    for (let i = 0; i < schema.oneOf.length; i += 1) {\n        const one = core.resolveRef(schema.oneOf[i]);\n        if (core.isValid(one, data, pointer)) {\n            matches.push(one);\n        }\n    }\n\n    if (matches.length === 1) {\n        return matches[0];\n    }\n\n    // fuzzy match oneOf\n    if (getTypeOf(data) === \"object\") {\n        let schemaOfItem;\n        let fuzzyGreatest = 0;\n\n        for (let i = 0; i < schema.oneOf.length; i += 1) {\n            const one = core.resolveRef(schema.oneOf[i]);\n            const fuzzyValue = fuzzyObjectValue(core, one, data);\n\n            if (fuzzyGreatest < fuzzyValue) {\n                fuzzyGreatest = fuzzyValue;\n                schemaOfItem = schema.oneOf[i];\n            }\n        }\n\n        if (schemaOfItem === undefined) {\n            return core.errors.oneOfError({ value: JSON.stringify(data), pointer, oneOf: schema.oneOf });\n        }\n\n        return schemaOfItem;\n    }\n\n    if (matches.length > 1) {\n        return core.errors.multipleOneOfError({ matches, data, pointer });\n    }\n\n    return core.errors.oneOfError({ value: JSON.stringify(data), pointer, oneOf: schema.oneOf });\n};\n","const filter = require(\"./utils/filter\");\nconst flattenArray = require(\"./utils/flattenArray\");\n\n\n/**\n * Selects and returns a oneOf schema for the given data\n *\n * @param  {CoreInterface} core - validator\n * @param  {Object} schema      - current json schema containing property oneOf\n * @param  {Mixed} data\n * @param  {String} pointer     - json pointer to data\n * @return {Object|Error} oneOf schema or an error\n */\nmodule.exports = function resolveOneOf(core, schema, data, pointer) {\n    const matches = [];\n    const errors = [];\n    for (let i = 0; i < schema.oneOf.length; i += 1) {\n        const one = core.resolveRef(schema.oneOf[i]);\n\n        let result = flattenArray(core.validate(one, data, pointer));\n        result = result.filter(filter.errorOrPromise);\n\n        if (result.length > 0) {\n            errors.push(...result);\n        } else {\n            matches.push(one);\n        }\n    }\n\n    if (matches.length === 1) {\n        return matches[0];\n    }\n    if (matches.length > 1) {\n        return core.errors.multipleOneOfError({ value: data, pointer, matches });\n    }\n\n    return core.errors.oneOfError({ value: JSON.stringify(data), pointer, oneOf: schema.oneOf, errors });\n};\n","const gp = require(\"gson-pointer\");\nconst getTargetSchema = require(\"./utils/getTargetSchema\");\nconst ref = require(\"./utils/ref\");\n\n\nmodule.exports = function resolveRef(schema, rootSchema) {\n    if (schema == null) {\n        return {};\n    }\n\n    if (schema.$ref == null) {\n        return schema;\n    }\n\n    const target = ref.getPointer(schema.$ref);\n    const targetSchema = getTargetSchema(schema.$ref, rootSchema, rootSchema);\n    let reference = gp.get(targetSchema, target);\n    reference = resolveRef(reference, targetSchema); // resolve ref until completely resolved\n\n    if (reference == null) {\n        console.log(`Error: Failed resolving reference ${schema.$ref}.`);\n    }\n\n    const result = Object.assign({}, reference);\n    return result;\n};\n","const gp = require(\"gson-pointer\");\nconst getTargetSchema = require(\"./utils/getTargetSchema\");\nconst ref = require(\"./utils/ref\");\n\n\nmodule.exports = function resolveRef(schema, rootSchema) {\n    if (schema == null) {\n        return {};\n    }\n\n    if (rootSchema == null) {\n        throw new Error(\"Missing rootschema for\", schema);\n    }\n\n    if (schema.$ref == null) {\n        return schema;\n    }\n\n    const target = ref.getPointer(schema.$ref);\n    const targetSchema = getTargetSchema(schema.$ref, rootSchema, rootSchema);\n    let reference = gp.get(targetSchema, target);\n    reference = resolveRef(reference, targetSchema); // resolve ref until completely resolved\n\n    // @todo use this for forms. in draft04 any value in schema MUST be ignored\n    const result = Object.assign({}, reference, schema);\n    delete result.$ref;\n\n    return result;\n};\n","const getTypeOf = require(\"./getTypeOf\");\nconst createSchemaOf = require(\"./createSchemaOf\");\nconst errors = require(\"./validation/errors\");\n\n\n/**\n * Returns the json-schema of the given object property or array item.\n * e.g. it steps by one key into the data\n *\n *  This helper determines the location of the property within the schema (additional properties, oneOf, ...) and\n *  returns the correct schema.\n *\n * @param  {CoreInterface} core     - validator\n * @param  {String|Number} key      - property-name or array-index\n * @param  {Object} schema          - json schema of current data\n * @param  {Object|Array} data      - parent of key\n * @param  {String} pointer\n * @return {Object|Error} Schema or Error if failed resolving key\n */\nfunction step(core, key, schema, data, pointer) {\n    const expectedType = schema.type || getTypeOf(data);\n\n    if (expectedType === \"object\" && Array.isArray(schema.oneOf)) {\n        // schema of current object\n        schema = core.resolveOneOf(schema, data, pointer);\n        if (schema && schema.type === \"error\") {\n            return schema;\n        }\n\n        // step into object\n        return step(core, key, schema, data, pointer);\n        // return errors.oneOfPropertyError({ property: key, value: JSON.stringify(data), pointer });\n    }\n\n    if (expectedType === \"object\" && !Array.isArray(schema.oneOf)) {\n        let targetSchema;\n        // step into object\n        if (schema.properties && schema.properties[key] !== undefined) {\n            targetSchema = core.resolveRef(schema.properties[key]);\n        }\n        // return any error\n        if (targetSchema && targetSchema.type === \"error\") {\n            return targetSchema;\n        }\n        // check if there is a oneOf selection, which must be resolved\n        if (targetSchema && targetSchema.oneOf && Array.isArray(targetSchema.oneOf)) {\n            // @special case: this is a mix of a schema and optional definitions\n            // we resolve the schema here and add the original schema to `oneOfSchema`\n            let resolvedSchema = core.resolveOneOf(targetSchema, data[key], `${pointer}/${key}`);\n            resolvedSchema = JSON.parse(JSON.stringify(resolvedSchema));\n            resolvedSchema.variableSchema = true;\n            resolvedSchema.oneOfSchema = targetSchema;\n            return resolvedSchema;\n        }\n\n        // resolved schema or error\n        if (targetSchema) {\n            return targetSchema;\n        }\n\n        // find matching property key\n        if (getTypeOf(schema.patternProperties) === \"object\") {\n            let regex;\n            const patterns = Object.keys(schema.patternProperties);\n            for (let i = 0, l = patterns.length; i < l; i += 1) {\n                regex = new RegExp(patterns[i]);\n                if (regex.test(key)) {\n                    return schema.patternProperties[patterns[i]];\n                }\n            }\n        }\n\n        if (getTypeOf(schema.additionalProperties) === \"object\") {\n            return schema.additionalProperties;\n\n        } else if (schema.additionalProperties === true) {\n            return createSchemaOf(data);\n        }\n\n        return errors.unknownPropertyError({ property: key, value: data, pointer });\n    }\n\n    if (expectedType === \"array\") {\n        // oneOf\n        if (schema.items && Array.isArray(schema.items.oneOf)) {\n            return core.resolveOneOf(schema.items, data[key], pointer) || false;\n        }\n        // schema\n        if (schema.items && getTypeOf(schema.items) === \"object\") {\n            return core.resolveRef(schema.items);\n        }\n        // list of items\n        if (schema.items && Array.isArray(schema.items)) {\n\n            if (schema.items[key]) {\n                return core.resolveRef(schema.items[key]);\n            }\n\n            if (schema.additionalItems === false) {\n                return errors.additionalItemsError({ key, value: data[key], pointer });\n            }\n\n            if (schema.additionalItems === true || schema.additionalItems === undefined) {\n                return createSchemaOf(data[key]);\n            }\n\n            if (getTypeOf(schema.additionalItems) === \"object\") {\n                return schema.additionalItems;\n            }\n\n            throw new Error(`Invalid schema ${JSON.stringify(schema, null, 4)} for ${JSON.stringify(data, null, 4)}`);\n        }\n        if (schema.additionalItems !== false && data[key]) {\n            // @todo reevaluate: incomplete schema is created here\n            // @todo support additionalItems: {schema}\n            return createSchemaOf(data[key]);\n        }\n\n        return new Error(`Invalid array schema for ${key} at ${pointer}`);\n    }\n\n    // Here we might have a oneof selection\n    // console.log(\"OneOf selection without type object?\");\n    return new Error(`Unsupported schema type ${schema.type} for key ${key}`);\n}\n\n\nmodule.exports = step;\n","const strings = require(\"../config/strings\");\nconst render = require(\"./render\");\n\n/**\n * Renders the given string as defined in __@see config/strings.js__\n * @param  {String} keyword\n * @param  {Object} data        - template data\n * @param  {String} fallback    - fallback template\n * @return {String} resultugn string\n */\nmodule.exports = function __(keyword, data, fallback = keyword) {\n    const template = strings[keyword] || fallback;\n    return render(template, data);\n};\n","const __ = require(\"./__\");\n\nfunction dashCase(str) {\n    return str.replace(/([a-z])([A-Z])/g, \"$1-$2\").toLowerCase();\n}\n\n\n/**\n * Creates a custom Error-Constructor which instances may be identified by `customError instanceof Error`. Its messages\n * are defined by strings-object __@see config/strings.js__sa\n * @param  {String} name    - id of error (camelcased)\n * @return {Function} Error-Contructor\n */\nmodule.exports = function createCustomError(name) {\n    return function (data) {\n        return {\n            type: \"error\",\n            name,\n            code: dashCase(name),\n            message: __(name, data),\n            data\n        };\n    };\n\n    // function CustomError(data) {\n    //     const message = __(name, data);\n    //     const error = Error.call(this, message);\n    //     this.name = name;\n    //     this.code = dashCase(name);\n    //     this.stack = error.stack;\n    //     this.message = message;\n    //     this.data = data;\n    // }\n    // CustomError.prototype = Object.create(Error.prototype);\n    // CustomError.prototype.name = name;\n    // return CustomError;\n};\n","function isPromise(obj) {\n    return obj instanceof Promise;\n}\n\nfunction isError(obj) {\n    return obj && obj.type === \"error\";\n}\n\nmodule.exports = {\n    isError,\n    isPromise,\n    errorOrPromise(error) {\n        return isError(error) || isPromise(error);\n    },\n    errorsOnly(error) {\n        return isError(error);\n    }\n};\n","function flattenArray(list, result = []) {\n    for (let i = 0; i < list.length; i += 1) {\n        if (Array.isArray(list[i])) {\n            flattenArray(list[i], result);\n        } else {\n            result.push(list[i]);\n        }\n    }\n    return result;\n}\n\nmodule.exports = flattenArray;\n","const remotes = require(\"../../remotes\");\nconst ref = require(\"./ref\");\n\n// resolves remote references and returns either the input schema or the referenced remote schema\nmodule.exports = function getTargetSchema($ref, schema) {\n    const url = ref.getUrl($ref, schema.id);\n\n    if (remotes[url]) {\n        return remotes[url];\n    } else if (url) {\n        throw new Error(`Unknown remote schema ${url}. It should have been added to 'remotes'-module`);\n    }\n    return schema;\n};\n","/* eslint no-bitwise: 0 */\n\n/**\n * taken from punycode@2.1.0\n *\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n * @see `punycode.ucs2.encode`\n * @see <https://mathiasbynens.be/notes/javascript-encoding>\n * @memberOf punycode.ucs2\n * @name decode\n * @param {String} string The Unicode input string (UCS-2).\n * @returns {Array} The new array of code points.\n */\nfunction ucs2decode(string) {\n    const output = [];\n    let counter = 0;\n    const length = string.length;\n    while (counter < length) {\n        const value = string.charCodeAt(counter++);\n        if (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n            // It's a high surrogate, and there is a next character.\n            const extra = string.charCodeAt(counter++);\n            // eslint-disable-next-line eqeqeq\n            if ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n                output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n            } else {\n                // It's an unmatched surrogate; only append this code unit, in case the\n                // next code unit is the high surrogate of a surrogate pair.\n                output.push(value);\n                counter--;\n            }\n        } else {\n            output.push(value);\n        }\n    }\n    return output;\n}\n\nmodule.exports = ucs2decode;\n","function getHostname(url) {\n    if (url == null || url.match == null) {\n        return false;\n    }\n    const base = url.match(/(^(https?|file):\\/\\/[^\\/]+)/);\n    if (base && base.length) {\n        return base[1];\n    }\n    return false;\n}\n\n// strips the url of the given reference\nfunction getPointer(ref) {\n    if (ref.indexOf(\"#\") > 0) {\n        return ref.split(\"#\").pop();\n    }\n\n    if (/^(http|https|file):\\/\\//.test(ref)) {\n        return \"\";\n    }\n\n    return ref;\n}\n\n// strips the pointer from the json-schema-pointer\nfunction getUrl(ref, resourcePath = \"\") {\n    if (ref.indexOf(\"#\") > 0) {\n        const url = ref.split(\"#\").shift();\n        const hostname = getHostname(resourcePath);\n\n        if (/^(http|https|file):\\/\\//.test(url) === false && hostname !== false) {\n            return `${hostname}/${url.replace(/^\\//, \"\")}`;\n        }\n\n        return url;\n    }\n\n    if (/^(http|https|file):\\/\\//.test(ref)) {\n        return ref;\n    }\n\n    return false;\n}\n\nmodule.exports = {\n    getPointer,\n    getUrl\n};\n","/**\n * Renders data into a string by {{variables}}.\n * Given a template string, removes all {{property}} substrings and replaces them with the property in the given data\n *\n * @param {String} template     - template string containing variables in handelbars/mustache style\n * @param {Object} data         - flat object containing properties matching variables\n * @return {String} rendered string\n */\nmodule.exports = function render(template, data = {}) {\n    return template.replace(/\\{\\{\\w+\\}\\}/g, (match) => data[match.replace(/[{}]/g, \"\")]);\n};\n","const getTypeOf = require(\"./getTypeOf\");\nconst filter = require(\"./utils/filter\");\nconst flattenArray = require(\"./utils/flattenArray\");\n\n\nfunction getJsonSchemaType(value, expectedType) {\n    let jsType = getTypeOf(value);\n\n    if (\n        jsType === \"number\" && (expectedType === \"integer\" ||\n        (Array.isArray(expectedType) && expectedType.includes(\"integer\")))\n    ) {\n        jsType = Number.isInteger(value) ? \"integer\" : \"number\";\n    }\n    return jsType;\n}\n\n\n/**\n * Validate data by a json schema\n *\n * @param  {CoreInterface} core - validator\n * @param  {Schema} schema      - json schema\n * @param  {Mixed} value        - value to validate\n * @param  {String} [pointer]   - json pointer pointing to value (used for error-messages only)\n * @return {Array} list of errors or empty\n */\nmodule.exports = function validate(core, schema, value, pointer = \"#\") {\n    if (schema.type === \"error\") {\n        return [schema];\n    }\n\n    schema = core.resolveRef(schema);\n\n    const receivedType = getJsonSchemaType(value, schema.type);\n    const expectedType = schema.type || receivedType;\n\n    if (receivedType !== expectedType && (!Array.isArray(expectedType) || !expectedType.includes(receivedType))) {\n        return [core.errors.typeError({ received: receivedType, expected: expectedType, value, pointer })];\n    }\n\n    if (core.validateType[receivedType] == null) {\n        return [core.errors.invalidTypeError({ receivedType, pointer })];\n    }\n\n    const errors = flattenArray(core.validateType[receivedType](core, schema, value, pointer));\n    // also promises may be passed along (validateAsync)\n    return errors.filter(filter.errorOrPromise);\n};\n","const filter = require(\"./utils/filter\");\nconst flattenArray = require(\"./utils/flattenArray\");\n\n\nfunction createErrorNotification(onError) {\n    return function notifyError(error) {\n        if (Array.isArray(error)) {\n            error = flattenArray(error);\n            error.forEach(notifyError);\n            return error;\n        }\n        if (filter.isError(error)) {\n            onError(error);\n        }\n        return error;\n    };\n}\n\n\n/**\n * Validate data by a json schema\n *\n * @param  {CoreInterface} core     - validator\n * @param  {Schema} schema          - json schema\n * @param  {Mixed} value            - value to validate\n * @param  {String} [pointer]       - json pointer pointing to value\n * @param  {Function} [onError]     - will be called for each error as soon as it is resolved\n * @return {Array} list of errors or empty\n */\nmodule.exports = function validateAsync(core, schema, value, pointer = \"#\", onError) {\n    let errors = core.validate(schema, value, pointer);\n\n    if (onError) {\n        errors = flattenArray(errors);\n        const notifyError = createErrorNotification(onError);\n        for (let i = 0; i < errors.length; i += 1) {\n            if (errors[i] instanceof Promise) {\n                errors[i].then(notifyError);\n            } else if (filter.isError(errors[i])) {\n                onError(errors[i]);\n            }\n        }\n    }\n\n    return Promise\n        .all(errors)\n        .then(flattenArray)\n        .then((resolvedErrors) => resolvedErrors.filter(filter.errorsOnly))\n        .catch((e) => {\n            console.log(\"Failed resolving promises\", e.message);\n            console.log(e.stack);\n            throw e;\n        });\n};\n","/* eslint no-invalid-this: 0 */\nconst createCustomError = require(\"../utils/createCustomError\");\n\n\nconst errors = {\n    additionalItemsError: createCustomError(\"AdditionalItemsError\"),\n    additionalPropertiesError: createCustomError(\"AdditionalPropertiesError\"),\n    anyOfError: createCustomError(\"AnyOfError\"),\n    enumError: createCustomError(\"EnumError\"),\n    formatUrlError: createCustomError(\"FormatUrlError\"),\n    formatUriError: createCustomError(\"FormatUriError\"),\n    formatDateTimeError: createCustomError(\"FormatDateTimeError\"),\n    formatEmailError: createCustomError(\"FormatEmailError\"),\n    formatHostnameError: createCustomError(\"FormatHostnameError\"),\n    formatIPV4Error: createCustomError(\"FormatIPV4Error\"),\n    formatIPV6Error: createCustomError(\"FormatIPV6Error\"),\n    formatRegExError: createCustomError(\"FormatRegExError\"),\n    invalidSchemaError: createCustomError(\"InvalidSchemaError\"),\n    invalidTypeError: createCustomError(\"InvalidTypeError\"),\n    maximumError: createCustomError(\"MaximumError\"),\n    maxItemsError: createCustomError(\"MaxItemsError\"),\n    maxLengthError: createCustomError(\"MaxLengthError\"),\n    maxPropertiesError: createCustomError(\"MaxPropertiesError\"),\n    minimumError: createCustomError(\"MinimumError\"),\n    minItemsError: createCustomError(\"MinItemsError\"),\n    minLengthError: createCustomError(\"MinLengthError\"),\n    minPropertiesError: createCustomError(\"MinPropertiesError\"),\n    missingDependencyError: createCustomError(\"MissingDependencyError\"),\n    missingOneOfPropertyError: createCustomError(\"MissingOneOfPropertyError\"),\n    multipleOfError: createCustomError(\"MultipleOfError\"),\n    multipleOneOfError: createCustomError(\"MultipleOneOfError\"),\n    noAdditionalPropertiesError: createCustomError(\"NoAdditionalPropertiesError\"),\n    notError: createCustomError(\"NotError\"),\n    oneOfError: createCustomError(\"OneOfError\"),\n    oneOfPropertyError: createCustomError(\"OneOfPropertyError\"),\n    patternError: createCustomError(\"PatternError\"),\n    patternPropertiesError: createCustomError(\"PatternPropertiesError\"),\n    requiredPropertyError: createCustomError(\"RequiredPropertyError\"),\n    typeError: createCustomError(\"TypeError\"),\n    undefinedValueError: createCustomError(\"UndefinedValueError\"),\n    uniqueItemsError: createCustomError(\"UniqueItemsError\"),\n    unknownPropertyError: createCustomError(\"UnknownPropertyError\"),\n    valueNotEmptyError: createCustomError(\"ValueNotEmptyError\")\n};\n\n\nmodule.exports = errors;\n","/* eslint-disable max-len */\nconst errors = require(\"./errors\");\nconst validUrl = require(\"valid-url\");\n\n// https://gist.github.com/marcelotmelo/b67f58a08bee6c2468f8\nconst isValidDateTime = new RegExp(\"^([0-9]+)-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])[Tt]([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?(([Zz])|([\\+|\\-]([01][0-9]|2[0-3]):[0-5][0-9]))$\");\n// https://stackoverflow.com/questions/23483855/javascript-regex-to-validate-ipv4-and-ipv6-address-no-hostnames\nconst isValidIPV4 = /^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$|^\\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?\\s*$/;\nconst isValidIPV6 = /^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\\-]*[A-Za-z0-9])$|^\\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?\\s*$/;\n\n\n// Default JSON-Schema formats: date-time, email, hostname, ipv4, ipv6, uri, uriref\nconst FormatValidation = {\n\n    \"date-time\": (core, schema, value, pointer) => {\n        if (value === \"\" || isValidDateTime.test(value)) {\n            return undefined;\n        }\n        return errors.formatDateTimeError({ value, pointer });\n    },\n\n    email: (core, schema, value, pointer) => {\n        if (value === \"\" || value.includes(\"@\")) {\n            return undefined;\n        }\n        return errors.formatEmailError({ value, pointer });\n    },\n\n    hostname: (core, schema, value, pointer) => {\n        if (value === \"\" || /\\./.test(value)) {\n            return undefined;\n        }\n        return errors.formatHostnameError({ value, pointer });\n    },\n\n    ipv4: (core, schema, value, pointer) => {\n        if (value === \"\" || isValidIPV4.test(value)) {\n            return undefined;\n        }\n        return errors.formatIPV4Error({ value, pointer });\n    },\n\n    ipv6: (core, schema, value, pointer) => {\n        if (value === \"\" || isValidIPV6.test(value)) {\n            return undefined;\n        }\n        return errors.formatIPV6Error({ value, pointer });\n    },\n\n    regex: (core, schema, value, pointer) => {\n        if (typeof value === \"string\" && /\\\\Z$/.test(value) === false) {\n            return undefined;\n        }\n        return errors.formatRegExError({ value, pointer });\n    },\n    uri: (core, schema, value, pointer) => {\n        if (value === \"\" || validUrl.isUri(value)) {\n            return undefined;\n        }\n        return errors.formatUriError({ value, pointer });\n    },\n\n    url: (core, schema, value, pointer) => {\n        if (value === \"\" || validUrl.isWebUri(value)) {\n            return undefined;\n        }\n        return errors.formatUrlError({ value, pointer });\n    }\n};\n\n\nmodule.exports = FormatValidation;\n","const getTypeOf = require(\"../getTypeOf\");\nconst ucs2decode = require(\"../utils/punycode.ucs2decode\");\nconst settings = require(\"../config/settings\");\nconst FPP = settings.floatingPointPrecision;\n\n// list of validation keywords: http://json-schema.org/latest/json-schema-validation.html#rfc.section.5\nconst KeywordValidation = {\n\n    additionalProperties: (core, schema, value, pointer) => {\n        if (schema.additionalProperties === true || schema.additionalProperties == null) {\n            return undefined;\n        }\n\n        if (getTypeOf(schema.patternProperties) === \"object\" && schema.additionalProperties === false) {\n            // this is an arrangement with patternProperties. patternProperties validate before additionalProperties:\n            // https://spacetelescope.github.io/understanding-json-schema/reference/object.html#index-5\n            return undefined;\n        }\n\n        const errors = [];\n        let receivedProperties = Object.keys(value).filter((prop) => settings.propertyBlacklist.includes(prop) === false);\n        const expectedProperties = Object.keys(schema.properties || {});\n\n        if (getTypeOf(schema.patternProperties) === \"object\") {\n            // filter received properties by matching patternProperties\n            const patterns = Object.keys(schema.patternProperties).map((pattern) => new RegExp(pattern));\n            receivedProperties = receivedProperties.filter((prop) => {\n                for (let i = 0; i < patterns.length; i += 1) {\n                    if (patterns[i].test(prop)) {\n                        return false; // remove\n                    }\n                }\n                return true;\n            });\n        }\n\n        // adds an error for each an unexpected property\n        for (let i = 0, l = receivedProperties.length; i < l; i += 1) {\n            const property = receivedProperties[i];\n            if (expectedProperties.indexOf(property) === -1) {\n                const isObject = typeof schema.additionalProperties === \"object\";\n\n                // additionalProperties { oneOf: [] }\n                if (isObject && Array.isArray(schema.additionalProperties.oneOf)) {\n                    const result = core.resolveOneOf(schema.additionalProperties, value[property], `${pointer}/${property}`);\n                    if (result.type === \"error\") {\n                        errors.push(core.errors.additionalPropertiesError({\n                            schema: schema.additionalProperties,\n                            property: receivedProperties[i],\n                            properties: expectedProperties,\n                            pointer,\n                            // pass all validation errors\n                            errors: result.data.errors\n                        }));\n\n                    } else {\n                        errors.push(core.validate(result, value[property], pointer));\n                    }\n\n                // additionalProperties {}\n                } else if (isObject) {\n                    if (core.validate(schema.additionalProperties, value[property], pointer).length !== 0) {\n                        errors.push(core.errors.additionalPropertiesError({\n                            schema: schema.additionalProperties,\n                            property: receivedProperties[i],\n                            properties: expectedProperties,\n                            pointer\n                        }));\n                    }\n\n                } else {\n                    errors.push(core.errors.noAdditionalPropertiesError(\n                        { property: receivedProperties[i], properties: expectedProperties, pointer }\n                    ));\n                }\n            }\n        }\n\n        return errors;\n    },\n\n    allOf: (core, schema, value, pointer) => {\n        if (Array.isArray(schema.allOf) === false) {\n            return undefined;\n        }\n\n        const errors = [];\n        schema.allOf.forEach((subSchema) => {\n            errors.push(core.validate(subSchema, value, pointer));\n        });\n\n        return errors;\n    },\n\n    anyOf: (core, schema, value, pointer) => {\n        if (Array.isArray(schema.anyOf) === false) {\n            return undefined;\n        }\n\n        for (let i = 0; i < schema.anyOf.length; i += 1) {\n            if (core.isValid(schema.anyOf[i], value)) {\n                return undefined;\n            }\n        }\n\n        return core.errors.anyOfError({ anyOf: schema.anyOf, value, pointer });\n    },\n\n    dependencies: (core, schema, value, pointer) => {\n        if (getTypeOf(schema.dependencies) !== \"object\") {\n            return undefined;\n        }\n\n        const errors = [];\n        Object.keys(value)\n            .forEach((property) => {\n                if (schema.dependencies[property] === undefined) {\n                    return;\n                }\n\n                let dependencyErrors;\n                const type = getTypeOf(schema.dependencies[property]);\n                if (type === \"array\") {\n                    dependencyErrors = schema.dependencies[property]\n                        .filter((dependency) => value[dependency] === undefined)\n                        .map((missingProperty) => core.errors.missingDependencyError({ missingProperty, pointer }));\n                } else if (type === \"object\") {\n                    dependencyErrors = core.validate(schema.dependencies[property], value);\n\n                } else {\n                    throw new Error(`Invalid dependency definition for ${pointer}/${property}. Must be list or schema`);\n                }\n\n                errors.push(...dependencyErrors);\n            });\n\n        return errors.length > 0 ? errors : undefined;\n    },\n\n    \"enum\": (core, schema, value, pointer) => {\n        const type = getTypeOf(value);\n        if (type === \"object\" || type === \"array\") {\n            const valueStr = JSON.stringify(value);\n            for (let i = 0; i < schema.enum.length; i += 1) {\n                if (JSON.stringify(schema.enum[i]) === valueStr) {\n                    return undefined;\n                }\n            }\n        } else if (schema.enum.includes(value)) {\n            return undefined;\n        }\n        return core.errors.enumError({ values: schema.enum, value, pointer });\n    },\n    format: (core, schema, value, pointer) => {\n        if (core.validateFormat[schema.format]) {\n            const errors = core.validateFormat[schema.format](core, schema, value, pointer);\n            return errors;\n        }\n        // fail silently if given format is not defined\n        return undefined;\n    },\n    items: (core, schema, value, pointer) => {\n        const errors = [];\n        for (var i = 0; i < value.length; i += 1) {\n            const itemData = value[i];\n            // @todo reevaluate: incomplete schema is created here\n            const itemSchema = core.step(i, schema, value, pointer);\n\n            if (itemSchema && itemSchema.type === \"error\") {\n                return [itemSchema];\n            }\n\n            const itemErrors = core.validate(itemSchema, itemData, `${pointer}/${i}`);\n            errors.push(...itemErrors);\n        }\n\n        return errors;\n    },\n    maximum: (core, schema, value, pointer) => {\n        if (isNaN(schema.maximum)) {\n            return undefined;\n        }\n        if (schema.maximum && schema.maximum < value) {\n            return core.errors.maximumError({ maximum: schema.maximum, length: value, pointer });\n        }\n        if (schema.maximum && schema.exclusiveMaximum === true && schema.maximum === value) {\n            return core.errors.maximumError({ maximum: schema.maximum, length: value, pointer });\n        }\n        return undefined;\n    },\n    maxItems: (core, schema, value, pointer) => {\n        if (isNaN(schema.maxItems)) {\n            return undefined;\n        }\n        if (schema.maxItems < value.length) {\n            return core.errors.maxItemsError({ maximum: schema.maxItems, length: value.length, pointer });\n        }\n        return undefined;\n    },\n    maxLength: (core, schema, value, pointer) => {\n        if (isNaN(schema.maxLength)) {\n            return undefined;\n        }\n        const lengthOfString = ucs2decode(value).length;\n        if (schema.maxLength < lengthOfString) {\n            return core.errors.maxLengthError({ maxLength: schema.maxLength, length: lengthOfString, pointer });\n        }\n        return undefined;\n    },\n    maxProperties: (core, schema, value, pointer) => {\n        const propertyCount = Object.keys(value).length;\n        if (isNaN(schema.maxProperties) === false && schema.maxProperties < propertyCount) {\n            return core.errors.maxPropertiesError({\n                maxProperties: schema.maxProperties,\n                length: propertyCount,\n                pointer\n            });\n        }\n        return undefined;\n    },\n    minLength: (core, schema, value, pointer) => {\n        if (isNaN(schema.minLength)) {\n            return undefined;\n        }\n        const lengthOfString = ucs2decode(value).length;\n        if (schema.minLength > lengthOfString) {\n            return core.errors.minLengthError({ minLength: schema.minLength, length: lengthOfString, pointer });\n        }\n        return undefined;\n    },\n    minimum: (core, schema, value, pointer) => {\n        if (isNaN(schema.minimum)) {\n            return undefined;\n        }\n        if (schema.minimum > value) {\n            return core.errors.minimumError({ minimum: schema.minimum, length: value, pointer });\n        }\n        if (schema.exclusiveMinimum === true && schema.minimum === value) {\n            return core.errors.minimumError({ minimum: schema.minimum, length: value, pointer });\n        }\n        return undefined;\n    },\n    minItems: (core, schema, value, pointer) => {\n        if (isNaN(schema.minItems)) {\n            return undefined;\n        }\n        if (schema.minItems > value.length) {\n            return core.errors.minItemsError({ minItems: schema.minItems, length: value.length, pointer });\n        }\n        return undefined;\n    },\n    minProperties: (core, schema, value, pointer) => {\n        if (isNaN(schema.minProperties)) {\n            return undefined;\n        }\n        const propertyCount = Object.keys(value).length;\n        if (schema.minProperties > propertyCount) {\n            return core.errors.minPropertiesError({\n                minProperties: schema.minProperties,\n                length: propertyCount, pointer\n            });\n        }\n        return undefined;\n    },\n    multipleOf: (core, schema, value, pointer) => {\n        if (isNaN(schema.multipleOf)) {\n            return undefined;\n        }\n        if ((value * FPP) % (schema.multipleOf * FPP) / FPP !== 0) {\n            return core.errors.multipleOfError({ multipleOf: schema.multipleOf, value, pointer });\n        }\n        return undefined;\n    },\n    not: (core, schema, value, pointer) => {\n        const errors = [];\n        if (core.validate(schema.not, value, pointer).length === 0) {\n            errors.push(core.errors.notError({ value, not: schema.not, pointer }));\n        }\n        return errors;\n    },\n    oneOf: (core, schema, value, pointer) => {\n        if (Array.isArray(schema.oneOf) === false) {\n            return undefined;\n        }\n\n        schema = core.resolveOneOf(schema, value, pointer);\n        if (schema && schema.type === \"error\") {\n            return schema;\n        }\n\n        return undefined;\n    },\n    pattern: (core, schema, value, pointer) => {\n        if ((new RegExp(schema.pattern)).test(value) === false) {\n            return core.errors.patternError({\n                pattern: schema.pattern,\n                description: schema.patternExample || schema.pattern,\n                received: value, pointer\n            });\n        }\n        return undefined;\n    },\n    patternProperties: (core, schema, value, pointer) => {\n        const properties = schema.properties || {};\n        const pp = schema.patternProperties;\n        if (getTypeOf(pp) !== \"object\") {\n            return undefined;\n        }\n\n        const errors = [];\n        const keys = Object.keys(value);\n        const patterns = Object.keys(pp).map((expr) => ({\n            regex: new RegExp(expr),\n            patternSchema: pp[expr]\n        }));\n\n        keys.forEach((key) => {\n            let patternFound = false;\n\n            for (let i = 0, l = patterns.length; i < l; i += 1) {\n                if (patterns[i].regex.test(key)) {\n                    patternFound = true;\n                    const valErrors = core.validate(patterns[i].patternSchema, value[key], `${pointer}/${key}`);\n                    if (valErrors && valErrors.length > 0) {\n                        errors.push(...valErrors);\n                    }\n                }\n            }\n\n            if (properties[key]) {\n                return;\n            }\n\n            if (patternFound === false && schema.additionalProperties === false) {\n                // this is an arrangement with additionalProperties\n                errors.push(core.errors.patternPropertiesError({\n                    key, pointer, patterns: Object.keys(pp).join(\",\")\n                }));\n            }\n        });\n\n        return errors;\n    },\n    properties: (core, schema, value, pointer) => {\n        const errors = [];\n        const keys = Object.keys(schema.properties || {});\n        for (var i = 0; i < keys.length; i += 1) {\n            const key = keys[i];\n            if (value[key] !== undefined) {\n                const itemSchema = core.step(key, schema, value, pointer);\n                const keyErrors = core.validate(itemSchema, value[key], `${pointer}/${key}`);\n                errors.push(...keyErrors);\n            }\n        }\n        return errors;\n    },\n    // @todo move to separate file: this is custom keyword validation for JsonEditor.properties keyword\n    propertiesRequired: (core, schema, value, pointer) => {\n        const errors = [];\n        const keys = Object.keys(schema.properties || {});\n        for (var i = 0; i < keys.length; i += 1) {\n            const key = keys[i];\n            if (value[key] === undefined) {\n                errors.push(core.errors.requiredPropertyError({ key, pointer }));\n            } else {\n                const itemSchema = core.step(key, schema, value, pointer);\n                const keyErrors = core.validate(itemSchema, value[key], `${pointer}/${key}`);\n                errors.push(...keyErrors);\n            }\n        }\n        return errors;\n    },\n    required: (core, schema, value, pointer) => {\n        if (Array.isArray(schema.required) === false) {\n            return undefined;\n        }\n\n        return schema.required.map((property) => {\n            if (value[property] === undefined) {\n                return core.errors.requiredPropertyError({ key: property, pointer });\n            }\n            return undefined;\n        });\n    },\n    // @todo move to separate file: this is custom keyword validation for JsonEditor.required keyword\n    requiredNotEmpty: (core, schema, value, pointer) => {\n        if (Array.isArray(schema.required) === false) {\n            return undefined;\n        }\n\n        return schema.required.map((property) => {\n            if (value[property] == null || value[property] === \"\") {\n                return core.errors.valueNotEmptyError({ property, pointer: `${pointer}/${property}` });\n            }\n            return undefined;\n        });\n    },\n    uniqueItems: (core, schema, value, pointer) => {\n        if ((Array.isArray(value) && schema.uniqueItems) === false) {\n            return undefined;\n        }\n\n        const errors = [];\n        const map = {};\n        value.forEach((item, index) => {\n            const id = JSON.stringify(item);\n            const itemPointer = `${pointer}/${index}`;\n            if (map[id]) {\n                errors.push(core.errors.uniqueItemsError({\n                    pointer,\n                    itemPointer: map[id],\n                    duplicatePointer: itemPointer,\n                    value: id\n                }));\n            } else {\n                map[id] = itemPointer;\n            }\n        });\n\n        return errors;\n    }\n};\n\n\nmodule.exports = KeywordValidation;\n\n","/**\n * @todo: type is also a keyword, as is properties, items, etc\n *\n * An instance has one of six primitive types (http://json-schema.org/latest/json-schema-core.html#rfc.section.4.2)\n * or seven in case of ajv https://github.com/epoberezkin/ajv/blob/master/KEYWORDS.md#type\n * 1 null, 2 boolean, 3 object, 4 array, 5 number, 6 string (7 integer)\n */\nconst TypeValidation = {\n\n    array: (core, schema, value, pointer) =>\n        core.typeKeywords.array\n            .filter((key) => schema && schema[key] != null)\n            .map((key) => core.validateKeyword[key](core, schema, value, pointer)),\n\n    object: (core, schema, value, pointer) =>\n        core.typeKeywords.object\n            .filter((key) => schema && schema[key] != null)\n            .map((key) => core.validateKeyword[key](core, schema, value, pointer)),\n\n    string: (core, schema, value, pointer) =>\n        core.typeKeywords.string\n            .filter((key) => schema && schema[key] != null)\n            .map((key) => core.validateKeyword[key](core, schema, value, pointer)),\n\n    integer: (core, schema, value, pointer) =>\n        core.typeKeywords.number\n            .filter((key) => schema && schema[key] != null)\n            .map((key) => core.validateKeyword[key](core, schema, value, pointer)),\n\n    number: (core, schema, value, pointer) =>\n        core.typeKeywords.number\n            .filter((key) => schema && schema[key] != null)\n            .map((key) => core.validateKeyword[key](core, schema, value, pointer)),\n\n    \"boolean\": (core, schema, value, pointer) =>\n        core.typeKeywords.boolean\n            .filter((key) => schema && schema[key] != null)\n            .map((key) => core.validateKeyword[key](core, schema, value, pointer)),\n\n    \"null\": (core, schema, value, pointer) =>\n        core.typeKeywords.null\n            .filter((key) => schema && schema[key] != null)\n            .map((key) => core.validateKeyword[key](core, schema, value, pointer))\n};\n\n\nmodule.exports = TypeValidation;\n","/* eslint quote-props: 0 */\n\n\n/**\n * Mapping, used in type validation to iterate over type-specific keywords to validate\n *\n *  - overview https://epoberezkin.github.io/ajv/keywords.html\n *\n * @type {Object}\n */\nmodule.exports = {\n    array: [\"enum\", \"items\", \"minItems\", \"maxItems\", \"uniqueItems\", \"not\"],\n    boolean: [\"enum\", \"not\"],\n    object: [\n        \"additionalProperties\", \"dependencies\", \"enum\", \"format\", \"minProperties\", \"maxProperties\",\n        \"patternProperties\", \"properties\", \"required\", \"not\", \"oneOf\", \"allOf\", \"anyOf\"\n    ],\n    string: [\"enum\", \"format\", \"maxLength\", \"minLength\", \"pattern\", \"not\", \"oneOf\", \"allOf\", \"anyOf\"],\n    number: [\"enum\", \"format\", \"maximum\", \"minimum\", \"multipleOf\", \"not\", \"oneOf\", \"allOf\", \"anyOf\"],\n    null: [\"enum\", \"format\", \"not\", \"oneOf\", \"allOf\", \"anyOf\"]\n};\n","module.exports = {\n    \"http://json-schema.org/draft-04/schema\": require(\"./draft04.json\"),\n\n    reset() {\n        Object.keys(this).forEach((key) => {\n            if (typeof this[key] !== \"function\" && key !== \"http://json-schema.org/draft-04/schema\") {\n                delete this[key];\n            }\n        });\n    }\n};\n","var map = {\n\t\"./diff_match_patch_uncompressed\": \"./node_modules/jsondiffpatch/public/external/diff_match_patch_uncompressed.js\",\n\t\"./diff_match_patch_uncompressed.js\": \"./node_modules/jsondiffpatch/public/external/diff_match_patch_uncompressed.js\"\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = \"./node_modules/jsondiffpatch/public/external sync recursive ^\\\\.\\\\/.*$\";","/**\n * Diff Match and Patch\n *\n * Copyright 2006 Google Inc.\n * http://code.google.com/p/google-diff-match-patch/\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Computes the difference between two texts to create a patch.\n * Applies the patch onto another text, allowing for errors.\n * @author fraser@google.com (Neil Fraser)\n */\n\n/**\n * Class containing the diff, match and patch methods.\n * @constructor\n */\nfunction diff_match_patch() {\n\n  // Defaults.\n  // Redefine these in your program to override the defaults.\n\n  // Number of seconds to map a diff before giving up (0 for infinity).\n  this.Diff_Timeout = 1.0;\n  // Cost of an empty edit operation in terms of edit characters.\n  this.Diff_EditCost = 4;\n  // At what point is no match declared (0.0 = perfection, 1.0 = very loose).\n  this.Match_Threshold = 0.5;\n  // How far to search for a match (0 = exact location, 1000+ = broad match).\n  // A match this many characters away from the expected location will add\n  // 1.0 to the score (0.0 is a perfect match).\n  this.Match_Distance = 1000;\n  // When deleting a large block of text (over ~64 characters), how close does\n  // the contents have to match the expected contents. (0.0 = perfection,\n  // 1.0 = very loose).  Note that Match_Threshold controls how closely the\n  // end points of a delete need to match.\n  this.Patch_DeleteThreshold = 0.5;\n  // Chunk size for context length.\n  this.Patch_Margin = 4;\n\n  // The number of bits in an int.\n  this.Match_MaxBits = 32;\n}\n\n\n//  DIFF FUNCTIONS\n\n\n/**\n * The data structure representing a diff is an array of tuples:\n * [[DIFF_DELETE, 'Hello'], [DIFF_INSERT, 'Goodbye'], [DIFF_EQUAL, ' world.']]\n * which means: delete 'Hello', add 'Goodbye' and keep ' world.'\n */\nvar DIFF_DELETE = -1;\nvar DIFF_INSERT = 1;\nvar DIFF_EQUAL = 0;\n\n/** @typedef {!Array.<number|string>} */\ndiff_match_patch.Diff;\n\n\n/**\n * Find the differences between two texts.  Simplifies the problem by stripping\n * any common prefix or suffix off the texts before diffing.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {boolean=} opt_checklines Optional speedup flag. If present and false,\n *     then don't run a line-level diff first to identify the changed areas.\n *     Defaults to true, which does a faster, slightly less optimal diff.\n * @param {number} opt_deadline Optional time when the diff should be complete\n *     by.  Used internally for recursive calls.  Users should set DiffTimeout\n *     instead.\n * @return {!Array.<!diff_match_patch.Diff>} Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_main = function(text1, text2, opt_checklines,\n    opt_deadline) {\n  // Set a deadline by which time the diff must be complete.\n  if (typeof opt_deadline == 'undefined') {\n    if (this.Diff_Timeout <= 0) {\n      opt_deadline = Number.MAX_VALUE;\n    } else {\n      opt_deadline = (new Date).getTime() + this.Diff_Timeout * 1000;\n    }\n  }\n  var deadline = opt_deadline;\n\n  // Check for null inputs.\n  if (text1 == null || text2 == null) {\n    throw new Error('Null input. (diff_main)');\n  }\n\n  // Check for equality (speedup).\n  if (text1 == text2) {\n    if (text1) {\n      return [[DIFF_EQUAL, text1]];\n    }\n    return [];\n  }\n\n  if (typeof opt_checklines == 'undefined') {\n    opt_checklines = true;\n  }\n  var checklines = opt_checklines;\n\n  // Trim off common prefix (speedup).\n  var commonlength = this.diff_commonPrefix(text1, text2);\n  var commonprefix = text1.substring(0, commonlength);\n  text1 = text1.substring(commonlength);\n  text2 = text2.substring(commonlength);\n\n  // Trim off common suffix (speedup).\n  commonlength = this.diff_commonSuffix(text1, text2);\n  var commonsuffix = text1.substring(text1.length - commonlength);\n  text1 = text1.substring(0, text1.length - commonlength);\n  text2 = text2.substring(0, text2.length - commonlength);\n\n  // Compute the diff on the middle block.\n  var diffs = this.diff_compute_(text1, text2, checklines, deadline);\n\n  // Restore the prefix and suffix.\n  if (commonprefix) {\n    diffs.unshift([DIFF_EQUAL, commonprefix]);\n  }\n  if (commonsuffix) {\n    diffs.push([DIFF_EQUAL, commonsuffix]);\n  }\n  this.diff_cleanupMerge(diffs);\n  return diffs;\n};\n\n\n/**\n * Find the differences between two texts.  Assumes that the texts do not\n * have any common prefix or suffix.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {boolean} checklines Speedup flag.  If false, then don't run a\n *     line-level diff first to identify the changed areas.\n *     If true, then run a faster, slightly less optimal diff.\n * @param {number} deadline Time when the diff should be complete by.\n * @return {!Array.<!diff_match_patch.Diff>} Array of diff tuples.\n * @private\n */\ndiff_match_patch.prototype.diff_compute_ = function(text1, text2, checklines,\n    deadline) {\n  var diffs;\n\n  if (!text1) {\n    // Just add some text (speedup).\n    return [[DIFF_INSERT, text2]];\n  }\n\n  if (!text2) {\n    // Just delete some text (speedup).\n    return [[DIFF_DELETE, text1]];\n  }\n\n  var longtext = text1.length > text2.length ? text1 : text2;\n  var shorttext = text1.length > text2.length ? text2 : text1;\n  var i = longtext.indexOf(shorttext);\n  if (i != -1) {\n    // Shorter text is inside the longer text (speedup).\n    diffs = [[DIFF_INSERT, longtext.substring(0, i)],\n             [DIFF_EQUAL, shorttext],\n             [DIFF_INSERT, longtext.substring(i + shorttext.length)]];\n    // Swap insertions for deletions if diff is reversed.\n    if (text1.length > text2.length) {\n      diffs[0][0] = diffs[2][0] = DIFF_DELETE;\n    }\n    return diffs;\n  }\n\n  if (shorttext.length == 1) {\n    // Single character string.\n    // After the previous speedup, the character can't be an equality.\n    return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];\n  }\n  longtext = shorttext = null;  // Garbage collect.\n\n  // Check to see if the problem can be split in two.\n  var hm = this.diff_halfMatch_(text1, text2);\n  if (hm) {\n    // A half-match was found, sort out the return data.\n    var text1_a = hm[0];\n    var text1_b = hm[1];\n    var text2_a = hm[2];\n    var text2_b = hm[3];\n    var mid_common = hm[4];\n    // Send both pairs off for separate processing.\n    var diffs_a = this.diff_main(text1_a, text2_a, checklines, deadline);\n    var diffs_b = this.diff_main(text1_b, text2_b, checklines, deadline);\n    // Merge the results.\n    return diffs_a.concat([[DIFF_EQUAL, mid_common]], diffs_b);\n  }\n\n  if (checklines && text1.length > 100 && text2.length > 100) {\n    return this.diff_lineMode_(text1, text2, deadline);\n  }\n\n  return this.diff_bisect_(text1, text2, deadline);\n};\n\n\n/**\n * Do a quick line-level diff on both strings, then rediff the parts for\n * greater accuracy.\n * This speedup can produce non-minimal diffs.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {number} deadline Time when the diff should be complete by.\n * @return {!Array.<!diff_match_patch.Diff>} Array of diff tuples.\n * @private\n */\ndiff_match_patch.prototype.diff_lineMode_ = function(text1, text2, deadline) {\n  // Scan the text on a line-by-line basis first.\n  var a = this.diff_linesToChars_(text1, text2);\n  text1 = /** @type {string} */(a[0]);\n  text2 = /** @type {string} */(a[1]);\n  var linearray = /** @type {!Array.<string>} */(a[2]);\n\n  var diffs = this.diff_bisect_(text1, text2, deadline);\n\n  // Convert the diff back to original text.\n  this.diff_charsToLines_(diffs, linearray);\n  // Eliminate freak matches (e.g. blank lines)\n  this.diff_cleanupSemantic(diffs);\n\n  // Rediff any replacement blocks, this time character-by-character.\n  // Add a dummy entry at the end.\n  diffs.push([DIFF_EQUAL, '']);\n  var pointer = 0;\n  var count_delete = 0;\n  var count_insert = 0;\n  var text_delete = '';\n  var text_insert = '';\n  while (pointer < diffs.length) {\n    switch (diffs[pointer][0]) {\n      case DIFF_INSERT:\n        count_insert++;\n        text_insert += diffs[pointer][1];\n        break;\n      case DIFF_DELETE:\n        count_delete++;\n        text_delete += diffs[pointer][1];\n        break;\n      case DIFF_EQUAL:\n        // Upon reaching an equality, check for prior redundancies.\n        if (count_delete >= 1 && count_insert >= 1) {\n          // Delete the offending records and add the merged ones.\n          var a = this.diff_main(text_delete, text_insert, false, deadline);\n          diffs.splice(pointer - count_delete - count_insert,\n                       count_delete + count_insert);\n          pointer = pointer - count_delete - count_insert;\n          for (var j = a.length - 1; j >= 0; j--) {\n            diffs.splice(pointer, 0, a[j]);\n          }\n          pointer = pointer + a.length;\n        }\n        count_insert = 0;\n        count_delete = 0;\n        text_delete = '';\n        text_insert = '';\n        break;\n    }\n    pointer++;\n  }\n  diffs.pop();  // Remove the dummy entry at the end.\n\n  return diffs;\n};\n\n\n/**\n * Find the 'middle snake' of a diff, split the problem in two\n * and return the recursively constructed diff.\n * See Myers 1986 paper: An O(ND) Difference Algorithm and Its Variations.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {number} deadline Time at which to bail if not yet complete.\n * @return {!Array.<!diff_match_patch.Diff>} Array of diff tuples.\n * @private\n */\ndiff_match_patch.prototype.diff_bisect_ = function(text1, text2, deadline) {\n  // Cache the text lengths to prevent multiple calls.\n  var text1_length = text1.length;\n  var text2_length = text2.length;\n  var max_d = Math.ceil((text1_length + text2_length) / 2);\n  var v_offset = max_d;\n  var v_length = 2 * max_d;\n  var v1 = new Array(v_length);\n  var v2 = new Array(v_length);\n  // Setting all elements to -1 is faster in Chrome & Firefox than mixing\n  // integers and undefined.\n  for (var x = 0; x < v_length; x++) {\n    v1[x] = -1;\n    v2[x] = -1;\n  }\n  v1[v_offset + 1] = 0;\n  v2[v_offset + 1] = 0;\n  var delta = text1_length - text2_length;\n  // If the total number of characters is odd, then the front path will collide\n  // with the reverse path.\n  var front = (delta % 2 != 0);\n  // Offsets for start and end of k loop.\n  // Prevents mapping of space beyond the grid.\n  var k1start = 0;\n  var k1end = 0;\n  var k2start = 0;\n  var k2end = 0;\n  for (var d = 0; d < max_d; d++) {\n    // Bail out if deadline is reached.\n    if ((new Date()).getTime() > deadline) {\n      break;\n    }\n\n    // Walk the front path one step.\n    for (var k1 = -d + k1start; k1 <= d - k1end; k1 += 2) {\n      var k1_offset = v_offset + k1;\n      var x1;\n      if (k1 == -d || k1 != d && v1[k1_offset - 1] < v1[k1_offset + 1]) {\n        x1 = v1[k1_offset + 1];\n      } else {\n        x1 = v1[k1_offset - 1] + 1;\n      }\n      var y1 = x1 - k1;\n      while (x1 < text1_length && y1 < text2_length &&\n             text1.charAt(x1) == text2.charAt(y1)) {\n        x1++;\n        y1++;\n      }\n      v1[k1_offset] = x1;\n      if (x1 > text1_length) {\n        // Ran off the right of the graph.\n        k1end += 2;\n      } else if (y1 > text2_length) {\n        // Ran off the bottom of the graph.\n        k1start += 2;\n      } else if (front) {\n        var k2_offset = v_offset + delta - k1;\n        if (k2_offset >= 0 && k2_offset < v_length && v2[k2_offset] != -1) {\n          // Mirror x2 onto top-left coordinate system.\n          var x2 = text1_length - v2[k2_offset];\n          if (x1 >= x2) {\n            // Overlap detected.\n            return this.diff_bisectSplit_(text1, text2, x1, y1, deadline);\n          }\n        }\n      }\n    }\n\n    // Walk the reverse path one step.\n    for (var k2 = -d + k2start; k2 <= d - k2end; k2 += 2) {\n      var k2_offset = v_offset + k2;\n      var x2;\n      if (k2 == -d || k2 != d && v2[k2_offset - 1] < v2[k2_offset + 1]) {\n        x2 = v2[k2_offset + 1];\n      } else {\n        x2 = v2[k2_offset - 1] + 1;\n      }\n      var y2 = x2 - k2;\n      while (x2 < text1_length && y2 < text2_length &&\n             text1.charAt(text1_length - x2 - 1) ==\n             text2.charAt(text2_length - y2 - 1)) {\n        x2++;\n        y2++;\n      }\n      v2[k2_offset] = x2;\n      if (x2 > text1_length) {\n        // Ran off the left of the graph.\n        k2end += 2;\n      } else if (y2 > text2_length) {\n        // Ran off the top of the graph.\n        k2start += 2;\n      } else if (!front) {\n        var k1_offset = v_offset + delta - k2;\n        if (k1_offset >= 0 && k1_offset < v_length && v1[k1_offset] != -1) {\n          var x1 = v1[k1_offset];\n          var y1 = v_offset + x1 - k1_offset;\n          // Mirror x2 onto top-left coordinate system.\n          x2 = text1_length - x2;\n          if (x1 >= x2) {\n            // Overlap detected.\n            return this.diff_bisectSplit_(text1, text2, x1, y1, deadline);\n          }\n        }\n      }\n    }\n  }\n  // Diff took too long and hit the deadline or\n  // number of diffs equals number of characters, no commonality at all.\n  return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];\n};\n\n\n/**\n * Given the location of the 'middle snake', split the diff in two parts\n * and recurse.\n * @param {string} text1 Old string to be diffed.\n * @param {string} text2 New string to be diffed.\n * @param {number} x Index of split point in text1.\n * @param {number} y Index of split point in text2.\n * @param {number} deadline Time at which to bail if not yet complete.\n * @return {!Array.<!diff_match_patch.Diff>} Array of diff tuples.\n * @private\n */\ndiff_match_patch.prototype.diff_bisectSplit_ = function(text1, text2, x, y,\n    deadline) {\n  var text1a = text1.substring(0, x);\n  var text2a = text2.substring(0, y);\n  var text1b = text1.substring(x);\n  var text2b = text2.substring(y);\n\n  // Compute both diffs serially.\n  var diffs = this.diff_main(text1a, text2a, false, deadline);\n  var diffsb = this.diff_main(text1b, text2b, false, deadline);\n\n  return diffs.concat(diffsb);\n};\n\n\n/**\n * Split two texts into an array of strings.  Reduce the texts to a string of\n * hashes where each Unicode character represents one line.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {!Array.<string|!Array.<string>>} Three element Array, containing the\n *     encoded text1, the encoded text2 and the array of unique strings.  The\n *     zeroth element of the array of unique strings is intentionally blank.\n * @private\n */\ndiff_match_patch.prototype.diff_linesToChars_ = function(text1, text2) {\n  var lineArray = [];  // e.g. lineArray[4] == 'Hello\\n'\n  var lineHash = {};   // e.g. lineHash['Hello\\n'] == 4\n\n  // '\\x00' is a valid character, but various debuggers don't like it.\n  // So we'll insert a junk entry to avoid generating a null character.\n  lineArray[0] = '';\n\n  /**\n   * Split a text into an array of strings.  Reduce the texts to a string of\n   * hashes where each Unicode character represents one line.\n   * Modifies linearray and linehash through being a closure.\n   * @param {string} text String to encode.\n   * @return {string} Encoded string.\n   * @private\n   */\n  function diff_linesToCharsMunge_(text) {\n    var chars = '';\n    // Walk the text, pulling out a substring for each line.\n    // text.split('\\n') would would temporarily double our memory footprint.\n    // Modifying text would create many large strings to garbage collect.\n    var lineStart = 0;\n    var lineEnd = -1;\n    // Keeping our own length variable is faster than looking it up.\n    var lineArrayLength = lineArray.length;\n    while (lineEnd < text.length - 1) {\n      lineEnd = text.indexOf('\\n', lineStart);\n      if (lineEnd == -1) {\n        lineEnd = text.length - 1;\n      }\n      var line = text.substring(lineStart, lineEnd + 1);\n      lineStart = lineEnd + 1;\n\n      if (lineHash.hasOwnProperty ? lineHash.hasOwnProperty(line) :\n          (lineHash[line] !== undefined)) {\n        chars += String.fromCharCode(lineHash[line]);\n      } else {\n        chars += String.fromCharCode(lineArrayLength);\n        lineHash[line] = lineArrayLength;\n        lineArray[lineArrayLength++] = line;\n      }\n    }\n    return chars;\n  }\n\n  var chars1 = diff_linesToCharsMunge_(text1);\n  var chars2 = diff_linesToCharsMunge_(text2);\n  return [chars1, chars2, lineArray];\n};\n\n\n/**\n * Rehydrate the text in a diff from a string of line hashes to real lines of\n * text.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n * @param {!Array.<string>} lineArray Array of unique strings.\n * @private\n */\ndiff_match_patch.prototype.diff_charsToLines_ = function(diffs, lineArray) {\n  for (var x = 0; x < diffs.length; x++) {\n    var chars = diffs[x][1];\n    var text = [];\n    for (var y = 0; y < chars.length; y++) {\n      text[y] = lineArray[chars.charCodeAt(y)];\n    }\n    diffs[x][1] = text.join('');\n  }\n};\n\n\n/**\n * Determine the common prefix of two strings.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {number} The number of characters common to the start of each\n *     string.\n */\ndiff_match_patch.prototype.diff_commonPrefix = function(text1, text2) {\n  // Quick check for common null cases.\n  if (!text1 || !text2 || text1.charAt(0) != text2.charAt(0)) {\n    return 0;\n  }\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  var pointermin = 0;\n  var pointermax = Math.min(text1.length, text2.length);\n  var pointermid = pointermax;\n  var pointerstart = 0;\n  while (pointermin < pointermid) {\n    if (text1.substring(pointerstart, pointermid) ==\n        text2.substring(pointerstart, pointermid)) {\n      pointermin = pointermid;\n      pointerstart = pointermin;\n    } else {\n      pointermax = pointermid;\n    }\n    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);\n  }\n  return pointermid;\n};\n\n\n/**\n * Determine the common suffix of two strings.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {number} The number of characters common to the end of each string.\n */\ndiff_match_patch.prototype.diff_commonSuffix = function(text1, text2) {\n  // Quick check for common null cases.\n  if (!text1 || !text2 ||\n      text1.charAt(text1.length - 1) != text2.charAt(text2.length - 1)) {\n    return 0;\n  }\n  // Binary search.\n  // Performance analysis: http://neil.fraser.name/news/2007/10/09/\n  var pointermin = 0;\n  var pointermax = Math.min(text1.length, text2.length);\n  var pointermid = pointermax;\n  var pointerend = 0;\n  while (pointermin < pointermid) {\n    if (text1.substring(text1.length - pointermid, text1.length - pointerend) ==\n        text2.substring(text2.length - pointermid, text2.length - pointerend)) {\n      pointermin = pointermid;\n      pointerend = pointermin;\n    } else {\n      pointermax = pointermid;\n    }\n    pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);\n  }\n  return pointermid;\n};\n\n\n/**\n * Determine if the suffix of one string is the prefix of another.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {number} The number of characters common to the end of the first\n *     string and the start of the second string.\n * @private\n */\ndiff_match_patch.prototype.diff_commonOverlap_ = function(text1, text2) {\n  // Cache the text lengths to prevent multiple calls.\n  var text1_length = text1.length;\n  var text2_length = text2.length;\n  // Eliminate the null case.\n  if (text1_length == 0 || text2_length == 0) {\n    return 0;\n  }\n  // Truncate the longer string.\n  if (text1_length > text2_length) {\n    text1 = text1.substring(text1_length - text2_length);\n  } else if (text1_length < text2_length) {\n    text2 = text2.substring(0, text1_length);\n  }\n  var text_length = Math.min(text1_length, text2_length);\n  // Quick check for the worst case.\n  if (text1 == text2) {\n    return text_length;\n  }\n\n  // Start by looking for a single character match\n  // and increase length until no match is found.\n  // Performance analysis: http://neil.fraser.name/news/2010/11/04/\n  var best = 0;\n  var length = 1;\n  while (true) {\n    var pattern = text1.substring(text_length - length);\n    var found = text2.indexOf(pattern);\n    if (found == -1) {\n      return best;\n    }\n    length += found;\n    if (found == 0 || text1.substring(text_length - length) ==\n        text2.substring(0, length)) {\n      best = length;\n      length++;\n    }\n  }\n};\n\n\n/**\n * Do the two texts share a substring which is at least half the length of the\n * longer text?\n * This speedup can produce non-minimal diffs.\n * @param {string} text1 First string.\n * @param {string} text2 Second string.\n * @return {Array.<string>} Five element Array, containing the prefix of\n *     text1, the suffix of text1, the prefix of text2, the suffix of\n *     text2 and the common middle.  Or null if there was no match.\n * @private\n */\ndiff_match_patch.prototype.diff_halfMatch_ = function(text1, text2) {\n  if (this.Diff_Timeout <= 0) {\n    // Don't risk returning a non-optimal diff if we have unlimited time.\n    return null;\n  }\n  var longtext = text1.length > text2.length ? text1 : text2;\n  var shorttext = text1.length > text2.length ? text2 : text1;\n  if (longtext.length < 4 || shorttext.length * 2 < longtext.length) {\n    return null;  // Pointless.\n  }\n  var dmp = this;  // 'this' becomes 'window' in a closure.\n\n  /**\n   * Does a substring of shorttext exist within longtext such that the substring\n   * is at least half the length of longtext?\n   * Closure, but does not reference any external variables.\n   * @param {string} longtext Longer string.\n   * @param {string} shorttext Shorter string.\n   * @param {number} i Start index of quarter length substring within longtext.\n   * @return {Array.<string>} Five element Array, containing the prefix of\n   *     longtext, the suffix of longtext, the prefix of shorttext, the suffix\n   *     of shorttext and the common middle.  Or null if there was no match.\n   * @private\n   */\n  function diff_halfMatchI_(longtext, shorttext, i) {\n    // Start with a 1/4 length substring at position i as a seed.\n    var seed = longtext.substring(i, i + Math.floor(longtext.length / 4));\n    var j = -1;\n    var best_common = '';\n    var best_longtext_a, best_longtext_b, best_shorttext_a, best_shorttext_b;\n    while ((j = shorttext.indexOf(seed, j + 1)) != -1) {\n      var prefixLength = dmp.diff_commonPrefix(longtext.substring(i),\n                                               shorttext.substring(j));\n      var suffixLength = dmp.diff_commonSuffix(longtext.substring(0, i),\n                                               shorttext.substring(0, j));\n      if (best_common.length < suffixLength + prefixLength) {\n        best_common = shorttext.substring(j - suffixLength, j) +\n            shorttext.substring(j, j + prefixLength);\n        best_longtext_a = longtext.substring(0, i - suffixLength);\n        best_longtext_b = longtext.substring(i + prefixLength);\n        best_shorttext_a = shorttext.substring(0, j - suffixLength);\n        best_shorttext_b = shorttext.substring(j + prefixLength);\n      }\n    }\n    if (best_common.length * 2 >= longtext.length) {\n      return [best_longtext_a, best_longtext_b,\n              best_shorttext_a, best_shorttext_b, best_common];\n    } else {\n      return null;\n    }\n  }\n\n  // First check if the second quarter is the seed for a half-match.\n  var hm1 = diff_halfMatchI_(longtext, shorttext,\n                             Math.ceil(longtext.length / 4));\n  // Check again based on the third quarter.\n  var hm2 = diff_halfMatchI_(longtext, shorttext,\n                             Math.ceil(longtext.length / 2));\n  var hm;\n  if (!hm1 && !hm2) {\n    return null;\n  } else if (!hm2) {\n    hm = hm1;\n  } else if (!hm1) {\n    hm = hm2;\n  } else {\n    // Both matched.  Select the longest.\n    hm = hm1[4].length > hm2[4].length ? hm1 : hm2;\n  }\n\n  // A half-match was found, sort out the return data.\n  var text1_a, text1_b, text2_a, text2_b;\n  if (text1.length > text2.length) {\n    text1_a = hm[0];\n    text1_b = hm[1];\n    text2_a = hm[2];\n    text2_b = hm[3];\n  } else {\n    text2_a = hm[0];\n    text2_b = hm[1];\n    text1_a = hm[2];\n    text1_b = hm[3];\n  }\n  var mid_common = hm[4];\n  return [text1_a, text1_b, text2_a, text2_b, mid_common];\n};\n\n\n/**\n * Reduce the number of edits by eliminating semantically trivial equalities.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupSemantic = function(diffs) {\n  var changes = false;\n  var equalities = [];  // Stack of indices where equalities are found.\n  var equalitiesLength = 0;  // Keeping our own length var is faster in JS.\n  /** @type {?string} */\n  var lastequality = null;  // Always equal to equalities[equalitiesLength-1][1]\n  var pointer = 0;  // Index of current position.\n  // Number of characters that changed prior to the equality.\n  var length_insertions1 = 0;\n  var length_deletions1 = 0;\n  // Number of characters that changed after the equality.\n  var length_insertions2 = 0;\n  var length_deletions2 = 0;\n  while (pointer < diffs.length) {\n    if (diffs[pointer][0] == DIFF_EQUAL) {  // Equality found.\n      equalities[equalitiesLength++] = pointer;\n      length_insertions1 = length_insertions2;\n      length_deletions1 = length_deletions2;\n      length_insertions2 = 0;\n      length_deletions2 = 0;\n      lastequality = /** @type {string} */(diffs[pointer][1]);\n    } else {  // An insertion or deletion.\n      if (diffs[pointer][0] == DIFF_INSERT) {\n        length_insertions2 += diffs[pointer][1].length;\n      } else {\n        length_deletions2 += diffs[pointer][1].length;\n      }\n      // Eliminate an equality that is smaller or equal to the edits on both\n      // sides of it.\n      if (lastequality !== null && (lastequality.length <=\n          Math.max(length_insertions1, length_deletions1)) &&\n          (lastequality.length <= Math.max(length_insertions2,\n                                           length_deletions2))) {\n        // Duplicate record.\n        diffs.splice(equalities[equalitiesLength - 1], 0,\n                     [DIFF_DELETE, lastequality]);\n        // Change second copy to insert.\n        diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT;\n        // Throw away the equality we just deleted.\n        equalitiesLength--;\n        // Throw away the previous equality (it needs to be reevaluated).\n        equalitiesLength--;\n        pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1;\n        length_insertions1 = 0;  // Reset the counters.\n        length_deletions1 = 0;\n        length_insertions2 = 0;\n        length_deletions2 = 0;\n        lastequality = null;\n        changes = true;\n      }\n    }\n    pointer++;\n  }\n\n  // Normalize the diff.\n  if (changes) {\n    this.diff_cleanupMerge(diffs);\n  }\n  this.diff_cleanupSemanticLossless(diffs);\n\n  // Find any overlaps between deletions and insertions.\n  // e.g: <del>abcxxx</del><ins>xxxdef</ins>\n  //   -> <del>abc</del>xxx<ins>def</ins>\n  // Only extract an overlap if it is as big as the edit ahead or behind it.\n  pointer = 1;\n  while (pointer < diffs.length) {\n    if (diffs[pointer - 1][0] == DIFF_DELETE &&\n        diffs[pointer][0] == DIFF_INSERT) {\n      var deletion = /** @type {string} */(diffs[pointer - 1][1]);\n      var insertion = /** @type {string} */(diffs[pointer][1]);\n      var overlap_length = this.diff_commonOverlap_(deletion, insertion);\n      if (overlap_length >= deletion.length / 2 ||\n          overlap_length >= insertion.length / 2) {\n        // Overlap found.  Insert an equality and trim the surrounding edits.\n        diffs.splice(pointer, 0,\n            [DIFF_EQUAL, insertion.substring(0, overlap_length)]);\n        diffs[pointer - 1][1] =\n            deletion.substring(0, deletion.length - overlap_length);\n        diffs[pointer + 1][1] = insertion.substring(overlap_length);\n        pointer++;\n      }\n      pointer++;\n    }\n    pointer++;\n  }\n};\n\n\n/**\n * Look for single edits surrounded on both sides by equalities\n * which can be shifted sideways to align the edit to a word boundary.\n * e.g: The c<ins>at c</ins>ame. -> The <ins>cat </ins>came.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupSemanticLossless = function(diffs) {\n  // Define some regex patterns for matching boundaries.\n  var punctuation = /[^a-zA-Z0-9]/;\n  var whitespace = /\\s/;\n  var linebreak = /[\\r\\n]/;\n  var blanklineEnd = /\\n\\r?\\n$/;\n  var blanklineStart = /^\\r?\\n\\r?\\n/;\n\n  /**\n   * Given two strings, compute a score representing whether the internal\n   * boundary falls on logical boundaries.\n   * Scores range from 5 (best) to 0 (worst).\n   * Closure, makes reference to regex patterns defined above.\n   * @param {string} one First string.\n   * @param {string} two Second string.\n   * @return {number} The score.\n   * @private\n   */\n  function diff_cleanupSemanticScore_(one, two) {\n    if (!one || !two) {\n      // Edges are the best.\n      return 5;\n    }\n\n    // Each port of this function behaves slightly differently due to\n    // subtle differences in each language's definition of things like\n    // 'whitespace'.  Since this function's purpose is largely cosmetic,\n    // the choice has been made to use each language's native features\n    // rather than force total conformity.\n    var score = 0;\n    // One point for non-alphanumeric.\n    if (one.charAt(one.length - 1).match(punctuation) ||\n        two.charAt(0).match(punctuation)) {\n      score++;\n      // Two points for whitespace.\n      if (one.charAt(one.length - 1).match(whitespace) ||\n          two.charAt(0).match(whitespace)) {\n        score++;\n        // Three points for line breaks.\n        if (one.charAt(one.length - 1).match(linebreak) ||\n            two.charAt(0).match(linebreak)) {\n          score++;\n          // Four points for blank lines.\n          if (one.match(blanklineEnd) || two.match(blanklineStart)) {\n            score++;\n          }\n        }\n      }\n    }\n    return score;\n  }\n\n  var pointer = 1;\n  // Intentionally ignore the first and last element (don't need checking).\n  while (pointer < diffs.length - 1) {\n    if (diffs[pointer - 1][0] == DIFF_EQUAL &&\n        diffs[pointer + 1][0] == DIFF_EQUAL) {\n      // This is a single edit surrounded by equalities.\n      var equality1 = /** @type {string} */(diffs[pointer - 1][1]);\n      var edit = /** @type {string} */(diffs[pointer][1]);\n      var equality2 = /** @type {string} */(diffs[pointer + 1][1]);\n\n      // First, shift the edit as far left as possible.\n      var commonOffset = this.diff_commonSuffix(equality1, edit);\n      if (commonOffset) {\n        var commonString = edit.substring(edit.length - commonOffset);\n        equality1 = equality1.substring(0, equality1.length - commonOffset);\n        edit = commonString + edit.substring(0, edit.length - commonOffset);\n        equality2 = commonString + equality2;\n      }\n\n      // Second, step character by character right, looking for the best fit.\n      var bestEquality1 = equality1;\n      var bestEdit = edit;\n      var bestEquality2 = equality2;\n      var bestScore = diff_cleanupSemanticScore_(equality1, edit) +\n          diff_cleanupSemanticScore_(edit, equality2);\n      while (edit.charAt(0) === equality2.charAt(0)) {\n        equality1 += edit.charAt(0);\n        edit = edit.substring(1) + equality2.charAt(0);\n        equality2 = equality2.substring(1);\n        var score = diff_cleanupSemanticScore_(equality1, edit) +\n            diff_cleanupSemanticScore_(edit, equality2);\n        // The >= encourages trailing rather than leading whitespace on edits.\n        if (score >= bestScore) {\n          bestScore = score;\n          bestEquality1 = equality1;\n          bestEdit = edit;\n          bestEquality2 = equality2;\n        }\n      }\n\n      if (diffs[pointer - 1][1] != bestEquality1) {\n        // We have an improvement, save it back to the diff.\n        if (bestEquality1) {\n          diffs[pointer - 1][1] = bestEquality1;\n        } else {\n          diffs.splice(pointer - 1, 1);\n          pointer--;\n        }\n        diffs[pointer][1] = bestEdit;\n        if (bestEquality2) {\n          diffs[pointer + 1][1] = bestEquality2;\n        } else {\n          diffs.splice(pointer + 1, 1);\n          pointer--;\n        }\n      }\n    }\n    pointer++;\n  }\n};\n\n\n/**\n * Reduce the number of edits by eliminating operationally trivial equalities.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupEfficiency = function(diffs) {\n  var changes = false;\n  var equalities = [];  // Stack of indices where equalities are found.\n  var equalitiesLength = 0;  // Keeping our own length var is faster in JS.\n  var lastequality = '';  // Always equal to equalities[equalitiesLength-1][1]\n  var pointer = 0;  // Index of current position.\n  // Is there an insertion operation before the last equality.\n  var pre_ins = false;\n  // Is there a deletion operation before the last equality.\n  var pre_del = false;\n  // Is there an insertion operation after the last equality.\n  var post_ins = false;\n  // Is there a deletion operation after the last equality.\n  var post_del = false;\n  while (pointer < diffs.length) {\n    if (diffs[pointer][0] == DIFF_EQUAL) {  // Equality found.\n      if (diffs[pointer][1].length < this.Diff_EditCost &&\n          (post_ins || post_del)) {\n        // Candidate found.\n        equalities[equalitiesLength++] = pointer;\n        pre_ins = post_ins;\n        pre_del = post_del;\n        lastequality = diffs[pointer][1];\n      } else {\n        // Not a candidate, and can never become one.\n        equalitiesLength = 0;\n        lastequality = '';\n      }\n      post_ins = post_del = false;\n    } else {  // An insertion or deletion.\n      if (diffs[pointer][0] == DIFF_DELETE) {\n        post_del = true;\n      } else {\n        post_ins = true;\n      }\n      /*\n       * Five types to be split:\n       * <ins>A</ins><del>B</del>XY<ins>C</ins><del>D</del>\n       * <ins>A</ins>X<ins>C</ins><del>D</del>\n       * <ins>A</ins><del>B</del>X<ins>C</ins>\n       * <ins>A</del>X<ins>C</ins><del>D</del>\n       * <ins>A</ins><del>B</del>X<del>C</del>\n       */\n      if (lastequality && ((pre_ins && pre_del && post_ins && post_del) ||\n                           ((lastequality.length < this.Diff_EditCost / 2) &&\n                            (pre_ins + pre_del + post_ins + post_del) == 3))) {\n        // Duplicate record.\n        diffs.splice(equalities[equalitiesLength - 1], 0,\n                     [DIFF_DELETE, lastequality]);\n        // Change second copy to insert.\n        diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT;\n        equalitiesLength--;  // Throw away the equality we just deleted;\n        lastequality = '';\n        if (pre_ins && pre_del) {\n          // No changes made which could affect previous entry, keep going.\n          post_ins = post_del = true;\n          equalitiesLength = 0;\n        } else {\n          equalitiesLength--;  // Throw away the previous equality.\n          pointer = equalitiesLength > 0 ?\n              equalities[equalitiesLength - 1] : -1;\n          post_ins = post_del = false;\n        }\n        changes = true;\n      }\n    }\n    pointer++;\n  }\n\n  if (changes) {\n    this.diff_cleanupMerge(diffs);\n  }\n};\n\n\n/**\n * Reorder and merge like edit sections.  Merge equalities.\n * Any edit section can move as long as it doesn't cross an equality.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n */\ndiff_match_patch.prototype.diff_cleanupMerge = function(diffs) {\n  diffs.push([DIFF_EQUAL, '']);  // Add a dummy entry at the end.\n  var pointer = 0;\n  var count_delete = 0;\n  var count_insert = 0;\n  var text_delete = '';\n  var text_insert = '';\n  var commonlength;\n  while (pointer < diffs.length) {\n    switch (diffs[pointer][0]) {\n      case DIFF_INSERT:\n        count_insert++;\n        text_insert += diffs[pointer][1];\n        pointer++;\n        break;\n      case DIFF_DELETE:\n        count_delete++;\n        text_delete += diffs[pointer][1];\n        pointer++;\n        break;\n      case DIFF_EQUAL:\n        // Upon reaching an equality, check for prior redundancies.\n        if (count_delete + count_insert > 1) {\n          if (count_delete !== 0 && count_insert !== 0) {\n            // Factor out any common prefixies.\n            commonlength = this.diff_commonPrefix(text_insert, text_delete);\n            if (commonlength !== 0) {\n              if ((pointer - count_delete - count_insert) > 0 &&\n                  diffs[pointer - count_delete - count_insert - 1][0] ==\n                  DIFF_EQUAL) {\n                diffs[pointer - count_delete - count_insert - 1][1] +=\n                    text_insert.substring(0, commonlength);\n              } else {\n                diffs.splice(0, 0, [DIFF_EQUAL,\n                                    text_insert.substring(0, commonlength)]);\n                pointer++;\n              }\n              text_insert = text_insert.substring(commonlength);\n              text_delete = text_delete.substring(commonlength);\n            }\n            // Factor out any common suffixies.\n            commonlength = this.diff_commonSuffix(text_insert, text_delete);\n            if (commonlength !== 0) {\n              diffs[pointer][1] = text_insert.substring(text_insert.length -\n                  commonlength) + diffs[pointer][1];\n              text_insert = text_insert.substring(0, text_insert.length -\n                  commonlength);\n              text_delete = text_delete.substring(0, text_delete.length -\n                  commonlength);\n            }\n          }\n          // Delete the offending records and add the merged ones.\n          if (count_delete === 0) {\n            diffs.splice(pointer - count_delete - count_insert,\n                count_delete + count_insert, [DIFF_INSERT, text_insert]);\n          } else if (count_insert === 0) {\n            diffs.splice(pointer - count_delete - count_insert,\n                count_delete + count_insert, [DIFF_DELETE, text_delete]);\n          } else {\n            diffs.splice(pointer - count_delete - count_insert,\n                count_delete + count_insert, [DIFF_DELETE, text_delete],\n                [DIFF_INSERT, text_insert]);\n          }\n          pointer = pointer - count_delete - count_insert +\n                    (count_delete ? 1 : 0) + (count_insert ? 1 : 0) + 1;\n        } else if (pointer !== 0 && diffs[pointer - 1][0] == DIFF_EQUAL) {\n          // Merge this equality with the previous one.\n          diffs[pointer - 1][1] += diffs[pointer][1];\n          diffs.splice(pointer, 1);\n        } else {\n          pointer++;\n        }\n        count_insert = 0;\n        count_delete = 0;\n        text_delete = '';\n        text_insert = '';\n        break;\n    }\n  }\n  if (diffs[diffs.length - 1][1] === '') {\n    diffs.pop();  // Remove the dummy entry at the end.\n  }\n\n  // Second pass: look for single edits surrounded on both sides by equalities\n  // which can be shifted sideways to eliminate an equality.\n  // e.g: A<ins>BA</ins>C -> <ins>AB</ins>AC\n  var changes = false;\n  pointer = 1;\n  // Intentionally ignore the first and last element (don't need checking).\n  while (pointer < diffs.length - 1) {\n    if (diffs[pointer - 1][0] == DIFF_EQUAL &&\n        diffs[pointer + 1][0] == DIFF_EQUAL) {\n      // This is a single edit surrounded by equalities.\n      if (diffs[pointer][1].substring(diffs[pointer][1].length -\n          diffs[pointer - 1][1].length) == diffs[pointer - 1][1]) {\n        // Shift the edit over the previous equality.\n        diffs[pointer][1] = diffs[pointer - 1][1] +\n            diffs[pointer][1].substring(0, diffs[pointer][1].length -\n                                        diffs[pointer - 1][1].length);\n        diffs[pointer + 1][1] = diffs[pointer - 1][1] + diffs[pointer + 1][1];\n        diffs.splice(pointer - 1, 1);\n        changes = true;\n      } else if (diffs[pointer][1].substring(0, diffs[pointer + 1][1].length) ==\n          diffs[pointer + 1][1]) {\n        // Shift the edit over the next equality.\n        diffs[pointer - 1][1] += diffs[pointer + 1][1];\n        diffs[pointer][1] =\n            diffs[pointer][1].substring(diffs[pointer + 1][1].length) +\n            diffs[pointer + 1][1];\n        diffs.splice(pointer + 1, 1);\n        changes = true;\n      }\n    }\n    pointer++;\n  }\n  // If shifts were made, the diff needs reordering and another shift sweep.\n  if (changes) {\n    this.diff_cleanupMerge(diffs);\n  }\n};\n\n\n/**\n * loc is a location in text1, compute and return the equivalent location in\n * text2.\n * e.g. 'The cat' vs 'The big cat', 1->1, 5->8\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n * @param {number} loc Location within text1.\n * @return {number} Location within text2.\n */\ndiff_match_patch.prototype.diff_xIndex = function(diffs, loc) {\n  var chars1 = 0;\n  var chars2 = 0;\n  var last_chars1 = 0;\n  var last_chars2 = 0;\n  var x;\n  for (x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_INSERT) {  // Equality or deletion.\n      chars1 += diffs[x][1].length;\n    }\n    if (diffs[x][0] !== DIFF_DELETE) {  // Equality or insertion.\n      chars2 += diffs[x][1].length;\n    }\n    if (chars1 > loc) {  // Overshot the location.\n      break;\n    }\n    last_chars1 = chars1;\n    last_chars2 = chars2;\n  }\n  // Was the location was deleted?\n  if (diffs.length != x && diffs[x][0] === DIFF_DELETE) {\n    return last_chars2;\n  }\n  // Add the remaining character length.\n  return last_chars2 + (loc - last_chars1);\n};\n\n\n/**\n * Convert a diff array into a pretty HTML report.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n * @return {string} HTML representation.\n */\ndiff_match_patch.prototype.diff_prettyHtml = function(diffs) {\n  var html = [];\n  var i = 0;\n  var pattern_amp = /&/g;\n  var pattern_lt = /</g;\n  var pattern_gt = />/g;\n  var pattern_para = /\\n/g;\n  for (var x = 0; x < diffs.length; x++) {\n    var op = diffs[x][0];    // Operation (insert, delete, equal)\n    var data = diffs[x][1];  // Text of change.\n    var text = data.replace(pattern_amp, '&amp;').replace(pattern_lt, '&lt;')\n        .replace(pattern_gt, '&gt;').replace(pattern_para, '&para;<br>');\n    switch (op) {\n      case DIFF_INSERT:\n        html[x] = '<ins style=\"background:#e6ffe6;\">' + text + '</ins>';\n        break;\n      case DIFF_DELETE:\n        html[x] = '<del style=\"background:#ffe6e6;\">' + text + '</del>';\n        break;\n      case DIFF_EQUAL:\n        html[x] = '<span>' + text + '</span>';\n        break;\n    }\n    if (op !== DIFF_DELETE) {\n      i += data.length;\n    }\n  }\n  return html.join('');\n};\n\n\n/**\n * Compute and return the source text (all equalities and deletions).\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n * @return {string} Source text.\n */\ndiff_match_patch.prototype.diff_text1 = function(diffs) {\n  var text = [];\n  for (var x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_INSERT) {\n      text[x] = diffs[x][1];\n    }\n  }\n  return text.join('');\n};\n\n\n/**\n * Compute and return the destination text (all equalities and insertions).\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n * @return {string} Destination text.\n */\ndiff_match_patch.prototype.diff_text2 = function(diffs) {\n  var text = [];\n  for (var x = 0; x < diffs.length; x++) {\n    if (diffs[x][0] !== DIFF_DELETE) {\n      text[x] = diffs[x][1];\n    }\n  }\n  return text.join('');\n};\n\n\n/**\n * Compute the Levenshtein distance; the number of inserted, deleted or\n * substituted characters.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n * @return {number} Number of changes.\n */\ndiff_match_patch.prototype.diff_levenshtein = function(diffs) {\n  var levenshtein = 0;\n  var insertions = 0;\n  var deletions = 0;\n  for (var x = 0; x < diffs.length; x++) {\n    var op = diffs[x][0];\n    var data = diffs[x][1];\n    switch (op) {\n      case DIFF_INSERT:\n        insertions += data.length;\n        break;\n      case DIFF_DELETE:\n        deletions += data.length;\n        break;\n      case DIFF_EQUAL:\n        // A deletion and an insertion is one substitution.\n        levenshtein += Math.max(insertions, deletions);\n        insertions = 0;\n        deletions = 0;\n        break;\n    }\n  }\n  levenshtein += Math.max(insertions, deletions);\n  return levenshtein;\n};\n\n\n/**\n * Crush the diff into an encoded string which describes the operations\n * required to transform text1 into text2.\n * E.g. =3\\t-2\\t+ing  -> Keep 3 chars, delete 2 chars, insert 'ing'.\n * Operations are tab-separated.  Inserted text is escaped using %xx notation.\n * @param {!Array.<!diff_match_patch.Diff>} diffs Array of diff tuples.\n * @return {string} Delta text.\n */\ndiff_match_patch.prototype.diff_toDelta = function(diffs) {\n  var text = [];\n  for (var x = 0; x < diffs.length; x++) {\n    switch (diffs[x][0]) {\n      case DIFF_INSERT:\n        text[x] = '+' + encodeURI(diffs[x][1]);\n        break;\n      case DIFF_DELETE:\n        text[x] = '-' + diffs[x][1].length;\n        break;\n      case DIFF_EQUAL:\n        text[x] = '=' + diffs[x][1].length;\n        break;\n    }\n  }\n  return text.join('\\t').replace(/%20/g, ' ');\n};\n\n\n/**\n * Given the original text1, and an encoded string which describes the\n * operations required to transform text1 into text2, compute the full diff.\n * @param {string} text1 Source string for the diff.\n * @param {string} delta Delta text.\n * @return {!Array.<!diff_match_patch.Diff>} Array of diff tuples.\n * @throws {!Error} If invalid input.\n */\ndiff_match_patch.prototype.diff_fromDelta = function(text1, delta) {\n  var diffs = [];\n  var diffsLength = 0;  // Keeping our own length var is faster in JS.\n  var pointer = 0;  // Cursor in text1\n  var tokens = delta.split(/\\t/g);\n  for (var x = 0; x < tokens.length; x++) {\n    // Each token begins with a one character parameter which specifies the\n    // operation of this token (delete, insert, equality).\n    var param = tokens[x].substring(1);\n    switch (tokens[x].charAt(0)) {\n      case '+':\n        try {\n          diffs[diffsLength++] = [DIFF_INSERT, decodeURI(param)];\n        } catch (ex) {\n          // Malformed URI sequence.\n          throw new Error('Illegal escape in diff_fromDelta: ' + param);\n        }\n        break;\n      case '-':\n        // Fall through.\n      case '=':\n        var n = parseInt(param, 10);\n        if (isNaN(n) || n < 0) {\n          throw new Error('Invalid number in diff_fromDelta: ' + param);\n        }\n        var text = text1.substring(pointer, pointer += n);\n        if (tokens[x].charAt(0) == '=') {\n          diffs[diffsLength++] = [DIFF_EQUAL, text];\n        } else {\n          diffs[diffsLength++] = [DIFF_DELETE, text];\n        }\n        break;\n      default:\n        // Blank tokens are ok (from a trailing \\t).\n        // Anything else is an error.\n        if (tokens[x]) {\n          throw new Error('Invalid diff operation in diff_fromDelta: ' +\n                          tokens[x]);\n        }\n    }\n  }\n  if (pointer != text1.length) {\n    throw new Error('Delta length (' + pointer +\n        ') does not equal source text length (' + text1.length + ').');\n  }\n  return diffs;\n};\n\n\n//  MATCH FUNCTIONS\n\n\n/**\n * Locate the best instance of 'pattern' in 'text' near 'loc'.\n * @param {string} text The text to search.\n * @param {string} pattern The pattern to search for.\n * @param {number} loc The location to search around.\n * @return {number} Best match index or -1.\n */\ndiff_match_patch.prototype.match_main = function(text, pattern, loc) {\n  // Check for null inputs.\n  if (text == null || pattern == null || loc == null) {\n    throw new Error('Null input. (match_main)');\n  }\n\n  loc = Math.max(0, Math.min(loc, text.length));\n  if (text == pattern) {\n    // Shortcut (potentially not guaranteed by the algorithm)\n    return 0;\n  } else if (!text.length) {\n    // Nothing to match.\n    return -1;\n  } else if (text.substring(loc, loc + pattern.length) == pattern) {\n    // Perfect match at the perfect spot!  (Includes case of null pattern)\n    return loc;\n  } else {\n    // Do a fuzzy compare.\n    return this.match_bitap_(text, pattern, loc);\n  }\n};\n\n\n/**\n * Locate the best instance of 'pattern' in 'text' near 'loc' using the\n * Bitap algorithm.\n * @param {string} text The text to search.\n * @param {string} pattern The pattern to search for.\n * @param {number} loc The location to search around.\n * @return {number} Best match index or -1.\n * @private\n */\ndiff_match_patch.prototype.match_bitap_ = function(text, pattern, loc) {\n  if (pattern.length > this.Match_MaxBits) {\n    throw new Error('Pattern too long for this browser.');\n  }\n\n  // Initialise the alphabet.\n  var s = this.match_alphabet_(pattern);\n\n  var dmp = this;  // 'this' becomes 'window' in a closure.\n\n  /**\n   * Compute and return the score for a match with e errors and x location.\n   * Accesses loc and pattern through being a closure.\n   * @param {number} e Number of errors in match.\n   * @param {number} x Location of match.\n   * @return {number} Overall score for match (0.0 = good, 1.0 = bad).\n   * @private\n   */\n  function match_bitapScore_(e, x) {\n    var accuracy = e / pattern.length;\n    var proximity = Math.abs(loc - x);\n    if (!dmp.Match_Distance) {\n      // Dodge divide by zero error.\n      return proximity ? 1.0 : accuracy;\n    }\n    return accuracy + (proximity / dmp.Match_Distance);\n  }\n\n  // Highest score beyond which we give up.\n  var score_threshold = this.Match_Threshold;\n  // Is there a nearby exact match? (speedup)\n  var best_loc = text.indexOf(pattern, loc);\n  if (best_loc != -1) {\n    score_threshold = Math.min(match_bitapScore_(0, best_loc), score_threshold);\n    // What about in the other direction? (speedup)\n    best_loc = text.lastIndexOf(pattern, loc + pattern.length);\n    if (best_loc != -1) {\n      score_threshold =\n          Math.min(match_bitapScore_(0, best_loc), score_threshold);\n    }\n  }\n\n  // Initialise the bit arrays.\n  var matchmask = 1 << (pattern.length - 1);\n  best_loc = -1;\n\n  var bin_min, bin_mid;\n  var bin_max = pattern.length + text.length;\n  var last_rd;\n  for (var d = 0; d < pattern.length; d++) {\n    // Scan for the best match; each iteration allows for one more error.\n    // Run a binary search to determine how far from 'loc' we can stray at this\n    // error level.\n    bin_min = 0;\n    bin_mid = bin_max;\n    while (bin_min < bin_mid) {\n      if (match_bitapScore_(d, loc + bin_mid) <= score_threshold) {\n        bin_min = bin_mid;\n      } else {\n        bin_max = bin_mid;\n      }\n      bin_mid = Math.floor((bin_max - bin_min) / 2 + bin_min);\n    }\n    // Use the result from this iteration as the maximum for the next.\n    bin_max = bin_mid;\n    var start = Math.max(1, loc - bin_mid + 1);\n    var finish = Math.min(loc + bin_mid, text.length) + pattern.length;\n\n    var rd = Array(finish + 2);\n    rd[finish + 1] = (1 << d) - 1;\n    for (var j = finish; j >= start; j--) {\n      // The alphabet (s) is a sparse hash, so the following line generates\n      // warnings.\n      var charMatch = s[text.charAt(j - 1)];\n      if (d === 0) {  // First pass: exact match.\n        rd[j] = ((rd[j + 1] << 1) | 1) & charMatch;\n      } else {  // Subsequent passes: fuzzy match.\n        rd[j] = ((rd[j + 1] << 1) | 1) & charMatch |\n                (((last_rd[j + 1] | last_rd[j]) << 1) | 1) |\n                last_rd[j + 1];\n      }\n      if (rd[j] & matchmask) {\n        var score = match_bitapScore_(d, j - 1);\n        // This match will almost certainly be better than any existing match.\n        // But check anyway.\n        if (score <= score_threshold) {\n          // Told you so.\n          score_threshold = score;\n          best_loc = j - 1;\n          if (best_loc > loc) {\n            // When passing loc, don't exceed our current distance from loc.\n            start = Math.max(1, 2 * loc - best_loc);\n          } else {\n            // Already passed loc, downhill from here on in.\n            break;\n          }\n        }\n      }\n    }\n    // No hope for a (better) match at greater error levels.\n    if (match_bitapScore_(d + 1, loc) > score_threshold) {\n      break;\n    }\n    last_rd = rd;\n  }\n  return best_loc;\n};\n\n\n/**\n * Initialise the alphabet for the Bitap algorithm.\n * @param {string} pattern The text to encode.\n * @return {!Object} Hash of character locations.\n * @private\n */\ndiff_match_patch.prototype.match_alphabet_ = function(pattern) {\n  var s = {};\n  for (var i = 0; i < pattern.length; i++) {\n    s[pattern.charAt(i)] = 0;\n  }\n  for (var i = 0; i < pattern.length; i++) {\n    s[pattern.charAt(i)] |= 1 << (pattern.length - i - 1);\n  }\n  return s;\n};\n\n\n//  PATCH FUNCTIONS\n\n\n/**\n * Increase the context until it is unique,\n * but don't let the pattern expand beyond Match_MaxBits.\n * @param {!diff_match_patch.patch_obj} patch The patch to grow.\n * @param {string} text Source text.\n * @private\n */\ndiff_match_patch.prototype.patch_addContext_ = function(patch, text) {\n  if (text.length == 0) {\n    return;\n  }\n  var pattern = text.substring(patch.start2, patch.start2 + patch.length1);\n  var padding = 0;\n\n  // Look for the first and last matches of pattern in text.  If two different\n  // matches are found, increase the pattern length.\n  while (text.indexOf(pattern) != text.lastIndexOf(pattern) &&\n         pattern.length < this.Match_MaxBits - this.Patch_Margin -\n         this.Patch_Margin) {\n    padding += this.Patch_Margin;\n    pattern = text.substring(patch.start2 - padding,\n                             patch.start2 + patch.length1 + padding);\n  }\n  // Add one chunk for good luck.\n  padding += this.Patch_Margin;\n\n  // Add the prefix.\n  var prefix = text.substring(patch.start2 - padding, patch.start2);\n  if (prefix) {\n    patch.diffs.unshift([DIFF_EQUAL, prefix]);\n  }\n  // Add the suffix.\n  var suffix = text.substring(patch.start2 + patch.length1,\n                              patch.start2 + patch.length1 + padding);\n  if (suffix) {\n    patch.diffs.push([DIFF_EQUAL, suffix]);\n  }\n\n  // Roll back the start points.\n  patch.start1 -= prefix.length;\n  patch.start2 -= prefix.length;\n  // Extend the lengths.\n  patch.length1 += prefix.length + suffix.length;\n  patch.length2 += prefix.length + suffix.length;\n};\n\n\n/**\n * Compute a list of patches to turn text1 into text2.\n * Use diffs if provided, otherwise compute it ourselves.\n * There are four ways to call this function, depending on what data is\n * available to the caller:\n * Method 1:\n * a = text1, b = text2\n * Method 2:\n * a = diffs\n * Method 3 (optimal):\n * a = text1, b = diffs\n * Method 4 (deprecated, use method 3):\n * a = text1, b = text2, c = diffs\n *\n * @param {string|!Array.<!diff_match_patch.Diff>} a text1 (methods 1,3,4) or\n * Array of diff tuples for text1 to text2 (method 2).\n * @param {string|!Array.<!diff_match_patch.Diff>} opt_b text2 (methods 1,4) or\n * Array of diff tuples for text1 to text2 (method 3) or undefined (method 2).\n * @param {string|!Array.<!diff_match_patch.Diff>} opt_c Array of diff tuples\n * for text1 to text2 (method 4) or undefined (methods 1,2,3).\n * @return {!Array.<!diff_match_patch.patch_obj>} Array of patch objects.\n */\ndiff_match_patch.prototype.patch_make = function(a, opt_b, opt_c) {\n  var text1, diffs;\n  if (typeof a == 'string' && typeof opt_b == 'string' &&\n      typeof opt_c == 'undefined') {\n    // Method 1: text1, text2\n    // Compute diffs from text1 and text2.\n    text1 = /** @type {string} */(a);\n    diffs = this.diff_main(text1, /** @type {string} */(opt_b), true);\n    if (diffs.length > 2) {\n      this.diff_cleanupSemantic(diffs);\n      this.diff_cleanupEfficiency(diffs);\n    }\n  } else if (a && typeof a == 'object' && typeof opt_b == 'undefined' &&\n      typeof opt_c == 'undefined') {\n    // Method 2: diffs\n    // Compute text1 from diffs.\n    diffs = /** @type {!Array.<!diff_match_patch.Diff>} */(a);\n    text1 = this.diff_text1(diffs);\n  } else if (typeof a == 'string' && opt_b && typeof opt_b == 'object' &&\n      typeof opt_c == 'undefined') {\n    // Method 3: text1, diffs\n    text1 = /** @type {string} */(a);\n    diffs = /** @type {!Array.<!diff_match_patch.Diff>} */(opt_b);\n  } else if (typeof a == 'string' && typeof opt_b == 'string' &&\n      opt_c && typeof opt_c == 'object') {\n    // Method 4: text1, text2, diffs\n    // text2 is not used.\n    text1 = /** @type {string} */(a);\n    diffs = /** @type {!Array.<!diff_match_patch.Diff>} */(opt_c);\n  } else {\n    throw new Error('Unknown call format to patch_make.');\n  }\n\n  if (diffs.length === 0) {\n    return [];  // Get rid of the null case.\n  }\n  var patches = [];\n  var patch = new diff_match_patch.patch_obj();\n  var patchDiffLength = 0;  // Keeping our own length var is faster in JS.\n  var char_count1 = 0;  // Number of characters into the text1 string.\n  var char_count2 = 0;  // Number of characters into the text2 string.\n  // Start with text1 (prepatch_text) and apply the diffs until we arrive at\n  // text2 (postpatch_text).  We recreate the patches one by one to determine\n  // context info.\n  var prepatch_text = text1;\n  var postpatch_text = text1;\n  for (var x = 0; x < diffs.length; x++) {\n    var diff_type = diffs[x][0];\n    var diff_text = diffs[x][1];\n\n    if (!patchDiffLength && diff_type !== DIFF_EQUAL) {\n      // A new patch starts here.\n      patch.start1 = char_count1;\n      patch.start2 = char_count2;\n    }\n\n    switch (diff_type) {\n      case DIFF_INSERT:\n        patch.diffs[patchDiffLength++] = diffs[x];\n        patch.length2 += diff_text.length;\n        postpatch_text = postpatch_text.substring(0, char_count2) + diff_text +\n                         postpatch_text.substring(char_count2);\n        break;\n      case DIFF_DELETE:\n        patch.length1 += diff_text.length;\n        patch.diffs[patchDiffLength++] = diffs[x];\n        postpatch_text = postpatch_text.substring(0, char_count2) +\n                         postpatch_text.substring(char_count2 +\n                             diff_text.length);\n        break;\n      case DIFF_EQUAL:\n        if (diff_text.length <= 2 * this.Patch_Margin &&\n            patchDiffLength && diffs.length != x + 1) {\n          // Small equality inside a patch.\n          patch.diffs[patchDiffLength++] = diffs[x];\n          patch.length1 += diff_text.length;\n          patch.length2 += diff_text.length;\n        } else if (diff_text.length >= 2 * this.Patch_Margin) {\n          // Time for a new patch.\n          if (patchDiffLength) {\n            this.patch_addContext_(patch, prepatch_text);\n            patches.push(patch);\n            patch = new diff_match_patch.patch_obj();\n            patchDiffLength = 0;\n            // Unlike Unidiff, our patch lists have a rolling context.\n            // http://code.google.com/p/google-diff-match-patch/wiki/Unidiff\n            // Update prepatch text & pos to reflect the application of the\n            // just completed patch.\n            prepatch_text = postpatch_text;\n            char_count1 = char_count2;\n          }\n        }\n        break;\n    }\n\n    // Update the current character count.\n    if (diff_type !== DIFF_INSERT) {\n      char_count1 += diff_text.length;\n    }\n    if (diff_type !== DIFF_DELETE) {\n      char_count2 += diff_text.length;\n    }\n  }\n  // Pick up the leftover patch if not empty.\n  if (patchDiffLength) {\n    this.patch_addContext_(patch, prepatch_text);\n    patches.push(patch);\n  }\n\n  return patches;\n};\n\n\n/**\n * Given an array of patches, return another array that is identical.\n * @param {!Array.<!diff_match_patch.patch_obj>} patches Array of patch objects.\n * @return {!Array.<!diff_match_patch.patch_obj>} Array of patch objects.\n */\ndiff_match_patch.prototype.patch_deepCopy = function(patches) {\n  // Making deep copies is hard in JavaScript.\n  var patchesCopy = [];\n  for (var x = 0; x < patches.length; x++) {\n    var patch = patches[x];\n    var patchCopy = new diff_match_patch.patch_obj();\n    patchCopy.diffs = [];\n    for (var y = 0; y < patch.diffs.length; y++) {\n      patchCopy.diffs[y] = patch.diffs[y].slice();\n    }\n    patchCopy.start1 = patch.start1;\n    patchCopy.start2 = patch.start2;\n    patchCopy.length1 = patch.length1;\n    patchCopy.length2 = patch.length2;\n    patchesCopy[x] = patchCopy;\n  }\n  return patchesCopy;\n};\n\n\n/**\n * Merge a set of patches onto the text.  Return a patched text, as well\n * as a list of true/false values indicating which patches were applied.\n * @param {!Array.<!diff_match_patch.patch_obj>} patches Array of patch objects.\n * @param {string} text Old text.\n * @return {!Array.<string|!Array.<boolean>>} Two element Array, containing the\n *      new text and an array of boolean values.\n */\ndiff_match_patch.prototype.patch_apply = function(patches, text) {\n  if (patches.length == 0) {\n    return [text, []];\n  }\n\n  // Deep copy the patches so that no changes are made to originals.\n  patches = this.patch_deepCopy(patches);\n\n  var nullPadding = this.patch_addPadding(patches);\n  text = nullPadding + text + nullPadding;\n\n  this.patch_splitMax(patches);\n  // delta keeps track of the offset between the expected and actual location\n  // of the previous patch.  If there are patches expected at positions 10 and\n  // 20, but the first patch was found at 12, delta is 2 and the second patch\n  // has an effective expected position of 22.\n  var delta = 0;\n  var results = [];\n  for (var x = 0; x < patches.length; x++) {\n    var expected_loc = patches[x].start2 + delta;\n    var text1 = this.diff_text1(patches[x].diffs);\n    var start_loc;\n    var end_loc = -1;\n    if (text1.length > this.Match_MaxBits) {\n      // patch_splitMax will only provide an oversized pattern in the case of\n      // a monster delete.\n      start_loc = this.match_main(text, text1.substring(0, this.Match_MaxBits),\n                                  expected_loc);\n      if (start_loc != -1) {\n        end_loc = this.match_main(text,\n            text1.substring(text1.length - this.Match_MaxBits),\n            expected_loc + text1.length - this.Match_MaxBits);\n        if (end_loc == -1 || start_loc >= end_loc) {\n          // Can't find valid trailing context.  Drop this patch.\n          start_loc = -1;\n        }\n      }\n    } else {\n      start_loc = this.match_main(text, text1, expected_loc);\n    }\n    if (start_loc == -1) {\n      // No match found.  :(\n      results[x] = false;\n      // Subtract the delta for this failed patch from subsequent patches.\n      delta -= patches[x].length2 - patches[x].length1;\n    } else {\n      // Found a match.  :)\n      results[x] = true;\n      delta = start_loc - expected_loc;\n      var text2;\n      if (end_loc == -1) {\n        text2 = text.substring(start_loc, start_loc + text1.length);\n      } else {\n        text2 = text.substring(start_loc, end_loc + this.Match_MaxBits);\n      }\n      if (text1 == text2) {\n        // Perfect match, just shove the replacement text in.\n        text = text.substring(0, start_loc) +\n               this.diff_text2(patches[x].diffs) +\n               text.substring(start_loc + text1.length);\n      } else {\n        // Imperfect match.  Run a diff to get a framework of equivalent\n        // indices.\n        var diffs = this.diff_main(text1, text2, false);\n        if (text1.length > this.Match_MaxBits &&\n            this.diff_levenshtein(diffs) / text1.length >\n            this.Patch_DeleteThreshold) {\n          // The end points match, but the content is unacceptably bad.\n          results[x] = false;\n        } else {\n          this.diff_cleanupSemanticLossless(diffs);\n          var index1 = 0;\n          var index2;\n          for (var y = 0; y < patches[x].diffs.length; y++) {\n            var mod = patches[x].diffs[y];\n            if (mod[0] !== DIFF_EQUAL) {\n              index2 = this.diff_xIndex(diffs, index1);\n            }\n            if (mod[0] === DIFF_INSERT) {  // Insertion\n              text = text.substring(0, start_loc + index2) + mod[1] +\n                     text.substring(start_loc + index2);\n            } else if (mod[0] === DIFF_DELETE) {  // Deletion\n              text = text.substring(0, start_loc + index2) +\n                     text.substring(start_loc + this.diff_xIndex(diffs,\n                         index1 + mod[1].length));\n            }\n            if (mod[0] !== DIFF_DELETE) {\n              index1 += mod[1].length;\n            }\n          }\n        }\n      }\n    }\n  }\n  // Strip the padding off.\n  text = text.substring(nullPadding.length, text.length - nullPadding.length);\n  return [text, results];\n};\n\n\n/**\n * Add some padding on text start and end so that edges can match something.\n * Intended to be called only from within patch_apply.\n * @param {!Array.<!diff_match_patch.patch_obj>} patches Array of patch objects.\n * @return {string} The padding string added to each side.\n */\ndiff_match_patch.prototype.patch_addPadding = function(patches) {\n  var paddingLength = this.Patch_Margin;\n  var nullPadding = '';\n  for (var x = 1; x <= paddingLength; x++) {\n    nullPadding += String.fromCharCode(x);\n  }\n\n  // Bump all the patches forward.\n  for (var x = 0; x < patches.length; x++) {\n    patches[x].start1 += paddingLength;\n    patches[x].start2 += paddingLength;\n  }\n\n  // Add some padding on start of first diff.\n  var patch = patches[0];\n  var diffs = patch.diffs;\n  if (diffs.length == 0 || diffs[0][0] != DIFF_EQUAL) {\n    // Add nullPadding equality.\n    diffs.unshift([DIFF_EQUAL, nullPadding]);\n    patch.start1 -= paddingLength;  // Should be 0.\n    patch.start2 -= paddingLength;  // Should be 0.\n    patch.length1 += paddingLength;\n    patch.length2 += paddingLength;\n  } else if (paddingLength > diffs[0][1].length) {\n    // Grow first equality.\n    var extraLength = paddingLength - diffs[0][1].length;\n    diffs[0][1] = nullPadding.substring(diffs[0][1].length) + diffs[0][1];\n    patch.start1 -= extraLength;\n    patch.start2 -= extraLength;\n    patch.length1 += extraLength;\n    patch.length2 += extraLength;\n  }\n\n  // Add some padding on end of last diff.\n  patch = patches[patches.length - 1];\n  diffs = patch.diffs;\n  if (diffs.length == 0 || diffs[diffs.length - 1][0] != DIFF_EQUAL) {\n    // Add nullPadding equality.\n    diffs.push([DIFF_EQUAL, nullPadding]);\n    patch.length1 += paddingLength;\n    patch.length2 += paddingLength;\n  } else if (paddingLength > diffs[diffs.length - 1][1].length) {\n    // Grow last equality.\n    var extraLength = paddingLength - diffs[diffs.length - 1][1].length;\n    diffs[diffs.length - 1][1] += nullPadding.substring(0, extraLength);\n    patch.length1 += extraLength;\n    patch.length2 += extraLength;\n  }\n\n  return nullPadding;\n};\n\n\n/**\n * Look through the patches and break up any which are longer than the maximum\n * limit of the match algorithm.\n * Intended to be called only from within patch_apply.\n * @param {!Array.<!diff_match_patch.patch_obj>} patches Array of patch objects.\n */\ndiff_match_patch.prototype.patch_splitMax = function(patches) {\n  var patch_size = this.Match_MaxBits;\n  for (var x = 0; x < patches.length; x++) {\n    if (patches[x].length1 > patch_size) {\n      var bigpatch = patches[x];\n      // Remove the big old patch.\n      patches.splice(x--, 1);\n      var start1 = bigpatch.start1;\n      var start2 = bigpatch.start2;\n      var precontext = '';\n      while (bigpatch.diffs.length !== 0) {\n        // Create one of several smaller patches.\n        var patch = new diff_match_patch.patch_obj();\n        var empty = true;\n        patch.start1 = start1 - precontext.length;\n        patch.start2 = start2 - precontext.length;\n        if (precontext !== '') {\n          patch.length1 = patch.length2 = precontext.length;\n          patch.diffs.push([DIFF_EQUAL, precontext]);\n        }\n        while (bigpatch.diffs.length !== 0 &&\n               patch.length1 < patch_size - this.Patch_Margin) {\n          var diff_type = bigpatch.diffs[0][0];\n          var diff_text = bigpatch.diffs[0][1];\n          if (diff_type === DIFF_INSERT) {\n            // Insertions are harmless.\n            patch.length2 += diff_text.length;\n            start2 += diff_text.length;\n            patch.diffs.push(bigpatch.diffs.shift());\n            empty = false;\n          } else if (diff_type === DIFF_DELETE && patch.diffs.length == 1 &&\n                     patch.diffs[0][0] == DIFF_EQUAL &&\n                     diff_text.length > 2 * patch_size) {\n            // This is a large deletion.  Let it pass in one chunk.\n            patch.length1 += diff_text.length;\n            start1 += diff_text.length;\n            empty = false;\n            patch.diffs.push([diff_type, diff_text]);\n            bigpatch.diffs.shift();\n          } else {\n            // Deletion or equality.  Only take as much as we can stomach.\n            diff_text = diff_text.substring(0,\n                patch_size - patch.length1 - this.Patch_Margin);\n            patch.length1 += diff_text.length;\n            start1 += diff_text.length;\n            if (diff_type === DIFF_EQUAL) {\n              patch.length2 += diff_text.length;\n              start2 += diff_text.length;\n            } else {\n              empty = false;\n            }\n            patch.diffs.push([diff_type, diff_text]);\n            if (diff_text == bigpatch.diffs[0][1]) {\n              bigpatch.diffs.shift();\n            } else {\n              bigpatch.diffs[0][1] =\n                  bigpatch.diffs[0][1].substring(diff_text.length);\n            }\n          }\n        }\n        // Compute the head context for the next patch.\n        precontext = this.diff_text2(patch.diffs);\n        precontext =\n            precontext.substring(precontext.length - this.Patch_Margin);\n        // Append the end context for this patch.\n        var postcontext = this.diff_text1(bigpatch.diffs)\n                              .substring(0, this.Patch_Margin);\n        if (postcontext !== '') {\n          patch.length1 += postcontext.length;\n          patch.length2 += postcontext.length;\n          if (patch.diffs.length !== 0 &&\n              patch.diffs[patch.diffs.length - 1][0] === DIFF_EQUAL) {\n            patch.diffs[patch.diffs.length - 1][1] += postcontext;\n          } else {\n            patch.diffs.push([DIFF_EQUAL, postcontext]);\n          }\n        }\n        if (!empty) {\n          patches.splice(++x, 0, patch);\n        }\n      }\n    }\n  }\n};\n\n\n/**\n * Take a list of patches and return a textual representation.\n * @param {!Array.<!diff_match_patch.patch_obj>} patches Array of patch objects.\n * @return {string} Text representation of patches.\n */\ndiff_match_patch.prototype.patch_toText = function(patches) {\n  var text = [];\n  for (var x = 0; x < patches.length; x++) {\n    text[x] = patches[x];\n  }\n  return text.join('');\n};\n\n\n/**\n * Parse a textual representation of patches and return a list of patch objects.\n * @param {string} textline Text representation of patches.\n * @return {!Array.<!diff_match_patch.patch_obj>} Array of patch objects.\n * @throws {!Error} If invalid input.\n */\ndiff_match_patch.prototype.patch_fromText = function(textline) {\n  var patches = [];\n  if (!textline) {\n    return patches;\n  }\n  var text = textline.split('\\n');\n  var textPointer = 0;\n  var patchHeader = /^@@ -(\\d+),?(\\d*) \\+(\\d+),?(\\d*) @@$/;\n  while (textPointer < text.length) {\n    var m = text[textPointer].match(patchHeader);\n    if (!m) {\n      throw new Error('Invalid patch string: ' + text[textPointer]);\n    }\n    var patch = new diff_match_patch.patch_obj();\n    patches.push(patch);\n    patch.start1 = parseInt(m[1], 10);\n    if (m[2] === '') {\n      patch.start1--;\n      patch.length1 = 1;\n    } else if (m[2] == '0') {\n      patch.length1 = 0;\n    } else {\n      patch.start1--;\n      patch.length1 = parseInt(m[2], 10);\n    }\n\n    patch.start2 = parseInt(m[3], 10);\n    if (m[4] === '') {\n      patch.start2--;\n      patch.length2 = 1;\n    } else if (m[4] == '0') {\n      patch.length2 = 0;\n    } else {\n      patch.start2--;\n      patch.length2 = parseInt(m[4], 10);\n    }\n    textPointer++;\n\n    while (textPointer < text.length) {\n      var sign = text[textPointer].charAt(0);\n      try {\n        var line = decodeURI(text[textPointer].substring(1));\n      } catch (ex) {\n        // Malformed URI sequence.\n        throw new Error('Illegal escape in patch_fromText: ' + line);\n      }\n      if (sign == '-') {\n        // Deletion.\n        patch.diffs.push([DIFF_DELETE, line]);\n      } else if (sign == '+') {\n        // Insertion.\n        patch.diffs.push([DIFF_INSERT, line]);\n      } else if (sign == ' ') {\n        // Minor equality.\n        patch.diffs.push([DIFF_EQUAL, line]);\n      } else if (sign == '@') {\n        // Start of next patch.\n        break;\n      } else if (sign === '') {\n        // Blank line?  Whatever.\n      } else {\n        // WTF?\n        throw new Error('Invalid patch mode \"' + sign + '\" in: ' + line);\n      }\n      textPointer++;\n    }\n  }\n  return patches;\n};\n\n\n/**\n * Class representing one patch operation.\n * @constructor\n */\ndiff_match_patch.patch_obj = function() {\n  /** @type {!Array.<!diff_match_patch.Diff>} */\n  this.diffs = [];\n  /** @type {?number} */\n  this.start1 = null;\n  /** @type {?number} */\n  this.start2 = null;\n  /** @type {number} */\n  this.length1 = 0;\n  /** @type {number} */\n  this.length2 = 0;\n};\n\n\n/**\n * Emmulate GNU diff's format.\n * Header: @@ -382,8 +481,9 @@\n * Indicies are printed as 1-based, not 0-based.\n * @return {string} The GNU diff string.\n */\ndiff_match_patch.patch_obj.prototype.toString = function() {\n  var coords1, coords2;\n  if (this.length1 === 0) {\n    coords1 = this.start1 + ',0';\n  } else if (this.length1 == 1) {\n    coords1 = this.start1 + 1;\n  } else {\n    coords1 = (this.start1 + 1) + ',' + this.length1;\n  }\n  if (this.length2 === 0) {\n    coords2 = this.start2 + ',0';\n  } else if (this.length2 == 1) {\n    coords2 = this.start2 + 1;\n  } else {\n    coords2 = (this.start2 + 1) + ',' + this.length2;\n  }\n  var text = ['@@ -' + coords1 + ' +' + coords2 + ' @@\\n'];\n  var op;\n  // Escape the body of the patch with %xx notation.\n  for (var x = 0; x < this.diffs.length; x++) {\n    switch (this.diffs[x][0]) {\n      case DIFF_INSERT:\n        op = '+';\n        break;\n      case DIFF_DELETE:\n        op = '-';\n        break;\n      case DIFF_EQUAL:\n        op = ' ';\n        break;\n    }\n    text[x + 1] = op + encodeURI(this.diffs[x][1]) + '\\n';\n  }\n  return text.join('').replace(/%20/g, ' ');\n};\n\n\n// Export these global variables so that they survive Google's JS compiler.\n// In a browser, 'this' will be 'window'.\n// In node.js 'this' will be a global object.\nthis['diff_match_patch'] = diff_match_patch;\nthis['DIFF_DELETE'] = DIFF_DELETE;\nthis['DIFF_INSERT'] = DIFF_INSERT;\nthis['DIFF_EQUAL'] = DIFF_EQUAL;\n\n","\nvar isArray = (typeof Array.isArray === 'function') ?\n  // use native function\n  Array.isArray :\n  // use instanceof operator\n  function(a) {\n    return a instanceof Array;\n  };\n\nfunction cloneRegExp(re) {\n  var regexMatch = /^\\/(.*)\\/([gimyu]*)$/.exec(re.toString());\n  return new RegExp(regexMatch[1], regexMatch[2]);\n}\n\nfunction clone(arg) {\n  if (typeof arg !== 'object') {\n    return arg;\n  }\n  if (arg === null) {\n    return null;\n  }\n  if (isArray(arg)) {\n    return arg.map(clone);\n  }\n  if (arg instanceof Date) {\n    return new Date(arg.getTime());\n  }\n  if (arg instanceof RegExp) {\n    return cloneRegExp(arg);\n  }\n  var cloned = {};\n  for (var name in arg) {\n    if (Object.prototype.hasOwnProperty.call(arg, name)) {\n      cloned[name] = clone(arg[name]);\n    }\n  }\n  return cloned;\n}\n\nmodule.exports = clone;\n","\nvar Pipe = require('../pipe').Pipe;\n\nvar Context = function Context(){\n};\n\nContext.prototype.setResult = function(result) {\n\tthis.result = result;\n\tthis.hasResult = true;\n\treturn this;\n};\n\nContext.prototype.exit = function() {\n\tthis.exiting = true;\n\treturn this;\n};\n\nContext.prototype.switchTo = function(next, pipe) {\n\tif (typeof next === 'string' || next instanceof Pipe) {\n\t\tthis.nextPipe = next;\n\t} else {\n\t\tthis.next = next;\n\t\tif (pipe) {\n\t\t\tthis.nextPipe = pipe;\n\t\t}\n\t}\n\treturn this;\n};\n\nContext.prototype.push = function(child, name) {\n\tchild.parent = this;\n\tif (typeof name !== 'undefined') {\n\t\tchild.childName = name;\n\t}\n\tchild.root = this.root || this;\n\tchild.options = child.options || this.options;\n\tif (!this.children) {\n\t\tthis.children = [child];\n\t\tthis.nextAfterChildren = this.next || null;\n\t\tthis.next = child;\n\t} else {\n\t\tthis.children[this.children.length - 1].next = child;\n\t\tthis.children.push(child);\n\t}\n\tchild.next = this;\n\treturn this;\n};\n\nexports.Context = Context;\n","var Context = require('./context').Context;\nvar defaultClone = require('../clone');\n\nvar DiffContext = function DiffContext(left, right) {\n  this.left = left;\n  this.right = right;\n  this.pipe = 'diff';\n};\n\nDiffContext.prototype = new Context();\n\nDiffContext.prototype.setResult = function(result) {\n  if (this.options.cloneDiffValues && typeof result === 'object') {\n    var clone = typeof this.options.cloneDiffValues === 'function' ?\n      this.options.cloneDiffValues : defaultClone;\n    if (typeof result[0] === 'object') {\n      result[0] = clone(result[0]);\n    }\n    if (typeof result[1] === 'object') {\n      result[1] = clone(result[1]);\n    }\n  }\n  return Context.prototype.setResult.apply(this, arguments);\n};\n\nexports.DiffContext = DiffContext;\n","var Context = require('./context').Context;\n\nvar PatchContext = function PatchContext(left, delta) {\n  this.left = left;\n  this.delta = delta;\n  this.pipe = 'patch';\n};\n\nPatchContext.prototype = new Context();\n\nexports.PatchContext = PatchContext;\n","var Context = require('./context').Context;\n\nvar ReverseContext = function ReverseContext(delta) {\n  this.delta = delta;\n  this.pipe = 'reverse';\n};\n\nReverseContext.prototype = new Context();\n\nexports.ReverseContext = ReverseContext;\n","var Processor = require('./processor').Processor;\nvar Pipe = require('./pipe').Pipe;\nvar DiffContext = require('./contexts/diff').DiffContext;\nvar PatchContext = require('./contexts/patch').PatchContext;\nvar ReverseContext = require('./contexts/reverse').ReverseContext;\n\nvar clone = require('./clone');\n\nvar trivial = require('./filters/trivial');\nvar nested = require('./filters/nested');\nvar arrays = require('./filters/arrays');\nvar dates = require('./filters/dates');\nvar texts = require('./filters/texts');\n\nvar DiffPatcher = function DiffPatcher(options) {\n  this.processor = new Processor(options);\n  this.processor.pipe(new Pipe('diff').append(\n    nested.collectChildrenDiffFilter,\n    trivial.diffFilter,\n    dates.diffFilter,\n    texts.diffFilter,\n    nested.objectsDiffFilter,\n    arrays.diffFilter\n  ).shouldHaveResult());\n  this.processor.pipe(new Pipe('patch').append(\n    nested.collectChildrenPatchFilter,\n    arrays.collectChildrenPatchFilter,\n    trivial.patchFilter,\n    texts.patchFilter,\n    nested.patchFilter,\n    arrays.patchFilter\n  ).shouldHaveResult());\n  this.processor.pipe(new Pipe('reverse').append(\n    nested.collectChildrenReverseFilter,\n    arrays.collectChildrenReverseFilter,\n    trivial.reverseFilter,\n    texts.reverseFilter,\n    nested.reverseFilter,\n    arrays.reverseFilter\n  ).shouldHaveResult());\n};\n\nDiffPatcher.prototype.options = function() {\n  return this.processor.options.apply(this.processor, arguments);\n};\n\nDiffPatcher.prototype.diff = function(left, right) {\n  return this.processor.process(new DiffContext(left, right));\n};\n\nDiffPatcher.prototype.patch = function(left, delta) {\n  return this.processor.process(new PatchContext(left, delta));\n};\n\nDiffPatcher.prototype.reverse = function(delta) {\n  return this.processor.process(new ReverseContext(delta));\n};\n\nDiffPatcher.prototype.unpatch = function(right, delta) {\n  return this.patch(right, this.reverse(delta));\n};\n\nDiffPatcher.prototype.clone = function(value) {\n  return clone(value);\n};\n\nexports.DiffPatcher = DiffPatcher;\n","var DiffContext = require('../contexts/diff').DiffContext;\nvar PatchContext = require('../contexts/patch').PatchContext;\nvar ReverseContext = require('../contexts/reverse').ReverseContext;\n\nvar lcs = require('./lcs');\n\nvar ARRAY_MOVE = 3;\n\nvar isArray = (typeof Array.isArray === 'function') ?\n  // use native function\n  Array.isArray :\n  // use instanceof operator\n  function(a) {\n    return a instanceof Array;\n  };\n\nvar arrayIndexOf = typeof Array.prototype.indexOf === 'function' ?\n  function(array, item) {\n    return array.indexOf(item);\n  } : function(array, item) {\n    var length = array.length;\n    for (var i = 0; i < length; i++) {\n      if (array[i] === item) {\n        return i;\n      }\n    }\n    return -1;\n  };\n\nfunction arraysHaveMatchByRef(array1, array2, len1, len2) {\n  for (var index1 = 0; index1 < len1; index1++) {\n    var val1 = array1[index1];\n    for (var index2 = 0; index2 < len2; index2++) {\n      var val2 = array2[index2];\n      if (index1 !== index2 && val1 === val2) {\n        return true;\n      }\n    }\n  }\n}\n\nfunction matchItems(array1, array2, index1, index2, context) {\n  var value1 = array1[index1];\n  var value2 = array2[index2];\n  if (value1 === value2) {\n    return true;\n  }\n  if (typeof value1 !== 'object' || typeof value2 !== 'object') {\n    return false;\n  }\n  var objectHash = context.objectHash;\n  if (!objectHash) {\n    // no way to match objects was provided, try match by position\n    return context.matchByPosition && index1 === index2;\n  }\n  var hash1;\n  var hash2;\n  if (typeof index1 === 'number') {\n    context.hashCache1 = context.hashCache1 || [];\n    hash1 = context.hashCache1[index1];\n    if (typeof hash1 === 'undefined') {\n      context.hashCache1[index1] = hash1 = objectHash(value1, index1);\n    }\n  } else {\n    hash1 = objectHash(value1);\n  }\n  if (typeof hash1 === 'undefined') {\n    return false;\n  }\n  if (typeof index2 === 'number') {\n    context.hashCache2 = context.hashCache2 || [];\n    hash2 = context.hashCache2[index2];\n    if (typeof hash2 === 'undefined') {\n      context.hashCache2[index2] = hash2 = objectHash(value2, index2);\n    }\n  } else {\n    hash2 = objectHash(value2);\n  }\n  if (typeof hash2 === 'undefined') {\n    return false;\n  }\n  return hash1 === hash2;\n}\n\nvar diffFilter = function arraysDiffFilter(context) {\n  if (!context.leftIsArray) {\n    return;\n  }\n\n  var matchContext = {\n    objectHash: context.options && context.options.objectHash,\n    matchByPosition: context.options && context.options.matchByPosition\n  };\n  var commonHead = 0;\n  var commonTail = 0;\n  var index;\n  var index1;\n  var index2;\n  var array1 = context.left;\n  var array2 = context.right;\n  var len1 = array1.length;\n  var len2 = array2.length;\n\n  var child;\n\n  if (len1 > 0 && len2 > 0 && !matchContext.objectHash &&\n    typeof matchContext.matchByPosition !== 'boolean') {\n    matchContext.matchByPosition = !arraysHaveMatchByRef(array1, array2, len1, len2);\n  }\n\n  // separate common head\n  while (commonHead < len1 && commonHead < len2 &&\n    matchItems(array1, array2, commonHead, commonHead, matchContext)) {\n    index = commonHead;\n    child = new DiffContext(context.left[index], context.right[index]);\n    context.push(child, index);\n    commonHead++;\n  }\n  // separate common tail\n  while (commonTail + commonHead < len1 && commonTail + commonHead < len2 &&\n    matchItems(array1, array2, len1 - 1 - commonTail, len2 - 1 - commonTail, matchContext)) {\n    index1 = len1 - 1 - commonTail;\n    index2 = len2 - 1 - commonTail;\n    child = new DiffContext(context.left[index1], context.right[index2]);\n    context.push(child, index2);\n    commonTail++;\n  }\n  var result;\n  if (commonHead + commonTail === len1) {\n    if (len1 === len2) {\n      // arrays are identical\n      context.setResult(undefined).exit();\n      return;\n    }\n    // trivial case, a block (1 or more consecutive items) was added\n    result = result || {\n      _t: 'a'\n    };\n    for (index = commonHead; index < len2 - commonTail; index++) {\n      result[index] = [array2[index]];\n    }\n    context.setResult(result).exit();\n    return;\n  }\n  if (commonHead + commonTail === len2) {\n    // trivial case, a block (1 or more consecutive items) was removed\n    result = result || {\n      _t: 'a'\n    };\n    for (index = commonHead; index < len1 - commonTail; index++) {\n      result['_' + index] = [array1[index], 0, 0];\n    }\n    context.setResult(result).exit();\n    return;\n  }\n  // reset hash cache\n  delete matchContext.hashCache1;\n  delete matchContext.hashCache2;\n\n  // diff is not trivial, find the LCS (Longest Common Subsequence)\n  var trimmed1 = array1.slice(commonHead, len1 - commonTail);\n  var trimmed2 = array2.slice(commonHead, len2 - commonTail);\n  var seq = lcs.get(\n    trimmed1, trimmed2,\n    matchItems,\n    matchContext\n  );\n  var removedItems = [];\n  result = result || {\n    _t: 'a'\n  };\n  for (index = commonHead; index < len1 - commonTail; index++) {\n    if (arrayIndexOf(seq.indices1, index - commonHead) < 0) {\n      // removed\n      result['_' + index] = [array1[index], 0, 0];\n      removedItems.push(index);\n    }\n  }\n\n  var detectMove = true;\n  if (context.options && context.options.arrays && context.options.arrays.detectMove === false) {\n    detectMove = false;\n  }\n  var includeValueOnMove = false;\n  if (context.options && context.options.arrays && context.options.arrays.includeValueOnMove) {\n    includeValueOnMove = true;\n  }\n\n  var removedItemsLength = removedItems.length;\n  for (index = commonHead; index < len2 - commonTail; index++) {\n    var indexOnArray2 = arrayIndexOf(seq.indices2, index - commonHead);\n    if (indexOnArray2 < 0) {\n      // added, try to match with a removed item and register as position move\n      var isMove = false;\n      if (detectMove && removedItemsLength > 0) {\n        for (var removeItemIndex1 = 0; removeItemIndex1 < removedItemsLength; removeItemIndex1++) {\n          index1 = removedItems[removeItemIndex1];\n          if (matchItems(trimmed1, trimmed2, index1 - commonHead,\n            index - commonHead, matchContext)) {\n            // store position move as: [originalValue, newPosition, ARRAY_MOVE]\n            result['_' + index1].splice(1, 2, index, ARRAY_MOVE);\n            if (!includeValueOnMove) {\n              // don't include moved value on diff, to save bytes\n              result['_' + index1][0] = '';\n            }\n\n            index2 = index;\n            child = new DiffContext(context.left[index1], context.right[index2]);\n            context.push(child, index2);\n            removedItems.splice(removeItemIndex1, 1);\n            isMove = true;\n            break;\n          }\n        }\n      }\n      if (!isMove) {\n        // added\n        result[index] = [array2[index]];\n      }\n    } else {\n      // match, do inner diff\n      index1 = seq.indices1[indexOnArray2] + commonHead;\n      index2 = seq.indices2[indexOnArray2] + commonHead;\n      child = new DiffContext(context.left[index1], context.right[index2]);\n      context.push(child, index2);\n    }\n  }\n\n  context.setResult(result).exit();\n\n};\ndiffFilter.filterName = 'arrays';\n\nvar compare = {\n  numerically: function(a, b) {\n    return a - b;\n  },\n  numericallyBy: function(name) {\n    return function(a, b) {\n      return a[name] - b[name];\n    };\n  }\n};\n\nvar patchFilter = function nestedPatchFilter(context) {\n  if (!context.nested) {\n    return;\n  }\n  if (context.delta._t !== 'a') {\n    return;\n  }\n  var index, index1;\n\n  var delta = context.delta;\n  var array = context.left;\n\n  // first, separate removals, insertions and modifications\n  var toRemove = [];\n  var toInsert = [];\n  var toModify = [];\n  for (index in delta) {\n    if (index !== '_t') {\n      if (index[0] === '_') {\n        // removed item from original array\n        if (delta[index][2] === 0 || delta[index][2] === ARRAY_MOVE) {\n          toRemove.push(parseInt(index.slice(1), 10));\n        } else {\n          throw new Error('only removal or move can be applied at original array indices' +\n            ', invalid diff type: ' + delta[index][2]);\n        }\n      } else {\n        if (delta[index].length === 1) {\n          // added item at new array\n          toInsert.push({\n            index: parseInt(index, 10),\n            value: delta[index][0]\n          });\n        } else {\n          // modified item at new array\n          toModify.push({\n            index: parseInt(index, 10),\n            delta: delta[index]\n          });\n        }\n      }\n    }\n  }\n\n  // remove items, in reverse order to avoid sawing our own floor\n  toRemove = toRemove.sort(compare.numerically);\n  for (index = toRemove.length - 1; index >= 0; index--) {\n    index1 = toRemove[index];\n    var indexDiff = delta['_' + index1];\n    var removedValue = array.splice(index1, 1)[0];\n    if (indexDiff[2] === ARRAY_MOVE) {\n      // reinsert later\n      toInsert.push({\n        index: indexDiff[1],\n        value: removedValue\n      });\n    }\n  }\n\n  // insert items, in reverse order to avoid moving our own floor\n  toInsert = toInsert.sort(compare.numericallyBy('index'));\n  var toInsertLength = toInsert.length;\n  for (index = 0; index < toInsertLength; index++) {\n    var insertion = toInsert[index];\n    array.splice(insertion.index, 0, insertion.value);\n  }\n\n  // apply modifications\n  var toModifyLength = toModify.length;\n  var child;\n  if (toModifyLength > 0) {\n    for (index = 0; index < toModifyLength; index++) {\n      var modification = toModify[index];\n      child = new PatchContext(context.left[modification.index], modification.delta);\n      context.push(child, modification.index);\n    }\n  }\n\n  if (!context.children) {\n    context.setResult(context.left).exit();\n    return;\n  }\n  context.exit();\n};\npatchFilter.filterName = 'arrays';\n\nvar collectChildrenPatchFilter = function collectChildrenPatchFilter(context) {\n  if (!context || !context.children) {\n    return;\n  }\n  if (context.delta._t !== 'a') {\n    return;\n  }\n  var length = context.children.length;\n  var child;\n  for (var index = 0; index < length; index++) {\n    child = context.children[index];\n    context.left[child.childName] = child.result;\n  }\n  context.setResult(context.left).exit();\n};\ncollectChildrenPatchFilter.filterName = 'arraysCollectChildren';\n\nvar reverseFilter = function arraysReverseFilter(context) {\n  if (!context.nested) {\n    if (context.delta[2] === ARRAY_MOVE) {\n      context.newName = '_' + context.delta[1];\n      context.setResult([context.delta[0], parseInt(context.childName.substr(1), 10), ARRAY_MOVE]).exit();\n    }\n    return;\n  }\n  if (context.delta._t !== 'a') {\n    return;\n  }\n  var name, child;\n  for (name in context.delta) {\n    if (name === '_t') {\n      continue;\n    }\n    child = new ReverseContext(context.delta[name]);\n    context.push(child, name);\n  }\n  context.exit();\n};\nreverseFilter.filterName = 'arrays';\n\nvar reverseArrayDeltaIndex = function(delta, index, itemDelta) {\n  if (typeof index === 'string' && index[0] === '_') {\n    return parseInt(index.substr(1), 10);\n  } else if (isArray(itemDelta) && itemDelta[2] === 0) {\n    return '_' + index;\n  }\n\n  var reverseIndex = +index;\n  for (var deltaIndex in delta) {\n    var deltaItem = delta[deltaIndex];\n    if (isArray(deltaItem)) {\n      if (deltaItem[2] === ARRAY_MOVE) {\n        var moveFromIndex = parseInt(deltaIndex.substr(1), 10);\n        var moveToIndex = deltaItem[1];\n        if (moveToIndex === +index) {\n          return moveFromIndex;\n        }\n        if (moveFromIndex <= reverseIndex && moveToIndex > reverseIndex) {\n          reverseIndex++;\n        } else if (moveFromIndex >= reverseIndex && moveToIndex < reverseIndex) {\n          reverseIndex--;\n        }\n      } else if (deltaItem[2] === 0) {\n        var deleteIndex = parseInt(deltaIndex.substr(1), 10);\n        if (deleteIndex <= reverseIndex) {\n          reverseIndex++;\n        }\n      } else if (deltaItem.length === 1 && deltaIndex <= reverseIndex) {\n        reverseIndex--;\n      }\n    }\n  }\n\n  return reverseIndex;\n};\n\nvar collectChildrenReverseFilter = function collectChildrenReverseFilter(context) {\n  if (!context || !context.children) {\n    return;\n  }\n  if (context.delta._t !== 'a') {\n    return;\n  }\n  var length = context.children.length;\n  var child;\n  var delta = {\n    _t: 'a'\n  };\n\n  for (var index = 0; index < length; index++) {\n    child = context.children[index];\n    var name = child.newName;\n    if (typeof name === 'undefined') {\n      name = reverseArrayDeltaIndex(context.delta, child.childName, child.result);\n    }\n    if (delta[name] !== child.result) {\n      delta[name] = child.result;\n    }\n  }\n  context.setResult(delta).exit();\n};\ncollectChildrenReverseFilter.filterName = 'arraysCollectChildren';\n\nexports.diffFilter = diffFilter;\nexports.patchFilter = patchFilter;\nexports.collectChildrenPatchFilter = collectChildrenPatchFilter;\nexports.reverseFilter = reverseFilter;\nexports.collectChildrenReverseFilter = collectChildrenReverseFilter;\n","var diffFilter = function datesDiffFilter(context) {\n  if (context.left instanceof Date) {\n    if (context.right instanceof Date) {\n      if (context.left.getTime() !== context.right.getTime()) {\n        context.setResult([context.left, context.right]);\n      } else {\n        context.setResult(undefined);\n      }\n    } else {\n      context.setResult([context.left, context.right]);\n    }\n    context.exit();\n  } else if (context.right instanceof Date) {\n    context.setResult([context.left, context.right]).exit();\n  }\n};\ndiffFilter.filterName = 'dates';\n\nexports.diffFilter = diffFilter;\n","/*\n\nLCS implementation that supports arrays or strings\n\nreference: http://en.wikipedia.org/wiki/Longest_common_subsequence_problem\n\n*/\n\nvar defaultMatch = function(array1, array2, index1, index2) {\n  return array1[index1] === array2[index2];\n};\n\nvar lengthMatrix = function(array1, array2, match, context) {\n  var len1 = array1.length;\n  var len2 = array2.length;\n  var x, y;\n\n  // initialize empty matrix of len1+1 x len2+1\n  var matrix = [len1 + 1];\n  for (x = 0; x < len1 + 1; x++) {\n    matrix[x] = [len2 + 1];\n    for (y = 0; y < len2 + 1; y++) {\n      matrix[x][y] = 0;\n    }\n  }\n  matrix.match = match;\n  // save sequence lengths for each coordinate\n  for (x = 1; x < len1 + 1; x++) {\n    for (y = 1; y < len2 + 1; y++) {\n      if (match(array1, array2, x - 1, y - 1, context)) {\n        matrix[x][y] = matrix[x - 1][y - 1] + 1;\n      } else {\n        matrix[x][y] = Math.max(matrix[x - 1][y], matrix[x][y - 1]);\n      }\n    }\n  }\n  return matrix;\n};\n\nvar backtrack = function(matrix, array1, array2, index1, index2, context) {\n  if (index1 === 0 || index2 === 0) {\n    return {\n      sequence: [],\n      indices1: [],\n      indices2: []\n    };\n  }\n\n  if (matrix.match(array1, array2, index1 - 1, index2 - 1, context)) {\n    var subsequence = backtrack(matrix, array1, array2, index1 - 1, index2 - 1, context);\n    subsequence.sequence.push(array1[index1 - 1]);\n    subsequence.indices1.push(index1 - 1);\n    subsequence.indices2.push(index2 - 1);\n    return subsequence;\n  }\n\n  if (matrix[index1][index2 - 1] > matrix[index1 - 1][index2]) {\n    return backtrack(matrix, array1, array2, index1, index2 - 1, context);\n  } else {\n    return backtrack(matrix, array1, array2, index1 - 1, index2, context);\n  }\n};\n\nvar get = function(array1, array2, match, context) {\n  context = context || {};\n  var matrix = lengthMatrix(array1, array2, match || defaultMatch, context);\n  var result = backtrack(matrix, array1, array2, array1.length, array2.length, context);\n  if (typeof array1 === 'string' && typeof array2 === 'string') {\n    result.sequence = result.sequence.join('');\n  }\n  return result;\n};\n\nexports.get = get;\n","var DiffContext = require('../contexts/diff').DiffContext;\nvar PatchContext = require('../contexts/patch').PatchContext;\nvar ReverseContext = require('../contexts/reverse').ReverseContext;\n\nvar collectChildrenDiffFilter = function collectChildrenDiffFilter(context) {\n  if (!context || !context.children) {\n    return;\n  }\n  var length = context.children.length;\n  var child;\n  var result = context.result;\n  for (var index = 0; index < length; index++) {\n    child = context.children[index];\n    if (typeof child.result === 'undefined') {\n      continue;\n    }\n    result = result || {};\n    result[child.childName] = child.result;\n  }\n  if (result && context.leftIsArray) {\n    result._t = 'a';\n  }\n  context.setResult(result).exit();\n};\ncollectChildrenDiffFilter.filterName = 'collectChildren';\n\nvar objectsDiffFilter = function objectsDiffFilter(context) {\n  if (context.leftIsArray || context.leftType !== 'object') {\n    return;\n  }\n\n  var name, child, propertyFilter = context.options.propertyFilter;\n  for (name in context.left) {\n    if (!Object.prototype.hasOwnProperty.call(context.left, name)) {\n      continue;\n    }\n    if (propertyFilter && !propertyFilter(name, context)) {\n      continue;\n    }\n    child = new DiffContext(context.left[name], context.right[name]);\n    context.push(child, name);\n  }\n  for (name in context.right) {\n    if (!Object.prototype.hasOwnProperty.call(context.right, name)) {\n      continue;\n    }\n    if (propertyFilter && !propertyFilter(name, context)) {\n      continue;\n    }\n    if (typeof context.left[name] === 'undefined') {\n      child = new DiffContext(undefined, context.right[name]);\n      context.push(child, name);\n    }\n  }\n\n  if (!context.children || context.children.length === 0) {\n    context.setResult(undefined).exit();\n    return;\n  }\n  context.exit();\n};\nobjectsDiffFilter.filterName = 'objects';\n\nvar patchFilter = function nestedPatchFilter(context) {\n  if (!context.nested) {\n    return;\n  }\n  if (context.delta._t) {\n    return;\n  }\n  var name, child;\n  for (name in context.delta) {\n    child = new PatchContext(context.left[name], context.delta[name]);\n    context.push(child, name);\n  }\n  context.exit();\n};\npatchFilter.filterName = 'objects';\n\nvar collectChildrenPatchFilter = function collectChildrenPatchFilter(context) {\n  if (!context || !context.children) {\n    return;\n  }\n  if (context.delta._t) {\n    return;\n  }\n  var length = context.children.length;\n  var child;\n  for (var index = 0; index < length; index++) {\n    child = context.children[index];\n    if (Object.prototype.hasOwnProperty.call(context.left, child.childName) && child.result === undefined) {\n      delete context.left[child.childName];\n    } else if (context.left[child.childName] !== child.result) {\n      context.left[child.childName] = child.result;\n    }\n  }\n  context.setResult(context.left).exit();\n};\ncollectChildrenPatchFilter.filterName = 'collectChildren';\n\nvar reverseFilter = function nestedReverseFilter(context) {\n  if (!context.nested) {\n    return;\n  }\n  if (context.delta._t) {\n    return;\n  }\n  var name, child;\n  for (name in context.delta) {\n    child = new ReverseContext(context.delta[name]);\n    context.push(child, name);\n  }\n  context.exit();\n};\nreverseFilter.filterName = 'objects';\n\nvar collectChildrenReverseFilter = function collectChildrenReverseFilter(context) {\n  if (!context || !context.children) {\n    return;\n  }\n  if (context.delta._t) {\n    return;\n  }\n  var length = context.children.length;\n  var child;\n  var delta = {};\n  for (var index = 0; index < length; index++) {\n    child = context.children[index];\n    if (delta[child.childName] !== child.result) {\n      delta[child.childName] = child.result;\n    }\n  }\n  context.setResult(delta).exit();\n};\ncollectChildrenReverseFilter.filterName = 'collectChildren';\n\nexports.collectChildrenDiffFilter = collectChildrenDiffFilter;\nexports.objectsDiffFilter = objectsDiffFilter;\nexports.patchFilter = patchFilter;\nexports.collectChildrenPatchFilter = collectChildrenPatchFilter;\nexports.reverseFilter = reverseFilter;\nexports.collectChildrenReverseFilter = collectChildrenReverseFilter;\n","/* global diff_match_patch */\nvar TEXT_DIFF = 2;\nvar DEFAULT_MIN_LENGTH = 60;\nvar cachedDiffPatch = null;\n\nvar getDiffMatchPatch = function(required) {\n  /*jshint camelcase: false */\n\n  if (!cachedDiffPatch) {\n    var instance;\n    if (typeof diff_match_patch !== 'undefined') {\n      // already loaded, probably a browser\n      instance = typeof diff_match_patch === 'function' ?\n        new diff_match_patch() : new diff_match_patch.diff_match_patch();\n    } else if (typeof require === 'function') {\n      try {\n        var dmpModuleName = 'diff_match_patch_uncompressed';\n        var dmp = require('../../public/external/' + dmpModuleName);\n        instance = new dmp.diff_match_patch();\n      } catch (err) {\n        instance = null;\n      }\n    }\n    if (!instance) {\n      if (!required) {\n        return null;\n      }\n      var error = new Error('text diff_match_patch library not found');\n      error.diff_match_patch_not_found = true;\n      throw error;\n    }\n    cachedDiffPatch = {\n      diff: function(txt1, txt2) {\n        return instance.patch_toText(instance.patch_make(txt1, txt2));\n      },\n      patch: function(txt1, patch) {\n        var results = instance.patch_apply(instance.patch_fromText(patch), txt1);\n        for (var i = 0; i < results[1].length; i++) {\n          if (!results[1][i]) {\n            var error = new Error('text patch failed');\n            error.textPatchFailed = true;\n          }\n        }\n        return results[0];\n      }\n    };\n  }\n  return cachedDiffPatch;\n};\n\nvar diffFilter = function textsDiffFilter(context) {\n  if (context.leftType !== 'string') {\n    return;\n  }\n  var minLength = (context.options && context.options.textDiff &&\n    context.options.textDiff.minLength) || DEFAULT_MIN_LENGTH;\n  if (context.left.length < minLength ||\n    context.right.length < minLength) {\n    context.setResult([context.left, context.right]).exit();\n    return;\n  }\n  // large text, try to use a text-diff algorithm\n  var diffMatchPatch = getDiffMatchPatch();\n  if (!diffMatchPatch) {\n    // diff-match-patch library not available, fallback to regular string replace\n    context.setResult([context.left, context.right]).exit();\n    return;\n  }\n  var diff = diffMatchPatch.diff;\n  context.setResult([diff(context.left, context.right), 0, TEXT_DIFF]).exit();\n};\ndiffFilter.filterName = 'texts';\n\nvar patchFilter = function textsPatchFilter(context) {\n  if (context.nested) {\n    return;\n  }\n  if (context.delta[2] !== TEXT_DIFF) {\n    return;\n  }\n\n  // text-diff, use a text-patch algorithm\n  var patch = getDiffMatchPatch(true).patch;\n  context.setResult(patch(context.left, context.delta[0])).exit();\n};\npatchFilter.filterName = 'texts';\n\nvar textDeltaReverse = function(delta) {\n  var i, l, lines, line, lineTmp, header = null,\n    headerRegex = /^@@ +\\-(\\d+),(\\d+) +\\+(\\d+),(\\d+) +@@$/,\n    lineHeader, lineAdd, lineRemove;\n  lines = delta.split('\\n');\n  for (i = 0, l = lines.length; i < l; i++) {\n    line = lines[i];\n    var lineStart = line.slice(0, 1);\n    if (lineStart === '@') {\n      header = headerRegex.exec(line);\n      lineHeader = i;\n      lineAdd = null;\n      lineRemove = null;\n\n      // fix header\n      lines[lineHeader] = '@@ -' + header[3] + ',' + header[4] + ' +' + header[1] + ',' + header[2] + ' @@';\n    } else if (lineStart === '+') {\n      lineAdd = i;\n      lines[i] = '-' + lines[i].slice(1);\n      if (lines[i - 1].slice(0, 1) === '+') {\n        // swap lines to keep default order (-+)\n        lineTmp = lines[i];\n        lines[i] = lines[i - 1];\n        lines[i - 1] = lineTmp;\n      }\n    } else if (lineStart === '-') {\n      lineRemove = i;\n      lines[i] = '+' + lines[i].slice(1);\n    }\n  }\n  return lines.join('\\n');\n};\n\nvar reverseFilter = function textsReverseFilter(context) {\n  if (context.nested) {\n    return;\n  }\n  if (context.delta[2] !== TEXT_DIFF) {\n    return;\n  }\n\n  // text-diff, use a text-diff algorithm\n  context.setResult([textDeltaReverse(context.delta[0]), 0, TEXT_DIFF]).exit();\n};\nreverseFilter.filterName = 'texts';\n\nexports.diffFilter = diffFilter;\nexports.patchFilter = patchFilter;\nexports.reverseFilter = reverseFilter;\n","var isArray = (typeof Array.isArray === 'function') ?\n  // use native function\n  Array.isArray :\n  // use instanceof operator\n  function(a) {\n    return a instanceof Array;\n  };\n\nvar diffFilter = function trivialMatchesDiffFilter(context) {\n  if (context.left === context.right) {\n    context.setResult(undefined).exit();\n    return;\n  }\n  if (typeof context.left === 'undefined') {\n    if (typeof context.right === 'function') {\n      throw new Error('functions are not supported');\n    }\n    context.setResult([context.right]).exit();\n    return;\n  }\n  if (typeof context.right === 'undefined') {\n    context.setResult([context.left, 0, 0]).exit();\n    return;\n  }\n  if (typeof context.left === 'function' || typeof context.right === 'function') {\n    throw new Error('functions are not supported');\n  }\n  context.leftType = context.left === null ? 'null' : typeof context.left;\n  context.rightType = context.right === null ? 'null' : typeof context.right;\n  if (context.leftType !== context.rightType) {\n    context.setResult([context.left, context.right]).exit();\n    return;\n  }\n  if (context.leftType === 'boolean' || context.leftType === 'number') {\n    context.setResult([context.left, context.right]).exit();\n    return;\n  }\n  if (context.leftType === 'object') {\n    context.leftIsArray = isArray(context.left);\n  }\n  if (context.rightType === 'object') {\n    context.rightIsArray = isArray(context.right);\n  }\n  if (context.leftIsArray !== context.rightIsArray) {\n    context.setResult([context.left, context.right]).exit();\n    return;\n  }\n\n  if (context.left instanceof RegExp) {\n    if (context.right instanceof RegExp) {\n      context.setResult([context.left.toString(), context.right.toString()]).exit();\n    } else {\n      context.setResult([context.left, context.right]).exit();\n      return;\n    }\n  }\n};\ndiffFilter.filterName = 'trivial';\n\nvar patchFilter = function trivialMatchesPatchFilter(context) {\n  if (typeof context.delta === 'undefined') {\n    context.setResult(context.left).exit();\n    return;\n  }\n  context.nested = !isArray(context.delta);\n  if (context.nested) {\n    return;\n  }\n  if (context.delta.length === 1) {\n    context.setResult(context.delta[0]).exit();\n    return;\n  }\n  if (context.delta.length === 2) {\n    if (context.left instanceof RegExp) {\n      var regexArgs = /^\\/(.*)\\/([gimyu]+)$/.exec(context.delta[1]);\n      if (regexArgs) {\n        context.setResult(new RegExp(regexArgs[1], regexArgs[2])).exit();\n        return;\n      }\n    }\n    context.setResult(context.delta[1]).exit();\n    return;\n  }\n  if (context.delta.length === 3 && context.delta[2] === 0) {\n    context.setResult(undefined).exit();\n    return;\n  }\n};\npatchFilter.filterName = 'trivial';\n\nvar reverseFilter = function trivialReferseFilter(context) {\n  if (typeof context.delta === 'undefined') {\n    context.setResult(context.delta).exit();\n    return;\n  }\n  context.nested = !isArray(context.delta);\n  if (context.nested) {\n    return;\n  }\n  if (context.delta.length === 1) {\n    context.setResult([context.delta[0], 0, 0]).exit();\n    return;\n  }\n  if (context.delta.length === 2) {\n    context.setResult([context.delta[1], context.delta[0]]).exit();\n    return;\n  }\n  if (context.delta.length === 3 && context.delta[2] === 0) {\n    context.setResult([context.delta[0]]).exit();\n    return;\n  }\n};\nreverseFilter.filterName = 'trivial';\n\nexports.diffFilter = diffFilter;\nexports.patchFilter = patchFilter;\nexports.reverseFilter = reverseFilter;\n","var Pipe = function Pipe(name) {\n  this.name = name;\n  this.filters = [];\n};\n\nPipe.prototype.process = function(input) {\n  if (!this.processor) {\n    throw new Error('add this pipe to a processor before using it');\n  }\n  var debug = this.debug;\n  var length = this.filters.length;\n  var context = input;\n  for (var index = 0; index < length; index++) {\n    var filter = this.filters[index];\n    if (debug) {\n      this.log('filter: ' + filter.filterName);\n    }\n    filter(context);\n    if (typeof context === 'object' && context.exiting) {\n      context.exiting = false;\n      break;\n    }\n  }\n  if (!context.next && this.resultCheck) {\n    this.resultCheck(context);\n  }\n};\n\nPipe.prototype.log = function(msg) {\n  console.log('[jsondiffpatch] ' + this.name + ' pipe, ' + msg);\n};\n\nPipe.prototype.append = function() {\n  this.filters.push.apply(this.filters, arguments);\n  return this;\n};\n\nPipe.prototype.prepend = function() {\n  this.filters.unshift.apply(this.filters, arguments);\n  return this;\n};\n\nPipe.prototype.indexOf = function(filterName) {\n  if (!filterName) {\n    throw new Error('a filter name is required');\n  }\n  for (var index = 0; index < this.filters.length; index++) {\n    var filter = this.filters[index];\n    if (filter.filterName === filterName) {\n      return index;\n    }\n  }\n  throw new Error('filter not found: ' + filterName);\n};\n\nPipe.prototype.list = function() {\n  var names = [];\n  for (var index = 0; index < this.filters.length; index++) {\n    var filter = this.filters[index];\n    names.push(filter.filterName);\n  }\n  return names;\n};\n\nPipe.prototype.after = function(filterName) {\n  var index = this.indexOf(filterName);\n  var params = Array.prototype.slice.call(arguments, 1);\n  if (!params.length) {\n    throw new Error('a filter is required');\n  }\n  params.unshift(index + 1, 0);\n  Array.prototype.splice.apply(this.filters, params);\n  return this;\n};\n\nPipe.prototype.before = function(filterName) {\n  var index = this.indexOf(filterName);\n  var params = Array.prototype.slice.call(arguments, 1);\n  if (!params.length) {\n    throw new Error('a filter is required');\n  }\n  params.unshift(index, 0);\n  Array.prototype.splice.apply(this.filters, params);\n  return this;\n};\n\nPipe.prototype.replace = function(filterName) {\n  var index = this.indexOf(filterName);\n  var params = Array.prototype.slice.call(arguments, 1);\n  if (!params.length) {\n    throw new Error('a filter is required');\n  }\n  params.unshift(index, 1);\n  Array.prototype.splice.apply(this.filters, params);\n  return this;\n};\n\nPipe.prototype.remove = function(filterName) {\n  var index = this.indexOf(filterName);\n  this.filters.splice(index, 1);\n  return this;\n};\n\nPipe.prototype.clear = function() {\n  this.filters.length = 0;\n  return this;\n};\n\nPipe.prototype.shouldHaveResult = function(should) {\n  if (should === false) {\n    this.resultCheck = null;\n    return;\n  }\n  if (this.resultCheck) {\n    return;\n  }\n  var pipe = this;\n  this.resultCheck = function(context) {\n    if (!context.hasResult) {\n      console.log(context);\n      var error = new Error(pipe.name + ' failed');\n      error.noResult = true;\n      throw error;\n    }\n  };\n  return this;\n};\n\nexports.Pipe = Pipe;\n","\nvar Processor = function Processor(options){\n  this.selfOptions = options || {};\n  this.pipes = {};\n};\n\nProcessor.prototype.options = function(options) {\n  if (options) {\n    this.selfOptions = options;\n  }\n  return this.selfOptions;\n};\n\nProcessor.prototype.pipe = function(name, pipe) {\n  if (typeof name === 'string') {\n    if (typeof pipe === 'undefined') {\n      return this.pipes[name];\n    } else {\n      this.pipes[name] = pipe;\n    }\n  }\n  if (name && name.name) {\n    pipe = name;\n    if (pipe.processor === this) { return pipe; }\n    this.pipes[pipe.name] = pipe;\n  }\n  pipe.processor = this;\n  return pipe;\n};\n\nProcessor.prototype.process = function(input, pipe) {\n  var context = input;\n  context.options = this.options();\n  var nextPipe = pipe || input.pipe || 'default';\n  var lastPipe, lastContext;\n  while (nextPipe) {\n    if (typeof context.nextAfterChildren !== 'undefined') {\n      // children processed and coming back to parent\n      context.next = context.nextAfterChildren;\n      context.nextAfterChildren = null;\n    }\n\n    if (typeof nextPipe === 'string') {\n      nextPipe = this.pipe(nextPipe);\n    }\n    nextPipe.process(context);\n    lastContext = context;\n    lastPipe = nextPipe;\n    nextPipe = null;\n    if (context) {\n      if (context.next) {\n        context = context.next;\n        nextPipe = lastContext.nextPipe || context.pipe || lastPipe;\n      }\n    }\n  }\n  return context.hasResult ? context.result : undefined;\n};\n\nexports.Processor = Processor;\n","import root from './_root.js';\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nexport default Symbol;\n","import Symbol from './_Symbol.js';\nimport getRawTag from './_getRawTag.js';\nimport objectToString from './_objectToString.js';\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nexport default baseGetTag;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nexport default freeGlobal;\n","import overArg from './_overArg.js';\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nexport default getPrototype;\n","import Symbol from './_Symbol.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nexport default getRawTag;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nexport default objectToString;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nexport default overArg;\n","import freeGlobal from './_freeGlobal.js';\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nexport default root;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nexport default isObjectLike;\n","import baseGetTag from './_baseGetTag.js';\nimport getPrototype from './_getPrototype.js';\nimport isObjectLike from './isObjectLike.js';\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nexport default isPlainObject;\n","const m = require(\"mithril\");\n\n\nmodule.exports = {\n\n    getClassNames(attrs) {\n        const classNames = [];\n        classNames.push(attrs.raised ? \"mmf-button--raised\" : \"mmf-button--flat\");\n        classNames.push(attrs.disabled ? \"is-disabled\" : \"is-enabled\");\n        if (attrs.class) {\n            classNames.push(attrs.class);\n        }\n        return classNames.join(\" \");\n    },\n\n    view(vnode) {\n        const attrs = Object.assign({\n            disabled: false,\n            onclick: (event) => vnode.attrs.disabled !== true && vnode.attrs.onClick(event)\n        }, vnode.attrs);\n\n        attrs.class = this.getClassNames(vnode.attrs);\n\n        return m(\"button.mmf-button\", attrs, vnode.children);\n    }\n};\n","const m = require(\"mithril\");\n\n\nmodule.exports = {\n    view(vnode) {\n        return m(\"input.mmf-checkbox\",\n            {\n                id: vnode.attrs.id,\n                type: \"checkbox\",\n                checked: vnode.attrs.value,\n                onchange: m.withAttr(\"checked\", vnode.attrs.onChange || Function.prototype)\n            }\n        );\n    }\n};\n","const m = require(\"mithril\");\nconst Checkbox = require(\"../checkbox\");\nconst Label = require(\"../label\");\nconst Errors = require(\"../errors\");\n\n\nmodule.exports = {\n    view(vnode) {\n        const attrs = Object.assign({\n            id: null,\n            title: \"\",\n            value: \"\",\n            errors: [],\n            description: \"\",\n            placeholder: \"\",\n            onchange: Function.prototype\n        }, vnode.attrs);\n\n        return m(\".mmf-form.mmf-form--checkbox\",\n            {\n                \"class\": Errors.getErrorClass(attrs.errors)\n            },\n            m(Checkbox,\n                {\n                    id: vnode.attrs.id,\n                    value: vnode.attrs.value,\n                    onChange: vnode.attrs.onchange\n                }\n            ),\n            m(Label, attrs),\n            m(Errors, attrs),\n            attrs.description ? m(\".mmf-meta\", attrs.description) : \"\"\n        );\n    }\n};\n","module.exports = function getErrorClass(errors) {\n    if (errors == null || errors.length === 0) {\n        return \"no-error\";\n    }\n\n    for (let i = 0, l = errors.length; i < l; i += 1) {\n        if (typeof errors[i] === \"string\" || errors[i].severity !== \"warning\") {\n            return \"has-error\";\n        }\n    }\n\n    return \"has-warning\";\n};\n","const m = require(\"mithril\");\n\nfunction isVNode(object) {\n    return typeof object.tag === \"string\" && object.attrs != null && typeof object.attrs === \"object\";\n}\n\n\nmodule.exports = {\n\n    getErrorClass: require(\"./getErrorClass\"),\n\n    view(vnode) {\n        if (vnode.attrs.errors == null || vnode.attrs.errors.length === 0) {\n            return \"\";\n        }\n\n        return m(\"ul.mmf-form__errors\",\n            vnode.attrs.errors.map((error) => {\n                if (isVNode(error)) {\n                    return m(`li.mmf-form__error.mmf-form__error--${error.attrs.severity}`, error);\n                }\n\n                if (error && typeof error === \"object\") {\n                    if (error.severity === \"warning\") {\n                        return m(\"li.mmf-form__error.mmf-form__error--warning\", m.trust(error.message));\n                    }\n                    return m(\"li.mmf-form__error.mmf-form__error--error\", m.trust(error.message));\n                }\n                return m(\"li.mmf-form__error.mmf-form__error--error\", m.trust(error));\n            })\n        );\n    }\n};\n","const m = require(\"mithril\");\nconst RATIO_DEFAULT = [16, 9];\n\nfunction isEmpty(value) {\n    return value == null || value === \"\";\n}\n\nfunction getRatioStyle(ratio) {\n    return `${getRatio(ratio).toFixed(2)}%`;\n}\n\nfunction getRatio(ratio) {\n    let dim = ratio.split(\":\").map(parseFloat);\n    dim = dim.length === 2 ? dim : RATIO_DEFAULT;\n    return (100 * dim[1] / dim[0]);\n}\n\n\nconst MetaDescription = {\n    view(vnode) {\n        const attrs = vnode.attrs;\n        return [\n            isEmpty(attrs.url) ?\n                m(\".mmf-preview__placeholder\", attrs.placeholder) : [\n                    attrs.description ? m(\".mmf-preview__description\", m.trust(attrs.description)) : \"\",\n                    m(\".mmf-preview__overflow-indicator\")\n                ],\n            vnode.children\n        ];\n    }\n};\n\n\nconst InlineImage = {\n    view(vnode) {\n        const attrs = vnode.attrs;\n        return m(\".mmf-preview__content\",\n            {\n                style: isEmpty(attrs.url) ? \"\" : `padding-bottom: ${getRatioStyle(attrs.maxRatio)};`,\n                oncreate: attrs.oncreate\n            },\n            isEmpty(attrs.url) ?\n                m(\".mmf-preview__placeholder\", attrs.placeholder) : [\n                    m(\"img\", {\n                        src: attrs.url,\n                        onload: attrs.onload\n                    }),\n                    attrs.description ? m(\".mmf-preview__description\", m.trust(attrs.description)) : \"\",\n                    m(\".mmf-preview__overflow-indicator\")\n                ],\n            vnode.children\n        );\n    }\n};\n\n\nconst ImagePreview = {\n\n    overflowContainer: null,\n\n    updateRatio(maxRatio, image) {\n        if (this.overflowContainer != null && image.naturalWidth) {\n            const ratioMax = getRatio(maxRatio);\n            const ratioImg = getRatio(`${image.naturalWidth}:${image.naturalHeight}`);\n\n            if (ratioMax >= ratioImg) {\n                this.overflowContainer.style.paddingBottom = `${ratioImg.toFixed(2)}%`;\n                this.overflowContainer.classList.remove(\"with-overflow\");\n                this.hasOverflow = false;\n            } else {\n                this.overflowContainer.style.paddingBottom = `${ratioMax.toFixed(2)}%`;\n                this.overflowContainer.classList.add(\"with-overflow\");\n                this.hasOverflow = true;\n            }\n        }\n    },\n\n    view(vnode) {\n        const attrs = Object.assign({\n            url: null,\n            \"class\": \"\",\n            asBackgroundImage: false,\n            description: null,\n            placeholder: null,\n            onclick: null,\n            maxRatio: \"16:9\",\n            // \"private\"\n            onload: (event) => this.updateRatio(attrs.maxRatio, event.currentTarget),\n            oncreate: (content) => { this.overflowContainer = content.dom; }\n        }, vnode.attrs);\n\n        return m(\".mmf-preview.mmf-preview--image\",\n            {\n                \"class\": attrs.class + (isEmpty(attrs.url) ? \"\" : \" with-image\"),\n                style: (attrs.asBackgroundImage && !isEmpty(attrs.url)) ?\n                    `background-image: url(${attrs.url});` : \"\"\n            },\n            attrs.asBackgroundImage ? m(MetaDescription, attrs, vnode.children) : m(InlineImage, attrs, vnode.children)\n        );\n    }\n};\n\n\nmodule.exports = ImagePreview;\n","const m = require(\"mithril\");\n\n\nmodule.exports = {\n    value: null,\n    hasFocus: false,\n\n    onupdate(vnode) {\n        // @prevent redraw of input\n        vnode.dom.id = vnode.attrs.id; // updating the pointer dependend attributes outside of mithril\n    },\n\n    view({ attrs }) {\n        let value = attrs.value;\n        if (this.hasFocus & this.value != null) {\n            value = this.value; // this will remove any changes applied to this data from \"outside\"\n        }\n\n        this.value = value;\n\n        const inputAttributes = {\n            // id: attrs.id, // if the element is pointer sensitive it will be rebuild on pointer updates, loosing focus\n            type: attrs.type,\n            value,\n            oninput: m.withAttr(\"value\", (currentValue) => (this.value = currentValue)),\n            // @fixme this might trigger updates, but ensures the property is always set (on initial rendering)\n            oncreate: (vnode) => (vnode.dom.id = attrs.id),\n            onfocus: (event) => {\n                this.hasFocus = true;\n                attrs.onfocus && attrs.onfocus(event);\n            },\n            onblur: (event) => {\n                this.hasFocus = false;\n                attrs.onblur && attrs.onblur(event);\n            }\n        };\n\n        const updateEvent = attrs.instantUpdate === true ? \"onkeyup\" : \"onchange\";\n        inputAttributes[updateEvent] = () => attrs.onChange(this.value);\n\n        return m(\"input.mmf-input\", inputAttributes);\n    }\n};\n","const m = require(\"mithril\");\nconst Input = require(\"../input\");\nconst Label = require(\"../label\");\nconst sanitizeValue = require(\"./sanitizeValue\");\nconst Errors = require(\"../errors\");\n\n\nconst TYPES = {\n    string: \"text\",\n    integer: \"number\",\n    number: \"number\"\n};\n\n\nmodule.exports = {\n    oncreate(vnode) {\n        this.$form = vnode.dom;\n    },\n\n    updateClasses(value) {\n        const hasValue = value !== \"\";\n        this.$form.classList.remove(hasValue ? \"isEmpty\" : \"isNotEmpty\");\n        this.$form.classList.add(hasValue === false ? \"isEmpty\" : \"isNotEmpty\");\n    },\n\n    onfocus() {\n        this.$form.classList.add(\"hasFocus\");\n        this.$form.classList.remove(\"hasNoFocus\");\n    },\n\n    onblur(value) {\n        this.$form.classList.add(\"hasNoFocus\");\n        this.$form.classList.remove(\"hasFocus\");\n        this.updateClasses(value);\n    },\n\n    hasFocus() {\n        return this.$form && this.$form.classList.contains(\"hasFocus\");\n    },\n\n    view(vnode) {\n        const inputType = TYPES[vnode.attrs.type] || \"text\";\n        const attrs = Object.assign({\n            id: null,\n            title: \"\",\n            value: \"\",\n            errors: [],\n            description: \"\",\n            placeholder: \"\",\n            instantUpdate: false,\n            onblur: Function.prototype,\n            onfocus: Function.prototype,\n            onchange: Function.prototype\n        }, vnode.attrs);\n\n        const focusClass = this.hasFocus() ? \"hasFocus\" : \"hasNoFocus\";\n        const errorClass = Errors.getErrorClass(attrs.errors);\n        const emptyClass = attrs.value === \"\" ? \"isEmpty\" : \"isNotEmpty\";\n\n        const view = m(\".mmf-form.mmf-form--input\",\n            {\n                \"class\": `${focusClass} ${errorClass} ${emptyClass}`\n            },\n            m(Label, attrs),\n            m(Input,\n                {\n                    type: inputType,\n                    id: attrs.id,\n                    instantUpdate: attrs.instantUpdate,\n                    onChange: (value) => attrs.onchange(sanitizeValue(inputType, value)),\n                    value: attrs.value,\n                    onfocus: (e) => {\n                        this.onfocus();\n                        attrs.onfocus && attrs.onfocus(e);\n                    },\n                    onblur: (e) => {\n                        this.onblur(e.target.value);\n                        attrs.onblur && attrs.onblur(e);\n                    }\n                }\n            ),\n            m(Errors, attrs),\n            attrs.description ? m(\".mmf-meta\", attrs.description) : \"\"\n        );\n\n        return view;\n    }\n};\n","module.exports = function sanitizeValue(type, value) {\n    if (type === \"number\") {\n        const intValue = parseInt(value);\n        const floatValue = parseFloat(value);\n        if (floatValue == value) { // eslint-disable-line\n            return floatValue;\n        } else if (isNaN(intValue)) {\n            return value;\n        }\n        return intValue;\n    }\n    return value;\n};\n","const m = require(\"mithril\");\n\n\nmodule.exports = {\n    view(vnode) {\n        return m(\"label.mmf-label\",\n            {\n                \"for\": vnode.attrs.id,\n                \"class\": vnode.attrs.class\n            },\n            vnode.attrs.title\n        );\n    }\n};\n","const m = require(\"mithril\");\n\n\nmodule.exports = {\n    view(vnode) {\n        return m(\"div.mmf-select__wrapper\", { oncreate: (vnode) => (this.$wrapper = vnode.dom) },\n            m(\"select.mmf-select\",\n                {\n                    id: vnode.attrs.id,\n                    value: vnode.attrs.value,\n                    \"class\": vnode.attrs.class,\n                    onfocus: () => {\n                        this.$wrapper && this.$wrapper.classList.add(\"has-focus\");\n                        vnode.attrs.onfocus && vnode.attrs.onfocus(vnode);\n                    },\n                    onblur: () => {\n                        this.$wrapper && this.$wrapper.classList.remove(\"has-focus\");\n                        vnode.attrs.onblur && vnode.attrs.onblur(vnode);\n                    },\n                    // @reminder will always be string, which must be specified in json-schema or else datatype must\n                    // be passed to select-component\n                    onchange: m.withAttr(\"value\", vnode.attrs.onchange)\n                },\n                vnode.attrs.options.map((value) => {\n                    const title = value.title || value;\n                    value = `${value.value == null ? value : value.value}`; // value must be a string or else is discarded\n                    return m(\"option\", { value }, title);\n                })\n            )\n        );\n    }\n};\n","const m = require(\"mithril\");\nconst Select = require(\"../select\");\nconst Label = require(\"../label\");\nconst Errors = require(\"../errors\");\n\n\nmodule.exports = {\n    view(vnode) {\n        const attrs = Object.assign({\n            id: null,\n            value: \"\",\n            options: [{ title: \"-\", value: false }],\n            errors: [],\n            description: \"\",\n            placeholder: \"\",\n            onchange: Function.prototype\n        }, vnode.attrs);\n\n        return m(\".mmf-form.mmf-form--select\",\n            {\n                \"class\": Errors.getErrorClass(attrs.errors)\n            },\n            m(Select, attrs),\n            m(Label, Object.assign({ \"class\": \"mmf-grow-2\" }, attrs)),\n            m(Errors, attrs),\n            attrs.description ? m(\".mmf-meta\", attrs.description) : \"\"\n        );\n    }\n};\n","const m = require(\"mithril\");\nconst autosize = require(\"autosize\");\n\n\nmodule.exports = {\n\n    onupdate(vnode) {\n        autosize.update(vnode.dom);\n    },\n\n    view(vnode) {\n        const attrs = Object.assign({\n            id: null,\n            value: \"\",\n            rows: 1,\n            instantUpdate: false,\n            onblur: Function.prototype,\n            onfocus: Function.prototype,\n            onchange: Function.prototype,\n            oncreate: Function.prototype,\n            onbeforeremove: Function.prototype\n        }, vnode.attrs);\n\n        const textareaAttributes = {\n            id: attrs.id,\n            value: attrs.value,\n            rows: attrs.rows,\n            onblur: attrs.onblur,\n            onfocus: attrs.onfocus,\n            onupdate: (node) => autosize.update(node.dom),\n            oncreate: (node) => {\n                attrs.oncreate(node);\n                autosize(node.dom);\n                autosize.update(vnode.dom);\n            },\n            onbeforeremove: (node) => {\n                attrs.onbeforeremove(node);\n                autosize.destroy(node.dom);\n            }\n        };\n\n        const updateEvent = attrs.instantUpdate === true ? \"onkeyup\" : \"onchange\";\n        textareaAttributes[updateEvent] = attrs.onchange;\n\n        return m(\"textarea.mmf-textarea\", textareaAttributes);\n    }\n};\n","const m = require(\"mithril\");\nconst Textarea = require(\"../textarea\");\nconst Label = require(\"../label\");\nconst Errors = require(\"../errors\");\n\n\nfunction isEmpty(value) {\n    return value == null || value === \"\";\n}\n\nmodule.exports = {\n\n    oncreate(vnode) {\n        this.$form = vnode.dom;\n        this.onblur(vnode.attrs.value);\n    },\n\n    onfocus() {\n        this.$form.classList.remove(\"hasNoFocus\");\n        this.$form.classList.add(\"hasFocus\");\n    },\n\n    onblur(value) {\n        this.$form.classList.remove(\"hasFocus\");\n        this.$form.classList.add(\"hasNoFocus\");\n        this.updateClasses(value);\n    },\n\n    updateClasses(value) {\n        const hasValue = isEmpty(value) === false;\n        this.$form.classList.remove(hasValue ? \"isEmpty\" : \"isNotEmpty\");\n        this.$form.classList.add(hasValue === false ? \"isEmpty\" : \"isNotEmpty\");\n    },\n\n    onupdate(vnode) {\n        this.updateClasses(vnode.attrs.value);\n    },\n\n    view(vnode) {\n        const attrs = Object.assign({\n            id: null,\n            title: \"\",\n            value: \"\",\n            errors: [],\n            description: \"\",\n            placeholder: \"\",\n            instantUpdate: false,\n            onblur: Function.prototype,\n            onfocus: Function.prototype,\n            onchange: Function.prototype\n        }, vnode.attrs);\n\n        return m(\".mmf-form.mmf-form--textarea\",\n            {\n                \"class\": Errors.getErrorClass(attrs.errors)\n            },\n            m(Label, attrs),\n            m(Textarea, {\n                id: attrs.id,\n                value: attrs.value,\n                instantUpdate: attrs.instantUpdate,\n                onchange: m.withAttr(\"value\", attrs.onchange),\n                onblur: (e) => {\n                    this.onblur(e.target.value);\n                    attrs.onblur(e);\n                },\n                onfocus: (e) => {\n                    this.onfocus();\n                    attrs.onfocus(e);\n                }\n            }),\n            m(Errors, attrs),\n            attrs.description ? m(\".mmf-meta\", attrs.description) : \"\"\n        );\n    }\n};\n","module.exports = {\n    button: require(\"./components/button\"),\n    checkbox: require(\"./components/checkbox\"),\n    checkboxForm: require(\"./components/checkboxform\"),\n    errors: require(\"./components/errors\"),\n    input: require(\"./components/input\"),\n    inputForm: require(\"./components/inputform\"),\n    label: require(\"./components/label\"),\n    select: require(\"./components/select\"),\n    selectForm: require(\"./components/selectform\"),\n    textarea: require(\"./components/textarea\"),\n    textareaForm: require(\"./components/textareaform\"),\n    imagePreview: require(\"./components/imagepreview\")\n};\n","//      \n// An event handler can take an optional event argument\n// and should not return a value\n                                          \n                                                               \n\n// An array of all currently registered event handlers for a type\n                                            \n                                                            \n// A map of event types and their corresponding event handlers.\n                        \n                                 \n                                   \n  \n\n/** Mitt: Tiny (~200b) functional event emitter / pubsub.\n *  @name mitt\n *  @returns {Mitt}\n */\nfunction mitt(all                 ) {\n\tall = all || Object.create(null);\n\n\treturn {\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to listen for, or `\"*\"` for all events\n\t\t * @param  {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton: function on(type        , handler              ) {\n\t\t\t(all[type] || (all[type] = [])).push(handler);\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to unregister `handler` from, or `\"*\"`\n\t\t * @param  {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff: function off(type        , handler              ) {\n\t\t\tif (all[type]) {\n\t\t\t\tall[type].splice(all[type].indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * @param {String} type  The event type to invoke\n\t\t * @param {Any} [evt]  Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberOf mitt\n\t\t */\n\t\temit: function emit(type        , evt     ) {\n\t\t\t(all[type] || []).slice().map(function (handler) { handler(evt); });\n\t\t\t(all['*'] || []).slice().map(function (handler) { handler(type, evt); });\n\t\t}\n\t};\n}\n\nexport default mitt;\n//# sourceMappingURL=mitt.es.js.map\n","function n(n){return n=n||Object.create(null),{on:function(c,e){(n[c]||(n[c]=[])).push(e)},off:function(c,e){n[c]&&n[c].splice(n[c].indexOf(e)>>>0,1)},emit:function(c,e){(n[c]||[]).slice().map(function(n){n(e)}),(n[\"*\"]||[]).slice().map(function(n){n(c,e)})}}}module.exports=n;\n//# sourceMappingURL=mitt.js.map","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.parseActions = parseActions;\nexports.default = undoable;\nexports.distinctState = distinctState;\nexports.includeAction = includeAction;\nexports.ifAction = ifAction;\nexports.excludeAction = excludeAction;\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n// debug output\nvar __DEBUG__ = undefined;\nfunction debug() {\n  if (__DEBUG__) {\n    var _console;\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    if (!console.group) {\n      args.unshift('%credux-undo', 'font-style: italic');\n    }\n    (_console = console).log.apply(_console, args);\n  }\n}\nfunction debugStart(action, state) {\n  if (__DEBUG__) {\n    var args = ['action', action.type];\n    if (console.group) {\n      var _console2;\n\n      args.unshift('%credux-undo', 'font-style: italic');\n      (_console2 = console).groupCollapsed.apply(_console2, args);\n      console.log('received', { state: state, action: action });\n    } else {\n      debug.apply(undefined, args);\n    }\n  }\n}\nfunction debugEnd() {\n  if (__DEBUG__) {\n    return console.groupEnd && console.groupEnd();\n  }\n}\n// /debug output\n\n// action types\nvar ActionTypes = exports.ActionTypes = {\n  UNDO: '@@redux-undo/UNDO',\n  REDO: '@@redux-undo/REDO',\n  JUMP_TO_FUTURE: '@@redux-undo/JUMP_TO_FUTURE',\n  JUMP_TO_PAST: '@@redux-undo/JUMP_TO_PAST'\n};\n// /action types\n\n// action creators to change the state\nvar ActionCreators = exports.ActionCreators = {\n  undo: function undo() {\n    return { type: ActionTypes.UNDO };\n  },\n  redo: function redo() {\n    return { type: ActionTypes.REDO };\n  },\n  jumpToFuture: function jumpToFuture(index) {\n    return { type: ActionTypes.JUMP_TO_FUTURE, index: index };\n  },\n  jumpToPast: function jumpToPast(index) {\n    return { type: ActionTypes.JUMP_TO_PAST, index: index };\n  }\n};\n// /action creators\n\n// length: get length of history\nfunction length(history) {\n  var past = history.past;\n  var future = history.future;\n\n  return past.length + 1 + future.length;\n}\n// /length\n\n// insert: insert `state` into history, which means adding the current state\n//         into `past`, setting the new `state` as `present` and erasing\n//         the `future`.\nfunction insert(history, state, limit) {\n  debug('insert', { state: state, history: history, free: limit - length(history) });\n\n  var past = history.past;\n  var present = history.present;\n\n  var historyOverflow = limit && length(history) >= limit;\n\n  if (present === undefined) {\n    // init history\n    return {\n      past: [],\n      present: state,\n      future: []\n    };\n  }\n\n  return {\n    past: [].concat(_toConsumableArray(past.slice(historyOverflow ? 1 : 0)), [present]),\n    present: state,\n    future: []\n  };\n}\n// /insert\n\n// undo: go back to the previous point in history\nfunction undo(history) {\n  debug('undo', { history: history });\n\n  var past = history.past;\n  var present = history.present;\n  var future = history.future;\n\n\n  if (past.length <= 0) return history;\n\n  return {\n    past: past.slice(0, past.length - 1), // remove last element from past\n    present: past[past.length - 1], // set element as new present\n    future: [present].concat(_toConsumableArray(future))\n  };\n}\n// /undo\n\n// redo: go to the next point in history\nfunction redo(history) {\n  debug('redo', { history: history });\n\n  var past = history.past;\n  var present = history.present;\n  var future = history.future;\n\n\n  if (future.length <= 0) return history;\n\n  return {\n    future: future.slice(1, future.length), // remove element from future\n    present: future[0], // set element as new present\n    past: [].concat(_toConsumableArray(past), [present // old present state is in the past now\n    ])\n  };\n}\n// /redo\n\n// jumpToFuture: jump to requested index in future history\nfunction jumpToFuture(history, index) {\n  if (index === 0) return redo(history);\n\n  var past = history.past;\n  var present = history.present;\n  var future = history.future;\n\n\n  return {\n    future: future.slice(index + 1),\n    present: future[index],\n    past: past.concat([present]).concat(future.slice(0, index))\n  };\n}\n// /jumpToFuture\n\n// jumpToPast: jump to requested index in past history\nfunction jumpToPast(history, index) {\n  if (index === history.past.length - 1) return undo(history);\n\n  var past = history.past;\n  var present = history.present;\n  var future = history.future;\n\n\n  return {\n    future: past.slice(index + 1).concat([present]).concat(future),\n    present: past[index],\n    past: past.slice(0, index)\n  };\n}\n// /jumpToPast\n\n// wrapState: for backwards compatibility to 0.4\nfunction wrapState(state) {\n  return _extends({}, state, {\n    history: state\n  });\n}\n// /wrapState\n\n// updateState\nfunction updateState(state, history) {\n  return wrapState(_extends({}, state, history));\n}\n// /updateState\n\n// createHistory\nfunction createHistory(state) {\n  return {\n    past: [],\n    present: state,\n    future: []\n  };\n}\n// /createHistory\n\n// parseActions\nfunction parseActions(rawActions) {\n  var defaultValue = arguments.length <= 1 || arguments[1] === undefined ? [] : arguments[1];\n\n  if (Array.isArray(rawActions)) {\n    return rawActions;\n  } else if (typeof rawActions === 'string') {\n    return [rawActions];\n  }\n  return defaultValue;\n}\n// /parseActions\n\n// redux-undo higher order reducer\nfunction undoable(reducer) {\n  var rawConfig = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];\n\n  __DEBUG__ = rawConfig.debug;\n\n  var config = {\n    initialState: rawConfig.initialState,\n    initTypes: parseActions(rawConfig.initTypes, ['@@redux/INIT', '@@INIT']),\n    limit: rawConfig.limit,\n    filter: rawConfig.filter || function () {\n      return true;\n    },\n    undoType: rawConfig.undoType || ActionTypes.UNDO,\n    redoType: rawConfig.redoType || ActionTypes.REDO,\n    jumpToPastType: rawConfig.jumpToPastType || ActionTypes.JUMP_TO_PAST,\n    jumpToFutureType: rawConfig.jumpToFutureType || ActionTypes.JUMP_TO_FUTURE\n  };\n  config.history = rawConfig.initialHistory || createHistory(config.initialState);\n\n  if (config.initTypes.length === 0) {\n    console.warn('redux-undo: supply at least one action type in initTypes to ensure initial state');\n  }\n\n  return function (state, action) {\n    debugStart(action, state);\n    var res = undefined;\n    switch (action.type) {\n      case config.undoType:\n        res = undo(state);\n        debug('after undo', res);\n        debugEnd();\n        return res ? updateState(state, res) : state;\n\n      case config.redoType:\n        res = redo(state);\n        debug('after redo', res);\n        debugEnd();\n        return res ? updateState(state, res) : state;\n\n      case config.jumpToPastType:\n        res = jumpToPast(state, action.index);\n        debug('after jumpToPast', res);\n        debugEnd();\n        return res ? updateState(state, res) : state;\n\n      case config.jumpToFutureType:\n        res = jumpToFuture(state, action.index);\n        debug('after jumpToFuture', res);\n        debugEnd();\n        return res ? updateState(state, res) : state;\n\n      default:\n        res = reducer(state && state.present, action);\n\n        if (config.initTypes.some(function (actionType) {\n          return actionType === action.type;\n        })) {\n          debug('reset history due to init action');\n          debugEnd();\n          return wrapState(_extends({}, state, createHistory(res)));\n        }\n\n        if (config.filter && typeof config.filter === 'function') {\n          if (!config.filter(action, res, state && state.present)) {\n            debug('filter prevented action, not storing it');\n            debugEnd();\n            return wrapState(_extends({}, state, {\n              present: res\n            }));\n          }\n        }\n\n        var history = state && state.present !== undefined ? state : config.history;\n        var updatedHistory = insert(history, res, config.limit);\n        debug('after insert', { history: updatedHistory, free: config.limit - length(updatedHistory) });\n        debugEnd();\n\n        return wrapState(_extends({}, state, updatedHistory));\n    }\n  };\n}\n// /redux-undo\n\n// distinctState helper\nfunction distinctState() {\n  return function (action, currentState, previousState) {\n    return currentState !== previousState;\n  };\n}\n// /distinctState\n\n// includeAction helper\nfunction includeAction(rawActions) {\n  var actions = parseActions(rawActions);\n  return function (action) {\n    return actions.indexOf(action.type) >= 0;\n  };\n}\n// /includeAction\n\n// deprecated ifAction helper\nfunction ifAction(rawActions) {\n  console.error('Deprecation Warning: Please change `ifAction` to `includeAction`');\n  return includeAction(rawActions);\n}\n// /ifAction\n\n// excludeAction helper\nfunction excludeAction() {\n  var rawActions = arguments.length <= 0 || arguments[0] === undefined ? [] : arguments[0];\n\n  var actions = parseActions(rawActions);\n  return function (action) {\n    return actions.indexOf(action.type) < 0;\n  };\n}\n// /excludeAction","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport compose from './compose';\n\n/**\n * Creates a store enhancer that applies middleware to the dispatch method\n * of the Redux store. This is handy for a variety of tasks, such as expressing\n * asynchronous actions in a concise manner, or logging every action payload.\n *\n * See `redux-thunk` package as an example of the Redux middleware.\n *\n * Because middleware is potentially asynchronous, this should be the first\n * store enhancer in the composition chain.\n *\n * Note that each middleware will be given the `dispatch` and `getState` functions\n * as named arguments.\n *\n * @param {...Function} middlewares The middleware chain to be applied.\n * @returns {Function} A store enhancer applying the middleware.\n */\nexport default function applyMiddleware() {\n  for (var _len = arguments.length, middlewares = Array(_len), _key = 0; _key < _len; _key++) {\n    middlewares[_key] = arguments[_key];\n  }\n\n  return function (createStore) {\n    return function (reducer, preloadedState, enhancer) {\n      var store = createStore(reducer, preloadedState, enhancer);\n      var _dispatch = store.dispatch;\n      var chain = [];\n\n      var middlewareAPI = {\n        getState: store.getState,\n        dispatch: function dispatch(action) {\n          return _dispatch(action);\n        }\n      };\n      chain = middlewares.map(function (middleware) {\n        return middleware(middlewareAPI);\n      });\n      _dispatch = compose.apply(undefined, chain)(store.dispatch);\n\n      return _extends({}, store, {\n        dispatch: _dispatch\n      });\n    };\n  };\n}","function bindActionCreator(actionCreator, dispatch) {\n  return function () {\n    return dispatch(actionCreator.apply(undefined, arguments));\n  };\n}\n\n/**\n * Turns an object whose values are action creators, into an object with the\n * same keys, but with every function wrapped into a `dispatch` call so they\n * may be invoked directly. This is just a convenience method, as you can call\n * `store.dispatch(MyActionCreators.doSomething())` yourself just fine.\n *\n * For convenience, you can also pass a single function as the first argument,\n * and get a function in return.\n *\n * @param {Function|Object} actionCreators An object whose values are action\n * creator functions. One handy way to obtain it is to use ES6 `import * as`\n * syntax. You may also pass a single function.\n *\n * @param {Function} dispatch The `dispatch` function available on your Redux\n * store.\n *\n * @returns {Function|Object} The object mimicking the original object, but with\n * every action creator wrapped into the `dispatch` call. If you passed a\n * function as `actionCreators`, the return value will also be a single\n * function.\n */\nexport default function bindActionCreators(actionCreators, dispatch) {\n  if (typeof actionCreators === 'function') {\n    return bindActionCreator(actionCreators, dispatch);\n  }\n\n  if (typeof actionCreators !== 'object' || actionCreators === null) {\n    throw new Error('bindActionCreators expected an object or a function, instead received ' + (actionCreators === null ? 'null' : typeof actionCreators) + '. ' + 'Did you write \"import ActionCreators from\" instead of \"import * as ActionCreators from\"?');\n  }\n\n  var keys = Object.keys(actionCreators);\n  var boundActionCreators = {};\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var actionCreator = actionCreators[key];\n    if (typeof actionCreator === 'function') {\n      boundActionCreators[key] = bindActionCreator(actionCreator, dispatch);\n    }\n  }\n  return boundActionCreators;\n}","import { ActionTypes } from './createStore';\nimport isPlainObject from 'lodash-es/isPlainObject';\nimport warning from './utils/warning';\n\nfunction getUndefinedStateErrorMessage(key, action) {\n  var actionType = action && action.type;\n  var actionName = actionType && '\"' + actionType.toString() + '\"' || 'an action';\n\n  return 'Given action ' + actionName + ', reducer \"' + key + '\" returned undefined. ' + 'To ignore an action, you must explicitly return the previous state. ' + 'If you want this reducer to hold no value, you can return null instead of undefined.';\n}\n\nfunction getUnexpectedStateShapeWarningMessage(inputState, reducers, action, unexpectedKeyCache) {\n  var reducerKeys = Object.keys(reducers);\n  var argumentName = action && action.type === ActionTypes.INIT ? 'preloadedState argument passed to createStore' : 'previous state received by the reducer';\n\n  if (reducerKeys.length === 0) {\n    return 'Store does not have a valid reducer. Make sure the argument passed ' + 'to combineReducers is an object whose values are reducers.';\n  }\n\n  if (!isPlainObject(inputState)) {\n    return 'The ' + argumentName + ' has unexpected type of \"' + {}.toString.call(inputState).match(/\\s([a-z|A-Z]+)/)[1] + '\". Expected argument to be an object with the following ' + ('keys: \"' + reducerKeys.join('\", \"') + '\"');\n  }\n\n  var unexpectedKeys = Object.keys(inputState).filter(function (key) {\n    return !reducers.hasOwnProperty(key) && !unexpectedKeyCache[key];\n  });\n\n  unexpectedKeys.forEach(function (key) {\n    unexpectedKeyCache[key] = true;\n  });\n\n  if (unexpectedKeys.length > 0) {\n    return 'Unexpected ' + (unexpectedKeys.length > 1 ? 'keys' : 'key') + ' ' + ('\"' + unexpectedKeys.join('\", \"') + '\" found in ' + argumentName + '. ') + 'Expected to find one of the known reducer keys instead: ' + ('\"' + reducerKeys.join('\", \"') + '\". Unexpected keys will be ignored.');\n  }\n}\n\nfunction assertReducerShape(reducers) {\n  Object.keys(reducers).forEach(function (key) {\n    var reducer = reducers[key];\n    var initialState = reducer(undefined, { type: ActionTypes.INIT });\n\n    if (typeof initialState === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined during initialization. ' + 'If the state passed to the reducer is undefined, you must ' + 'explicitly return the initial state. The initial state may ' + 'not be undefined. If you don\\'t want to set a value for this reducer, ' + 'you can use null instead of undefined.');\n    }\n\n    var type = '@@redux/PROBE_UNKNOWN_ACTION_' + Math.random().toString(36).substring(7).split('').join('.');\n    if (typeof reducer(undefined, { type: type }) === 'undefined') {\n      throw new Error('Reducer \"' + key + '\" returned undefined when probed with a random type. ' + ('Don\\'t try to handle ' + ActionTypes.INIT + ' or other actions in \"redux/*\" ') + 'namespace. They are considered private. Instead, you must return the ' + 'current state for any unknown actions, unless it is undefined, ' + 'in which case you must return the initial state, regardless of the ' + 'action type. The initial state may not be undefined, but can be null.');\n    }\n  });\n}\n\n/**\n * Turns an object whose values are different reducer functions, into a single\n * reducer function. It will call every child reducer, and gather their results\n * into a single state object, whose keys correspond to the keys of the passed\n * reducer functions.\n *\n * @param {Object} reducers An object whose values correspond to different\n * reducer functions that need to be combined into one. One handy way to obtain\n * it is to use ES6 `import * as reducers` syntax. The reducers may never return\n * undefined for any action. Instead, they should return their initial state\n * if the state passed to them was undefined, and the current state for any\n * unrecognized action.\n *\n * @returns {Function} A reducer function that invokes every reducer inside the\n * passed object, and builds a state object with the same shape.\n */\nexport default function combineReducers(reducers) {\n  var reducerKeys = Object.keys(reducers);\n  var finalReducers = {};\n  for (var i = 0; i < reducerKeys.length; i++) {\n    var key = reducerKeys[i];\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof reducers[key] === 'undefined') {\n        warning('No reducer provided for key \"' + key + '\"');\n      }\n    }\n\n    if (typeof reducers[key] === 'function') {\n      finalReducers[key] = reducers[key];\n    }\n  }\n  var finalReducerKeys = Object.keys(finalReducers);\n\n  var unexpectedKeyCache = void 0;\n  if (process.env.NODE_ENV !== 'production') {\n    unexpectedKeyCache = {};\n  }\n\n  var shapeAssertionError = void 0;\n  try {\n    assertReducerShape(finalReducers);\n  } catch (e) {\n    shapeAssertionError = e;\n  }\n\n  return function combination() {\n    var state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var action = arguments[1];\n\n    if (shapeAssertionError) {\n      throw shapeAssertionError;\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      var warningMessage = getUnexpectedStateShapeWarningMessage(state, finalReducers, action, unexpectedKeyCache);\n      if (warningMessage) {\n        warning(warningMessage);\n      }\n    }\n\n    var hasChanged = false;\n    var nextState = {};\n    for (var _i = 0; _i < finalReducerKeys.length; _i++) {\n      var _key = finalReducerKeys[_i];\n      var reducer = finalReducers[_key];\n      var previousStateForKey = state[_key];\n      var nextStateForKey = reducer(previousStateForKey, action);\n      if (typeof nextStateForKey === 'undefined') {\n        var errorMessage = getUndefinedStateErrorMessage(_key, action);\n        throw new Error(errorMessage);\n      }\n      nextState[_key] = nextStateForKey;\n      hasChanged = hasChanged || nextStateForKey !== previousStateForKey;\n    }\n    return hasChanged ? nextState : state;\n  };\n}","/**\n * Composes single-argument functions from right to left. The rightmost\n * function can take multiple arguments as it provides the signature for\n * the resulting composite function.\n *\n * @param {...Function} funcs The functions to compose.\n * @returns {Function} A function obtained by composing the argument functions\n * from right to left. For example, compose(f, g, h) is identical to doing\n * (...args) => f(g(h(...args))).\n */\n\nexport default function compose() {\n  for (var _len = arguments.length, funcs = Array(_len), _key = 0; _key < _len; _key++) {\n    funcs[_key] = arguments[_key];\n  }\n\n  if (funcs.length === 0) {\n    return function (arg) {\n      return arg;\n    };\n  }\n\n  if (funcs.length === 1) {\n    return funcs[0];\n  }\n\n  return funcs.reduce(function (a, b) {\n    return function () {\n      return a(b.apply(undefined, arguments));\n    };\n  });\n}","import isPlainObject from 'lodash-es/isPlainObject';\nimport $$observable from 'symbol-observable';\n\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\nexport var ActionTypes = {\n  INIT: '@@redux/INIT'\n\n  /**\n   * Creates a Redux store that holds the state tree.\n   * The only way to change the data in the store is to call `dispatch()` on it.\n   *\n   * There should only be a single store in your app. To specify how different\n   * parts of the state tree respond to actions, you may combine several reducers\n   * into a single reducer function by using `combineReducers`.\n   *\n   * @param {Function} reducer A function that returns the next state tree, given\n   * the current state tree and the action to handle.\n   *\n   * @param {any} [preloadedState] The initial state. You may optionally specify it\n   * to hydrate the state from the server in universal apps, or to restore a\n   * previously serialized user session.\n   * If you use `combineReducers` to produce the root reducer function, this must be\n   * an object with the same shape as `combineReducers` keys.\n   *\n   * @param {Function} [enhancer] The store enhancer. You may optionally specify it\n   * to enhance the store with third-party capabilities such as middleware,\n   * time travel, persistence, etc. The only store enhancer that ships with Redux\n   * is `applyMiddleware()`.\n   *\n   * @returns {Store} A Redux store that lets you read the state, dispatch actions\n   * and subscribe to changes.\n   */\n};export default function createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error('Expected the enhancer to be a function.');\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error('Expected the reducer to be a function.');\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n  function getState() {\n    return currentState;\n  }\n\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error('Expected listener to be a function.');\n    }\n\n    var isSubscribed = true;\n\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      isSubscribed = false;\n\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n    };\n  }\n\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing what changed. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error('Actions must be plain objects. ' + 'Use custom middleware for async actions.');\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error('Actions may not have an undefined \"type\" property. ' + 'Have you misspelled a constant?');\n    }\n\n    if (isDispatching) {\n      throw new Error('Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error('Expected the nextReducer to be a function.');\n    }\n\n    currentReducer = nextReducer;\n    dispatch({ type: ActionTypes.INIT });\n  }\n\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object') {\n          throw new TypeError('Expected the observer to be an object.');\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return { unsubscribe: unsubscribe };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  }\n\n  // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n  dispatch({ type: ActionTypes.INIT });\n\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}","import createStore from './createStore';\nimport combineReducers from './combineReducers';\nimport bindActionCreators from './bindActionCreators';\nimport applyMiddleware from './applyMiddleware';\nimport compose from './compose';\nimport warning from './utils/warning';\n\n/*\n* This is a dummy function to check if the function name has been altered by minification.\n* If the function has been minified and NODE_ENV !== 'production', warn the user.\n*/\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \\'production\\'. ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or DefinePlugin for webpack (http://stackoverflow.com/questions/30030031) ' + 'to ensure you have the correct code for your production build.');\n}\n\nexport { createStore, combineReducers, bindActionCreators, applyMiddleware, compose };","/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\nexport default function warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n    /* eslint-disable no-empty */\n  } catch (e) {}\n  /* eslint-enable no-empty */\n}","/* global window */\nimport ponyfill from './ponyfill.js';\n\nvar root;\n\nif (typeof self !== 'undefined') {\n  root = self;\n} else if (typeof window !== 'undefined') {\n  root = window;\n} else if (typeof global !== 'undefined') {\n  root = global;\n} else if (typeof module !== 'undefined') {\n  root = module;\n} else {\n  root = Function('return this')();\n}\n\nvar result = ponyfill(root);\nexport default result;\n","export default function symbolObservablePonyfill(root) {\n\tvar result;\n\tvar Symbol = root.Symbol;\n\n\tif (typeof Symbol === 'function') {\n\t\tif (Symbol.observable) {\n\t\t\tresult = Symbol.observable;\n\t\t} else {\n\t\t\tresult = Symbol('observable');\n\t\t\tSymbol.observable = result;\n\t\t}\n\t} else {\n\t\tresult = '@@observable';\n\t}\n\n\treturn result;\n};\n","(function(module) {\n    'use strict';\n\n    module.exports.is_uri = is_iri;\n    module.exports.is_http_uri = is_http_iri;\n    module.exports.is_https_uri = is_https_iri;\n    module.exports.is_web_uri = is_web_iri;\n    // Create aliases\n    module.exports.isUri = is_iri;\n    module.exports.isHttpUri = is_http_iri;\n    module.exports.isHttpsUri = is_https_iri;\n    module.exports.isWebUri = is_web_iri;\n\n\n    // private function\n    // internal URI spitter method - direct from RFC 3986\n    var splitUri = function(uri) {\n        var splitted = uri.match(/(?:([^:\\/?#]+):)?(?:\\/\\/([^\\/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?/);\n        return splitted;\n    };\n\n    function is_iri(value) {\n        if (!value) {\n            return;\n        }\n\n        // check for illegal characters\n        if (/[^a-z0-9\\:\\/\\?\\#\\[\\]\\@\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=\\.\\-\\_\\~\\%]/i.test(value)) return;\n\n        // check for hex escapes that aren't complete\n        if (/%[^0-9a-f]/i.test(value)) return;\n        if (/%[0-9a-f](:?[^0-9a-f]|$)/i.test(value)) return;\n\n        var splitted = [];\n        var scheme = '';\n        var authority = '';\n        var path = '';\n        var query = '';\n        var fragment = '';\n        var out = '';\n\n        // from RFC 3986\n        splitted = splitUri(value);\n        scheme = splitted[1]; \n        authority = splitted[2];\n        path = splitted[3];\n        query = splitted[4];\n        fragment = splitted[5];\n\n        // scheme and path are required, though the path can be empty\n        if (!(scheme && scheme.length && path.length >= 0)) return;\n\n        // if authority is present, the path must be empty or begin with a /\n        if (authority && authority.length) {\n            if (!(path.length === 0 || /^\\//.test(path))) return;\n        } else {\n            // if authority is not present, the path must not start with //\n            if (/^\\/\\//.test(path)) return;\n        }\n\n        // scheme must begin with a letter, then consist of letters, digits, +, ., or -\n        if (!/^[a-z][a-z0-9\\+\\-\\.]*$/.test(scheme.toLowerCase()))  return;\n\n        // re-assemble the URL per section 5.3 in RFC 3986\n        out += scheme + ':';\n        if (authority && authority.length) {\n            out += '//' + authority;\n        }\n\n        out += path;\n\n        if (query && query.length) {\n            out += '?' + query;\n        }\n\n        if (fragment && fragment.length) {\n            out += '#' + fragment;\n        }\n\n        return out;\n    }\n\n    function is_http_iri(value, allowHttps) {\n        if (!is_iri(value)) {\n            return;\n        }\n\n        var splitted = [];\n        var scheme = '';\n        var authority = '';\n        var path = '';\n        var port = '';\n        var query = '';\n        var fragment = '';\n        var out = '';\n\n        // from RFC 3986\n        splitted = splitUri(value);\n        scheme = splitted[1]; \n        authority = splitted[2];\n        path = splitted[3];\n        query = splitted[4];\n        fragment = splitted[5];\n\n        if (!scheme)  return;\n\n        if(allowHttps) {\n            if (scheme.toLowerCase() != 'https') return;\n        } else {\n            if (scheme.toLowerCase() != 'http') return;\n        }\n\n        // fully-qualified URIs must have an authority section that is\n        // a valid host\n        if (!authority) {\n            return;\n        }\n\n        // enable port component\n        if (/:(\\d+)$/.test(authority)) {\n            port = authority.match(/:(\\d+)$/)[0];\n            authority = authority.replace(/:\\d+$/, '');\n        }\n\n        out += scheme + ':';\n        out += '//' + authority;\n        \n        if (port) {\n            out += port;\n        }\n        \n        out += path;\n        \n        if(query && query.length){\n            out += '?' + query;\n        }\n\n        if(fragment && fragment.length){\n            out += '#' + fragment;\n        }\n        \n        return out;\n    }\n\n    function is_https_iri(value) {\n        return is_http_iri(value, true);\n    }\n\n    function is_web_iri(value) {\n        return (is_http_iri(value) || is_https_iri(value));\n    }\n\n})(module);\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","const editors = [];\nconst validators = [];\n\nmodule.exports = {\n\n    editor: function (constructor) {\n        console.log(`register editor ${constructor.name}`);\n        editors.push(constructor);\n    },\n\n    // format validator\n    validator: function (keyword, value, validator) {\n        validators.push([\"format\", value, validator]);\n    },\n\n    keywordValidator: function (datatype, property, validator) {\n        validators.push([\"keyword\", datatype, property, validator]);\n    },\n\n    getEditors: () => editors,\n    getValidators: () => validators\n};\n","const gp = require(\"gson-pointer\");\nconst mitt = require(\"mitt\");\nconst diffpatch = require(\"./utils/diffpatch\");\nconst copy = require(\"./utils/copy\");\nconst isRootPointer = require(\"./utils/isRootPointer\");\nconst dataReducer = require(\"./reducers/dataReducer\");\nconst ActionCreators = require(\"./reducers/actions\").ActionCreators;\nconst ActionTypes = require(\"./reducers/actions\").ActionTypes;\nconst getParentPointer = require(\"./utils/getParentPointer\");\nconst getTypeOf = require(\"json-schema-library/lib/getTypeOf\");\nconst getPatchesPerPointer = require(\"./utils/getPatchesPerPointer\");\n\nconst State = require(\"./State\");\nconst DEBUG = false;\n\n/**\n * @name DataService.EVENTS\n * @type {Object}\n * @property {String} BEFORE_UPDATE    - called before starting data update\n * @property {String} AFTER_UPDATE     - called after data udpate was performed\n */\nconst EVENTS = {\n    BEFORE_UPDATE: \"beforeUpdate\",\n    AFTER_UPDATE: \"afterUpdate\"\n};\n\n\n/**\n * Read and modify form data and notify observers\n *\n * @param {State} state     - current state/store of application\n * @param {Any} data        - current application data (form)\n */\nclass DataService {\n    constructor(state, data) {\n        if (!(state instanceof State)) {\n            throw new Error(\"Given state in DataService must be of instance 'State'\");\n        }\n\n        this.observers = {};\n        this.emitter = mitt();\n        this.EVENTS = EVENTS;\n\n        this.id = \"data\";\n        this.state = state;\n        this.state.register(this.id, dataReducer);\n\n        let lastUpdate = {};\n\n        // improved version - supporting multiple patches\n        this.onStateChanged = () => {\n            const current = this.state.get(this.id);\n            const patches = getPatchesPerPointer(lastUpdate, current.data.present);\n            if (patches.length === 0) {\n                DEBUG && console.info(\"DataService abort update event -- nothing changed\");\n                return;\n            }\n\n            DEBUG && console.log(\"Patch locations\", patches.map((delta) => delta.pointer));\n\n            for (let i = 0, l = patches.length; i < l; i += 1) {\n                const eventLocation = patches[i].pointer;\n                const parentData = this.getDataByReference(eventLocation);\n                const parentDataType = getTypeOf(parentData);\n                this.emit(EVENTS.AFTER_UPDATE, eventLocation, { type: parentDataType, patch: patches[i].patch });\n                this.bubbleObservers(eventLocation, { type: parentDataType, patch: patches[i].patch });\n            }\n\n            lastUpdate = current.data.present;\n        };\n\n        this.state.subscribe(this.id, this.onStateChanged);\n\n        if (data !== undefined) {\n            this.set(\"#\", data);\n            this.resetUndoRedo();\n        }\n    }\n\n    resetUndoRedo() {\n        this.state.get(this.id).data.past.length = 0;\n    }\n\n    destroy() {\n        this.state.unsubscribe(this.id, this.onStateChanged);\n        this.state.unregister(this.id);\n    }\n\n    /**\n     * Get a copy of current data from the requested _json-pointer_\n     * @param {JsonPointer} [pointer=\"#\"]  - data to fetch. Defaults to _root_\n     * @returns {Any} data, associated with _pointer_\n     */\n    get(pointer = \"#\") {\n        const value = this.getDataByReference(pointer);\n        return copy(value);\n    }\n\n    getDataByReference(pointer = \"#\") {\n        // eslint-disable-next-line no-invalid-this\n        return gp.get(this.state.get(this.id).data.present, pointer);\n    }\n\n    /**\n     * Change data at the given _pointer_\n     * @param {JsonPointer}  pointer    - data location to modify\n     * @param {Any}  value              - new value at pointer\n     * @param {Boolean} [isSynched]\n     */\n    set(pointer, value, isSynched = false) {\n        if (this.isValid(pointer) === false) {\n            throw new Error(`Pointer ${pointer} does not exist in data`);\n        }\n\n        const currentValue = this.getDataByReference(pointer);\n        if (diffpatch.diff(currentValue, value) == null) {\n            DEBUG && console.info(\"DataService abort update -- value not changed\");\n            return;\n        }\n\n        this.emit(EVENTS.BEFORE_UPDATE, pointer, { action: ActionTypes.DATA_SET, isSynched });\n        this.state.dispatch(ActionCreators.setData(pointer, value, currentValue, isSynched));\n\n        if (pointer === \"#\" && isSynched === false) {\n            // do not add root changes to undo\n            this.state.get(this.id).data.past.pop();\n        }\n    }\n\n    /**\n     * Delete data at the given _pointer_\n     * @param  {JsonPointer} pointer    - data location to delete\n     */\n    delete(pointer) {\n        if (isRootPointer(pointer)) {\n            throw new Error(\"Can not remove root data via delete. Use set(\\\"#/\\\", {}) instead.\");\n        }\n\n        const key = pointer.split(\"/\").pop();\n        const parentPointer = getParentPointer(pointer);\n        const data = this.get(parentPointer);\n\n        gp.delete(data, key);\n        this.set(parentPointer, data);\n    }\n\n    undoCount() {\n        return this.state.get(this.id).data.past.length;\n    }\n\n    redoCount() {\n        return this.state.get(this.id).data.future.length;\n    }\n\n    undo() {\n        this.emit(EVENTS.BEFORE_UPDATE, \"#\", { action: ActionTypes.UNDO });\n        this.state.dispatch(ActionCreators.undo());\n    }\n\n    redo() {\n        this.emit(EVENTS.BEFORE_UPDATE, \"#\", { action: ActionTypes.REDO });\n        this.state.dispatch(ActionCreators.redo());\n    }\n\n    on(eventType, callback) {\n        if (eventType === undefined) {\n            throw new Error(\"Missing event type in DataService.on\");\n        }\n        this.emitter.on(eventType, callback);\n        return callback;\n    }\n\n    off(...args) {\n        this.emitter.off(...args);\n    }\n\n    emit(eventType, pointer, data) {\n        this.emitter.emit(eventType, createEventObject(pointer, data));\n    }\n\n    observe(pointer, callback, bubbleEvents = false) {\n        callback.bubbleEvents = bubbleEvents;\n        this.observers[pointer] = this.observers[pointer] || [];\n        this.observers[pointer].push(callback);\n        return callback;\n    }\n\n    removeObserver(pointer, callback) {\n        if (this.observers[pointer] && this.observers[pointer].length > 0) {\n            this.observers[pointer] = this.observers[pointer].filter((cb) => cb !== callback);\n        }\n    }\n\n    notify(pointer, event) {\n        if (this.observers[pointer] == null || this.observers[pointer].length === 0) {\n            return;\n        }\n        const observers = this.observers[pointer];\n        for (let i = 0, l = observers.length; i < l; i += 1) {\n            if (observers[i].bubbleEvents === true || event.pointer === pointer) {\n                observers[i](event);\n            }\n        }\n    }\n\n    bubbleObservers(pointer, data) {\n        const eventObject = createEventObject(pointer, data);\n        const frags = gp.split(pointer);\n        while (frags.length) {\n            this.notify(gp.join(frags, true), eventObject);\n            frags.length -= 1;\n        }\n        this.notify(\"#\", eventObject);\n    }\n\n    isValid(pointer) {\n        return isRootPointer(pointer) || gp.get(this.getDataByReference(), pointer) !== undefined;\n    }\n}\n\n\nfunction createEventObject(pointer, data) {\n    const parentPointer = getParentPointer(pointer);\n    return Object.assign(data, {\n        pointer,\n        parentPointer\n    });\n}\n\n\nmodule.exports = DataService;\nmodule.exports.EVENTS = EVENTS;\n","/* global document */\nconst mitt = require(\"mitt\");\nconst gp = require(\"gson-pointer\");\nconst UIState = require(\"./uistate\");\nconst getId = require(\"../utils/getID\");\nconst DELAY = 25;\n\nconst emitter = mitt();\n\n\n/**\n * Register to page changes, target-pointer changes or to (re)scroll to the current pointer in view.\n *\n * The LocationService manages global pointer states and scroll position:\n *  - the \"current pointer\" tracks the currently focused editor and\n *  - the \"page pointer\" corresponds to the first property of \"current pointer\", which may be used for main page loading\n *\n * ### Motivation\n *\n * Jumping to specific editors via the navigation requires a targeting system. A page reload may occur for a called\n * anchor, and thus is scrolled into view async. In other cases the current view may be completely rebuilt which\n * resets the scroll position to top. A stored pointer (current) may be used to retrieve the scroll position.\n * named anchors fail when hash routes are present. Thus anchors are processed via javascript.\n *\n * @type {Object}\n */\nconst LocationService = {\n\n    PAGE_EVENT: \"page\",\n    TARGET_EVENT: \"target\",\n\n    // update page and target pointer\n    goto(targetPointer) {\n        const path = gp.split(targetPointer);\n\n        if (path.length === 0 || (path.length === 1 && path[0] === \"\")) {\n            return;\n        }\n\n        const nextPage = path[0];\n        const currentPage = UIState.getCurrentPage();\n        if (currentPage !== nextPage) {\n            UIState.setCurrentPage(gp.join(nextPage, true));\n        }\n        UIState.setCurrentPointer(gp.join(targetPointer, true));\n        this.focus();\n    },\n\n    // set target pointer\n    setCurrent(pointer) {\n        if (pointer !== this.getCurrent()) {\n            UIState.setCurrentPointer(pointer);\n            emitter.emit(\"focus\", pointer);\n        }\n    },\n\n    getCurrent() {\n        return UIState.getCurrentPointer();\n    },\n\n    // focus target pointer\n    focus() {\n        clearTimeout(this.timeout);\n        const pointer = UIState.getCurrentPointer();\n        const id = getId(pointer);\n        const targetElement = document.getElementById(id);\n        // console.log(`pointer ${pointer} - id ${id}`, targetElement);\n        if (targetElement == null) {\n            // console.log(`Location:focus - target ${pointer} (id ${id}) not found`);\n            return;\n        }\n        // const targetPosition = targetElement.getBoundingClientRect().top\n        this.timeout = setTimeout(() => {\n            // try scrolling to header-row in container (low height) to have a more robust scroll target position\n            let scrollTarget = targetElement.querySelector(\".editron-container > .editron-container__header\");\n            scrollTarget = (scrollTarget == null || scrollTarget.offsetParent === null) ? targetElement : scrollTarget;\n            scrollTarget.scrollIntoView();\n\n            // @todo only fire focus event?\n            targetElement.dispatchEvent(new Event(\"focus\"));\n            targetElement.focus && targetElement.focus();\n\n        }, DELAY);\n    },\n\n    blur(pointer) {\n        if (UIState.getCurrentPointer() !== pointer) {\n            return;\n        }\n        UIState.setCurrentPointer(\"\");\n        emitter.emit(\"blur\", pointer);\n    },\n\n    on: (...args) => emitter.on(...args),\n    off: (...args) => emitter.off(...args)\n};\n\nUIState.on(UIState.EVENTS.CURRENT_PAGE_EVENT, (pointer) => emitter.emit(LocationService.PAGE_EVENT, pointer));\nUIState.on(UIState.EVENTS.CURRENT_POINTER_EVENT, (pointer) => emitter.emit(LocationService.TARGET_EVENT, pointer));\n\n\nmodule.exports = LocationService;\n","/* global document */\n/* eslint no-use-before-define: 0 */\nconst m = require(\"mithril\");\nconst Overlay = require(\"../components/overlay\");\nconst createElement = require(\"../utils/createElement\");\nconst UIState = require(\"./uistate\");\n\n\nUIState.on(UIState.EVENTS.OVERLAY_EVENT, (value = {}) => OverlayService.onChange(value.element, value.options));\n\n\n/**\n * Opens an overlay with a DOM-Node as contents\n * @type {Object}\n */\nconst OverlayService = {\n\n    /**\n     * Opens the overlay, showing the given `container` as conten\n     *\n     * Options\n     *  {Boolean} ok            - display `ok`, instead of `abort`\n     *  {Boolean} fullscreen    - fullscreen size of overlay, regardless of content\n     *  {Function} onAbort      - called when Overlay is closed via ok/abort\n     *  {Function} onSave       - called when Overlay is closed via save\n     *\n     * @param  {HTMLElement} container\n     * @param  {Obejct} options\n     */\n    open(container, options) {\n        UIState.setOverlay({\n            element: container,\n            options: Object.assign({\n                ok: false,\n                save: true,\n                fullscreen: false,\n                onAbort: Function.prototype,\n                onSave: Function.prototype\n            }, options)\n        });\n    },\n\n    close() {\n        UIState.setOverlay();\n        // must destroy component for reuse\n        m.render(this.getElement(), m(\"i\"));\n    },\n\n    onChange(container, options) {\n        if (container == null) {\n            const $el = this.getElement();\n            $el.parentNode && $el.parentNode.removeChild($el);\n            return;\n        }\n\n        const $el = this.getElement();\n        container.classList.add(\"overlay__item\");\n        m.render($el,\n            m(Overlay, {\n                container,\n                fullscreen: options.fullscreen,\n                showSave: options.save,\n                titleAbort: options.ok ? \"OK\" : \"Abbrechen\",\n                onSave: () => {\n                    options.onSave();\n                    this.close();\n                },\n                onAbort: () => this.close(), // calls onremove -> onAbort\n                onremove: () => options.onAbort()\n            })\n        );\n\n        document.body.appendChild($el);\n    },\n\n    getElement() {\n        if (this.$element == null) {\n            this.$element = createElement(\".ui-overlay\");\n            this.$element.addEventListener(\"click\", (e) => {\n                // close popup if clicked on \"background\"\n                if (e.target === this.$element) {\n                    this.close();\n                }\n            });\n        }\n        return this.$element;\n    }\n};\n\n\nmodule.exports = OverlayService;\n","const Core = require(\"json-schema-library\").cores.JsonEditor;\nconst copy = require(\"./utils/copy\");\nconst jsl = require(\"json-schema-library\");\nconst getChildSchemaSelection = require(\"json-schema-library\").getChildSchemaSelection;\n\n\n /**\n  * Manages json-schema interactions and adds caching of reoccuring json-schema requests\n  *\n  * @param {Object} schema       - json-schema\n  * @param {Object} [data={}]    - data corresponding to json-schema\n  * @param {Core} [core={}]      - instance of json-schema-library Core\n  */\nclass SchemaService {\n\n\n    constructor(schema = {}, data = {}, core = new Core()) {\n        this.core = core;\n        this.setSchema(schema);\n        this.setData(data);\n    }\n\n    /**\n     * Update data by any missing (default) values specified in the json-schema\n     * @param {Object} [data=currentData]   - update given data or use the internal stored data (via `setData(data)`)\n     * @param {Object} [schema]             - specific json schema, or the internal store schema (via `setSchema(root)`)\n     * @return {Any} json data with valid default data values\n     */\n    addDefaultData(data = this.data, schema = this.schema) {\n        return this.core.getTemplate(schema, data);\n    }\n\n    /**\n     * Create the template data object based on the json-schema, which fullfills the schemas structure as much as\n     * possible\n     * @param  {Object} schema\n     * @return {Any} data corresponding to json-schema\n     */\n    getTemplate(schema) {\n        return this.core.getTemplate(schema);\n    }\n\n    /**\n     * @param  {JsonPointer} pointer\n     * @param  {String|Number} property\n     * @return {Array} list of valid items to insert at the given position\n     */\n    getChildSchemaSelection(pointer, property) {\n        const parentSchema = this.get(pointer);\n        return getChildSchemaSelection(this.core, parentSchema, property);\n    }\n\n    /**\n     * Sets the root data. This is optional and used within internal functions to support optional _data_-parameters.\n     * On every change in data, call this method with that latest state `schemaService.setData(latestData)`;\n     *\n     * @param {Any} data    - latest root data corresponding to stored json-schema\n     */\n    setData(data) {\n        this.data = this.addDefaultData(data);\n        this.resetCache();\n    }\n\n    /**\n     * Set or change the application schema\n     * @param {Object} schema\n     */\n    setSchema(schema) {\n        this.core.setSchema(schema);\n        this.schema = this.core.rootSchema;\n        this.resetCache();\n    }\n\n    resetCache() {\n        this.cache = {};\n    }\n\n    /**\n     * Return the json-schema for the requested pointer. Resolved the pointer on the stored schema by the accompanied\n     * json-data, which is required to resolve optional json-schema values.\n     *\n     * @param  {JsonPointer} pointer    - pointer in data\n     * @param  {Any} [data]             - root data, corresponding to json-schema. This is optional, when the root-data\n     *                                       is up-to-date (via setData)\n     * @return {Object} json-schema for the requested pointer\n     */\n    get(pointer, data) {\n        if (data) {\n            const result = jsl.getSchema(this.core, this.schema, data, pointer);\n            return copy(result);\n        }\n\n        if (this.cache[pointer] === undefined) {\n            const result = jsl.getSchema(this.core, this.schema, this.data, pointer);\n            if (result.variableSchema === true) {\n                // @special case: do not cache dynamic schema object (oneOf)\n                return result;\n            }\n            this.cache[pointer] = copy(result);\n        }\n\n        return this.cache[pointer];\n    }\n\n    destroy() {\n        this.setData(null);\n        this.setSchema(null);\n    }\n}\n\n\nmodule.exports = SchemaService;\n","/* global localStorage */\n\n\n/**\n * Simple session service to store and retrieve user-specific data\n * @type {Object}\n */\nmodule.exports = {\n    get(key, defaultValue) {\n        if (window.localStorage == null) {\n            return defaultValue;\n        }\n\n        if (localStorage.getItem(key) == null) {\n            this.set(key, defaultValue);\n        }\n        try {\n            return JSON.parse(localStorage.getItem(key));\n        } catch(error) {\n            return defaultValue;\n        }\n\n    },\n    set(key, value) {\n        if (window.localStorage) {\n            localStorage.setItem(key, JSON.stringify(value));\n        }\n    },\n    toggle(key) {\n        const value = !this.get(key, false);\n        this.set(key, value);\n        return value;\n    }\n};\n","const redux = require(\"redux\");\nconst mitt = require(\"mitt\");\nconst FLAG_CHANGED = \"hasChanged\";\n\n\nclass State {\n    constructor() {\n        this.FLAG_CHANGED = FLAG_CHANGED;\n\n        this.reducers = {\n            action: (state, action) => action\n        };\n        this.emitter = mitt();\n        this.store = redux.createStore(() => {}); // eslint-disable-line no-empty-function\n        this.store.subscribe(() => this.onChange(this.store.getState()));\n    }\n\n    onChange(currentState) {\n        Object\n            .keys(currentState)\n            .forEach((id) => {\n                const subState = currentState[id];\n                if (subState[FLAG_CHANGED] != null && subState[FLAG_CHANGED] !== false) {\n                    this.emitter.emit(id, subState);\n                }\n            });\n    }\n\n    // eslint-disable-next-line\n    // http://stackoverflow.com/questions/32968016/how-to-dynamically-load-reducers-for-code-splitting-in-a-redux-application\n    register(id, reducer) {\n        if (this.reducers[id]) {\n            throw new Error(`A reducer with id ${id} is already registered`);\n        }\n        this.reducers[id] = reducer;\n        this.store.replaceReducer(redux.combineReducers(this.reducers));\n    }\n\n    unregister(id) {\n        // @todo either remove reducers and data or make them reusable (per application id)\n        // delete this.reducers[id];\n        // this.store.replaceReducer(redux.combineReducers(this.reducers));\n        const currentState = this.store.getState();\n        delete currentState[id];\n    }\n\n    get(id) {\n        const currentState = this.store.getState();\n        return id == null ? currentState : currentState[id];\n    }\n\n    dispatch(...args) {\n        return this.store.dispatch(...args);\n    }\n\n    /**\n     * Subscribe to change (all) events\n     * @param  {[type]}   id       [description]\n     * @param  {Function} callback [description]\n     * @return {[type]}            [description]\n     */\n    subscribe(id, callback) {\n        if (typeof id !== \"string\" || typeof callback !== \"function\") {\n            throw new Error(`Invalid arguments for state.subscribe ${arguments}`);\n        }\n\n        const state = this.store.getState();\n        if (state[id] && state[id][FLAG_CHANGED] != null) {\n            this.emitter.on(id, callback);\n        } else {\n            throw new Error(`Could not subscribe to state ${id}. Property ${FLAG_CHANGED} not available`);\n        }\n    }\n\n    unsubscribe(id, callback) {\n        if (typeof id !== \"string\" || typeof callback !== \"function\") {\n            throw new Error(`Invalid arguments for state.unsubscribe ${arguments}`);\n        }\n\n        this.emitter.off(id, callback);\n    }\n}\n\nState.FLAG_CHANGED = FLAG_CHANGED;\n\n\nmodule.exports = State;\n","const mitt = require(\"mitt\");\nconst Core = require(\"json-schema-library\").cores.JsonEditor;\nconst State = require(\"./State\");\nconst ActionCreators = require(\"./reducers/actions\").ActionCreators;\nconst errorReducer = require(\"./reducers/errorReducer\");\nconst Validation = require(\"./utils/Validation\");\nconst BubblingCollectionObservable = require(\"./utils/BubblingCollectionObservable\");\n\n\nconst EVENTS = {\n    BEFORE_VALIDATION: \"beforeValidation\",\n    AFTER_VALIDATION: \"afterValidation\",\n    ON_ERROR: \"onError\"\n};\n\n\n/**\n * @class  ValidationService\n */\nclass ValidationService {\n\n    constructor(state, schema = {}, core = new Core()) {\n        if (!(state instanceof State)) {\n            throw new Error(\"Given state in ValidationService must be of instance 'State'\");\n        }\n\n        this.core = core;\n        this.set(schema);\n        this.observer = new BubblingCollectionObservable();\n        this.emitter = mitt();\n        this.id = \"errors\";\n        this.state = state;\n        this.state.register(this.id, errorReducer);\n        this.setErrorHandler((error) => error);\n        this.EVENTS = EVENTS;\n    }\n\n    setErrorHandler(callback) {\n        this.errorHandler = callback;\n    }\n\n    /**\n     * Starts the validation, executing callback handlers and emitters on the go\n     *\n     * @param  {Any} data               - data to validate\n     * @param  {JsonSchema} [schema]    - optional json-schema. Per default the root schema is used\n     * @return {Promise} promise, resolving with list of errors when all async validations are performed\n     */\n    validate(data, schema = this.schema) {\n        if (this.currentValidation) {\n            this.currentValidation.cancel();\n        }\n\n        this.emit(EVENTS.BEFORE_VALIDATION);\n        this.observer.reset();\n        this.state.dispatch(ActionCreators.setErrors([]));\n        this.currentValidation = new Validation(data, schema, this.errorHandler);\n\n        return this.currentValidation.start(\n            this.core,\n            (newError, currentErrors) => {\n                this.state.dispatch(ActionCreators.setErrors(currentErrors));\n                this.observer.notify(newError.data.pointer, newError);\n                this.emit(EVENTS.ON_ERROR, newError);\n            },\n            (validationErrors) => {\n                this.state.dispatch(ActionCreators.setErrors(validationErrors));\n                this.emit(EVENTS.AFTER_VALIDATION, validationErrors);\n                this.currentValidation = null;\n            }\n        );\n    }\n\n    set(schema) {\n        this.schema = schema;\n        this.core.setSchema(schema);\n    }\n\n    get() {\n        return this.schema;\n    }\n\n    on(eventType, callback) {\n        if (eventType === undefined) {\n            throw new Error(\"Missing event type in ValidationService.on\");\n        }\n        this.emitter.on(eventType, callback);\n        return callback;\n    }\n\n    off(...args) {\n        this.emitter && this.emitter.off(...args);\n    }\n\n    emit(eventType, event = {}) {\n        this.emitter.emit(eventType, event);\n    }\n\n    observe(pointer, callback, bubbledEvents = false) {\n        this.observer.observe(pointer, callback, bubbledEvents);\n        return callback;\n    }\n\n    removeObserver(pointer, callback) {\n        this.observer.removeObserver(pointer, callback);\n    }\n\n    notify(pointer, event = {}) {\n        this.observer.notify(pointer, event);\n    }\n\n    getErrorsAndWarnings(pointer = undefined, withChildErrors = false) {\n        const errors = this.state.get(this.id) || [];\n        if (pointer == null) {\n            return errors;\n        }\n        // filter by pointer\n        const selectError = new RegExp(`^${pointer}${withChildErrors ? \"\" : \"$\"}`);\n        return errors.filter((error) => selectError.test(error.data.pointer));\n    }\n\n    getErrors(pointer = undefined, withChildErrors = false) {\n        return this.getErrorsAndWarnings(pointer, withChildErrors).filter((error) => error.severity !== \"warning\");\n    }\n\n    getWarnings(pointer = undefined, withChildWarnings = false) {\n        return this.getErrorsAndWarnings(pointer, withChildWarnings).filter((error) => error.severity === \"warning\");\n    }\n\n    destroy() {\n        this.set(null);\n        this.emitter = null;\n        this.observer = null;\n        this.state.unregister(this.id, errorReducer);\n    }\n}\n\n\nmodule.exports = ValidationService;\nmodule.exports.EVENTS = EVENTS;\n","module.exports = {\n    LocationService: require(\"./LocationService\"),\n    OverlayService: require(\"./OverlayService\"),\n    SessionService: require(\"./SessionService\"),\n    UIState: require(\"./uistate\")\n};\n","/* eslint object-property-newline: 0 */\nconst UndoActionCreators = require(\"redux-undo\").ActionCreators;\nconst UndoActionTypes = require(\"redux-undo\").ActionTypes;\n\nconst ActionTypes = {\n    // data\n    DATA_SET: \"DATA_SET\",\n    UNDO: UndoActionTypes.UNDO,\n    REDO: UndoActionTypes.REDO,\n    // validation\n    ERRORS_SET: \"ERRORS_SET\"\n};\n\nconst ActionCreators = {\n    setData(pointer, newValue, prevValue, isSynched = false) {\n        return { type: ActionTypes.DATA_SET, pointer, value: newValue, prevValue, isSynched };\n    },\n    undo() {\n        return UndoActionCreators.undo();\n    },\n    redo() {\n        return UndoActionCreators.redo();\n    },\n    setErrors(errors = []) {\n        return { type: ActionTypes.ERRORS_SET, errors };\n    }\n};\n\n\nmodule.exports = {\n    ActionTypes,\n    ActionCreators\n};\n","const undoable = require(\"redux-undo\").default;\n\n/* eslint no-case-declarations: 0 */\nconst gp = require(\"gson-pointer\");\nconst copy = require(\"../utils/copy\");\nconst isRootPointer = require(\"../utils/isRootPointer\");\nconst ActionTypes = require(\"./actions\").ActionTypes;\nconst redux = require(\"redux\");\nconst ensureItemIDs = require(\"../utils/ensureItemIDs\");\n\n\nconst actions = [ActionTypes.DATA_SET, ActionTypes.UNDO, ActionTypes.REDO];\nconst defaultState = {\n    hasChanged: false,\n    action: null,\n    data: null\n};\n\nfunction dataReducer(state = defaultState, action) {\n    switch (action.type) {\n        case ActionTypes.DATA_SET:\n            if (isRootPointer(action.pointer)) {\n                return ensureItemIDs(copy(action.value));\n            }\n            const newState = copy(state);\n            gp.set(newState, action.pointer, copy(action.value));\n            return ensureItemIDs(newState);\n\n        default:\n            return state;\n    }\n}\n\nconst config = {\n    debug: false,\n    filter: (action) => actions.includes(action.type)\n};\n\n\nmodule.exports = redux.combineReducers({\n    hasChanged: (state, action) => actions.includes(action.type),\n    data: undoable(dataReducer, config)\n});\n","const ActionTypes = require(\"./actions\").ActionTypes;\n\n\nmodule.exports = function (state = [], action) {\n    return action.type === ActionTypes.ERRORS_SET ? action.errors : state;\n};\n","const ActionTypes = {\n    UI_PAGE_SET: \"UI_PAGE_SET\",\n    UI_OVERLAY_SET: \"UI_OVERLAY_SET\",\n    UI_CURRENT_SET: \"UI_CURRENT_SET\"\n};\n\nconst ActionCreators = {\n    setCurrentPage(pointer = \"#\") {\n        return {\n            type: ActionTypes.UI_PAGE_SET,\n            value: pointer\n        };\n    },\n    setCurrentPointer(pointer = \"#\") {\n        return {\n            type: ActionTypes.UI_CURRENT_SET,\n            value: pointer\n        };\n    },\n    setOverlay(content = false) {\n        return {\n            type: ActionTypes.UI_OVERLAY_SET,\n            value: content\n        };\n    }\n};\n\n\nmodule.exports = {\n    ActionTypes,\n    ActionCreators\n};\n","const mitt = require(\"mitt\");\nconst State = require(\"../State\");\nconst ActionCreators = require(\"./actions\").ActionCreators;\nconst uiReducer = require(\"./uiReducer\");\n\n\nconst EVENTS = {\n    OVERLAY_EVENT: \"overlay\",\n    CURRENT_POINTER_EVENT: \"current\",\n    CURRENT_PAGE_EVENT: \"page\"\n};\n\n\nclass UIState {\n\n    constructor() {\n        this.id = \"ui\";\n        this.state = new State();\n        this.emitter = mitt();\n        this.state.register(this.id, uiReducer);\n        // @todo: subscribe to state-changes and diff current state?\n    }\n\n    get(property) {\n        return this.state.get(this.id).ui[property];\n    }\n\n    getCurrentPointer() {\n        return this.get(\"currentPointer\");\n    }\n\n    getCurrentPage() {\n        return this.get(\"currentPage\");\n    }\n\n    setOverlay(content = false) {\n        const currentContent = this.get(\"overlay\");\n        if (currentContent !== content) {\n            this.state.dispatch(ActionCreators.setOverlay(content));\n            this.emitter.emit(EVENTS.OVERLAY_EVENT, this.get(\"overlay\"));\n        }\n    }\n\n    on(...args) { this.emitter.on(...args); }\n    off(...args) { this.emitter.off(...args); }\n\n    setCurrentPage(pointer) {\n        const currentPage = this.get(\"currentPage\");\n        if (currentPage !== pointer) {\n            this.state.dispatch(ActionCreators.setCurrentPage(pointer));\n            this.emitter.emit(EVENTS.CURRENT_PAGE_EVENT, this.get(\"currentPage\"));\n        }\n    }\n\n    setCurrentPointer(pointer) {\n        const currentPointer = this.get(\"currentPointer\");\n        if (currentPointer !== pointer) {\n            this.state.dispatch(ActionCreators.setCurrentPointer(pointer));\n            this.emitter.emit(EVENTS.CURRENT_POINTER_EVENT, this.get(\"currentPointer\"));\n        }\n    }\n}\n\nconst Singleton = new UIState();\nSingleton.UIStateContructor = UIState;\nSingleton.EVENTS = EVENTS;\n\nmodule.exports = Singleton;\n","const redux = require(\"redux\");\nconst ActionTypes = require(\"./actions\").ActionTypes;\n\nconst defaultState = {\n    hasChanged: false,\n    currentPage: \"#\",\n    currentPointer: \"#\",\n    overlay: false\n};\n\nfunction uiReducer(state = defaultState, action) {\n    switch (action.type) {\n        case ActionTypes.UI_PAGE_SET:\n            state = Object.assign({}, state);\n            state.currentPage = action.value;\n            return state;\n        case ActionTypes.UI_CURRENT_SET:\n            state = Object.assign({}, state);\n            state.currentPointer = action.value;\n            return state;\n        case ActionTypes.UI_OVERLAY_SET:\n            state = Object.assign({}, state);\n            state.overlay = action.value;\n            return state;\n        default:\n            return state;\n    }\n}\n\nfunction hasChanged(state = false, action) {\n    return ActionTypes[action.type] == null ? false : action.type;\n}\n\n\nmodule.exports = redux.combineReducers({\n    hasChanged,\n    ui: uiReducer\n});\n","/* eslint arrow-parens: 0 */\nconst gp = require(\"gson-pointer\");\n\n\n/**\n * > Internal helper, mainly used in [ValidationService](#validationservice) to support the weird notification behaviour\n * of error-events.\n *\n *\n * ### Motivation\n *\n * Error-events in the validation process occur per error, because we want them to pass as quickly as\n * possible (Asynchronous errors may take a long time and available instant feedback are postponed). In the previous\n * version two events were required in every editor\n *\n * 1. observing \"start validation\"-events to reset the errors and\n * 2. observing \"add error\"-events to build up the asynchronous incoming error-list\n *\n * This is tedious and brings some overhead using the api. Thus, the observe \"set error\"-event, introduced hereby\n * will collect the errors and repeatedly call the observer with the current, complete list of errors\n *\n * 1. for the observable and\n * 2. any observable that includes listening to changes of child-editors\n *\n *\n * ### Usage as observer\n *\n * An observer will receive an up-to-date version of all events occuring at the location\n *\n * ```js\n *  // init\n *  observable.observe(\"#/pointer/to/my/location\", (errors) => {\n *      // list of current errors, continously updated\n *      this.errors = errors;\n *      this.processErrors(); // or some such\n *  });\n *  ```\n *\n * or if you are interested in events occuring further down in data\n *\n * ```js\n *  // init\n *  observable.observe(\"#/pointer/to/my/location\", (errors) => {\n *      // list of current errors at location from pointer and further down within the data structure e.g.\n *      // \"#/pointer/to/my/location\", \"#/pointer/to/my/location/xy\", \"#/pointer/to/my/location/az/er\", etc\n *      continously updated\n *      this.errors = errors;\n *      this.processErrors(); // or some such\n *  }, true); // <- bubble events\n *  ```\n * and remove the event listener with\n *\n * ```js\n *  observable.observe(\"#/pointer/to/my/location\", myRegisteredCallbackFunction);\n * ```\n *\n * ### Usage as observable\n *\n * ```js\n *  // init\n *  this.observers = new BubblingCollectionObservable();\n *  // notify session\n *  this.observers.notify(\"#/pointer/to/location\", { event });\n *  // another notification\n *  this.observers.notify(\"#/pointer/to/any-location\", { event2 });\n *  // same target or if listening with the option `receiveChildEvents`, will receive\n *  [{ event }, { event2 }] // observable event\n *  // and reset session by\n *  this.observers.reset(); // any observers will be reset with an events receiving an empty list\n *  [] // observable event\n *  // sending another notification will notify the target with a new list of events\n *  this.observers.notify(\"#/pointer/to/any-location\", { event3 });\n *  [{ event3 }] // observable event\n * ```\n *\n *\n */\nclass BubblingCollectionObservable {\n    constructor() {\n        this.observers = {};\n        this.eventCollection = {};\n        this.bubbleCollection = {};\n    }\n\n    /**\n     * Observe events on the _pointer_ (`#/observe/location`). May also observe events of\n     * _child-pointers_ (`#/observe/location/child/item`) with the option `receiveChildEvents` set to `true`\n     *\n     * @param  {JsonPointer} pointer        - location to observe\n     * @param  {Function} cb                - observer\n     * @param  {Boolean}  [receiveChildEvents=false]\n     * @return {Function} callback cb\n     */\n    observe(pointer, cb, receiveChildEvents = false) {\n        this.observers[pointer] = this.observers[pointer] || [];\n        if (this.observers[pointer].includes(cb) === false) {\n            cb.receiveChildEvents = receiveChildEvents;\n            this.observers[pointer].push(cb);\n        }\n        return cb;\n    }\n\n    /**\n     * Remove an observer\n     * @param  {JsonPointer} pointer\n     * @param  {Function} cb\n     */\n    removeObserver(pointer, cb) {\n        if (this.observers[pointer] == null) {\n            return;\n        }\n        const index = this.observers[pointer].indexOf(cb);\n        if (index !== -1) {\n            this.observers[pointer].splice(index, 1);\n        }\n    }\n\n    /**\n     * Reset all collections from the previous events, starting with a list of empty events. Any previously called\n     * observers will be called again with an empty event-list `[]`.\n     */\n    reset() {\n        // notify observers of reset by sending an empty list of events\n        const map = {};\n        Object.keys(this.eventCollection).concat(Object.keys(this.bubbleCollection))\n            // .filter(pointer => pointer.includes(sourcePointer))\n            .forEach(p => { map[p] = true; });\n        this.eventCollection = {};\n        this.bubbleCollection = {};\n        Object.keys(map).forEach(pointer => this._notify(pointer, pointer, []));\n        this.eventCollection = {};\n        this.bubbleCollection = {};\n    }\n\n    /**\n     * Notify observers at _pointer_. Note that the received event is a aggregated event-list []. For a first call\n     * the received event will look like `[{ event }]` and the next event will be `[{ event }, { newEvent }]`, etc,\n     * until `reset()` ist called by the observable.\n     *\n     * @param  {JsonPointer} pointer\n     * @param  {Any} event\n     */\n    notify(pointer, event) {\n        this.eventCollection[pointer] = this.eventCollection[pointer] || [];\n        this.eventCollection[pointer].push(event);\n\n        const frags = gp.split(pointer);\n        while (frags.length > 0) {\n            const p = gp.join(frags, true);\n            this._notify(p, pointer, this.eventCollection[pointer]);\n            frags.pop();\n        }\n        this._notify(\"#\", pointer, this.eventCollection[pointer]);\n    }\n    _notify(observerPointer, sourcePointer, event) {\n        if (this.observers[observerPointer] == null) {\n            return;\n        }\n        this.observers[observerPointer].forEach(cb => {\n            if (cb.receiveChildEvents === false && observerPointer === sourcePointer) {\n                cb(event);\n                return;\n            }\n            if (cb.receiveChildEvents === false && observerPointer !== sourcePointer) {\n                return;\n            }\n\n            this.bubbleCollection[observerPointer] = this.bubbleCollection[observerPointer] || {};\n            const map = this.bubbleCollection[observerPointer];\n            map[sourcePointer] = event;\n            const events = Object.keys(map).reduce((res, next) => res.concat(map[next]), []);\n            cb(events);\n        });\n    }\n}\n\n\nmodule.exports = BubblingCollectionObservable;\n","const validateAsync = require(\"json-schema-library/lib/validateAsync\");\n\n\n/**\n * @class  Validation\n *\n * @param {Object|Array} data       - application json data\n * @param {Object} schema           - json-schema describing data\n * @param {Function} [errorHandler] - optional callback to modify errors\n */\nclass Validation {\n\n    constructor(data, schema, errorHandler) {\n        this.errors = [];\n        this.data = data;\n        this.schema = schema;\n        this.canceled = false;\n        this.errorHandler = errorHandler;\n    }\n\n    start(core, onErrorCb, onDoneCb) {\n        this.cbDone = onDoneCb;\n        this.cbError = onErrorCb;\n        return validateAsync(core, this.schema, this.data, \"#\", this.onError.bind(this))\n            .then((errors) => {\n                this.onDone(errors);\n                return errors;\n            })\n            .catch((error) => this.onFail(error));\n    }\n\n    onError(validationError) {\n        if (this.canceled) {\n            return;\n        }\n        validationError = this.errorHandler(validationError);\n        this.errors.push(validationError);\n        this.cbError(validationError, this.errors);\n    }\n\n    onDone(validationErrors) {\n        if (this.canceled) {\n            return;\n        }\n        if (this.errors.length !== validationErrors.length) {\n            console.error(\"Inconsistent validation errors. Not all errors were emitted by validateAsync()\");\n        }\n        this.cbDone(this.errors);\n    }\n\n    onFail(error) {\n        if (this.canceled) {\n            return;\n        }\n\n        console.error(\"Validation failed\", error);\n        this.cbDone(this.errors);\n    }\n\n    cancel() {\n        this.canceled = true;\n    }\n}\n\n\nmodule.exports = Validation;\n","module.exports = function copy(data) {\n    if (data === undefined || (Array.isArray(data) === false && typeof data !== \"object\")) {\n        return data;\n    }\n    return JSON.parse(JSON.stringify(data));\n};\n","/* global window */\nconst DiffPatcher = require(\"jsondiffpatch/src/diffpatcher\").DiffPatcher;\nconst diff_match_patch = require(\"diff_match_patch\");\nconst options = {\n    // used to match objects when diffing arrays, by default only === operator is used\n    // this function is used only to when objects are not equal by ref\n    objectHash: (obj) => obj._id,\n    arrays: {\n        // default true, detect items moved inside the array (otherwise they will be registered as remove+add)\n        detectMove: true,\n        // default false, the value of items moved is not included in deltas\n        includeValueOnMove: false\n    }\n};\n\ntry {\n    // required in browser environments\n    window.diff_match_patch = diff_match_patch;\n} catch (e) {\n    // loaded by default in nodejs\n}\n\nconst diffpatch = new DiffPatcher(options); // jsondiffpatch.create(options);\ndiffpatch.options = options;\n\n\nmodule.exports = diffpatch;\n","const getTypeOf = require(\"json-schema-library/lib/getTypeOf\");\nconst ID_PROPERTY = \"_id\";\n\n\nfunction generateId(index) {\n    return `${index}${Math.random()}${Date.now()}`;\n}\n\n\nfunction addMissingItemIDs(list) {\n    list.forEach((item, index) => {\n        if (item[ID_PROPERTY] == null) {\n            const type = getTypeOf(item);\n            if (type === \"object\" || type === \"array\") {\n                item[ID_PROPERTY] = ensureItemIDs.config.generateId(index);\n            }\n        }\n    });\n}\n\n\nfunction ensureItemIDs(data) {\n    const dataType = getTypeOf(data);\n    if (dataType === \"array\") {\n        ensureItemIDs.config.addMissingItemIDs(data);\n        data.forEach((item) => ensureItemIDs(item));\n\n    } else if (dataType === \"object\") {\n        Object.keys(data).forEach((key) => ensureItemIDs(data[key]));\n    }\n\n    return data;\n}\n\n\nensureItemIDs.config = {\n    ID_PROPERTY,\n    addMissingItemIDs,\n    generateId\n};\n\n\nmodule.exports = ensureItemIDs;\n","const gp = require(\"gson-pointer\");\n\nmodule.exports = (pointer) => {\n    const list = gp.split(pointer);\n    list.pop();\n    return gp.join(list, pointer[0] === \"#\");\n};\n","const diffpatch = require(\"./diffpatch\");\nconst gp = require(\"gson-pointer\");\n\nfunction sortByPointer(a, b) {\n    if (a.pointer < b.pointer) {\n        return -1;\n    } else if (a.pointer > b.pointer) {\n        return 1;\n    }\n    return 0;\n}\n\n\nfunction findPatches(pointer, diff, result = []) {\n    // for a diff: { a: { '0': [ 'modifiedString' ], _t: 'a', _0: [ 'string', 0, 0 ] } }\n    // return diff[a] as patch and \".../a\" as pointer\n\n    Object.keys(diff).forEach((key) => {\n        if (key === \"_t\") {\n            return;\n        }\n\n        if (Array.isArray(diff[key])) {\n            const entry = {\n                pointer: `${pointer}/${key}`,\n                patch: diff[key]\n            };\n\n            const propertyAdded = diff[key].length === 1;\n            const propertyRemoved = diff[key][2] === 0;\n\n            if (diff._t === \"a\") {\n                entry.isArrayItem = true;\n            } else if (propertyAdded || propertyRemoved) {\n                entry.changedKey = true;\n            }\n\n            result.push(entry);\n\n        } else {\n            findPatches(`${pointer}/${key}`, diff[key], result);\n        }\n    });\n\n    return result;\n}\n\n\n/*\n    Between two objects, returns the json-pointer of the edit\n\n    - for now, returns common pointer of multiple changes (if any)\n    - returns parent pointer for any array-items or object-properties that are added or removed. this ensures a\n        container, array or object, receives a notification of changed children.\n*/\nmodule.exports = function getPatchesPerPointer(previousValue, newValue) {\n    const diff = diffpatch.diff(previousValue, newValue);\n    if (diff == null) {\n        return [];\n    }\n\n    const patches = findPatches(\"#\", diff);\n    // merge all item patches by their parent-pointer\n    const map = {};\n    // @todo this should be directly resolved in 'findPatches'\n    patches.forEach((entry) => {\n        if (entry.isArrayItem) {\n            const parent = gp.join(entry.pointer, \"..\");\n            const key = entry.pointer.replace(`${parent}/`, \"\");\n            map[parent] = map[parent] || { _t: \"a\" };\n            map[parent][key] = entry.patch;\n        } else if (entry.changedKey) {\n            const parent = gp.join(entry.pointer, \"..\");\n            const key = entry.pointer.replace(`${parent}/`, \"\");\n            map[parent] = map[parent] || {};\n            map[parent][key] = entry.patch;\n        } else {\n            map[entry.pointer] = entry.patch;\n        }\n    });\n\n    return Object.keys(map)\n        .map((pointer) => ({ pointer, patch: map[pointer] }))\n        .sort(sortByPointer);\n};\n","module.exports = require(\"gson-pointer/lib/isRoot\");\n","// @TODO iterate over all schema definitions\nconst iterateSchema = require(\"json-schema-library\").iterateSchema;\nconst gp = require(\"gson-pointer\");\nconst UI_PROPERTY = \"editron:ui\";\nconst populated = require(\"./populated\");\n\n\nfunction isPointer(string) {\n    return typeof string === \"string\" && /^(#?\\/.+|\\.?\\.\\/.+)/.test(string);\n}\n\n\n// returns a list of {title, pointer} from root-node to pointer, excluding root node\nfunction getBreadcrumps(pointer, controller) {\n    const breadcrumps = [];\n    while (pointer !== \"#\") {\n        breadcrumps.unshift({\n            title: getOption(pointer, controller, \"title\"),\n            pointer\n        });\n        pointer = gp.join(pointer, \"..\");\n    }\n    return breadcrumps;\n}\n\n\nfunction enumOptions(schema) {\n    let options;\n    if (schema[UI_PROPERTY].enum) {\n        options = schema.enum.map((value, index) => ({\n            title: schema[UI_PROPERTY].enum[index] || schema.enum[index],\n            value: schema.enum[index]\n        }));\n    } else if (schema.options && schema.options.enum_titles) {\n        // @legacy support jdorn/json-editor\n        options = schema.enum.map((value, index) => ({\n            title: schema.options.enum_titles[index] || schema.enum[index],\n            value: schema.enum[index]\n        }));\n    } else {\n        options = schema.enum;\n    }\n    return options;\n}\n\n\n/**\n * Resolves the given pointer absolute or relative in data\n *\n * @param  {String} pointer             - current base pointer for relative targets\n * @param  {Controller} controller\n * @param  {String} pointerToResolve    - relative or absolute pointer (must start with `/` or `../`)\n * @return {Mixed} target value of at #/pointer/pointerToResolve or false\n */\nfunction resolveReference(pointer, controller, pointerToResolve) {\n    if (populated(pointerToResolve) === false || isPointer(pointerToResolve) === false) {\n        return null;\n    }\n\n    let targetPointer = pointerToResolve;\n    if (targetPointer[0] !== \"#\") {\n        targetPointer = gp.join(pointer, targetPointer);\n    }\n\n    const result = controller.data().get(targetPointer);\n    return populated(result, result, null);\n}\n\n\n/**\n * Returns the resolved copy of an options object. This method is used by the controller to help setup the\n * main options object of an editor instance. It is simplified, in that it currently does  not resolve any reference\n * on the current data\n *\n * @param {String} pointer\n * @param {Controller} controller\n * @return {Object} a resolved copy of the editron:ui settings\n */\nfunction copyOptions(pointer, controller) {\n    const schema = controller.schema().get(pointer);\n\n    const settings = Object.assign({\n        hidden: false,\n        description: schema.description\n    }, schema.options, schema[UI_PROPERTY]); // @legacy options\n\n    settings.title = getTitle(pointer, controller); // this comes last, because ensures an '*' is appended if required\n\n    Object\n        .keys(settings)\n        .forEach((option) => {\n            settings[option] = resolveOption(pointer, controller, settings[option]);\n        });\n\n    return settings;\n}\n\n\n/**\n * Ensures each schema contains a valid schema[UI_PROPERTY] object\n * @param  {Object} rootSchema\n * @return {Object} extended clone of json-schema\n */\nfunction extendSchema(rootSchema) {\n    rootSchema = JSON.parse(JSON.stringify(rootSchema));\n    iterateSchema(rootSchema, (childSchema) => {\n        childSchema[UI_PROPERTY] = childSchema[UI_PROPERTY] || {};\n        childSchema[UI_PROPERTY] = Object.assign({\n            hidden: false,\n            title: childSchema.title || \"\",\n            description: childSchema.description || \"\"\n        }, childSchema.options, childSchema[UI_PROPERTY]); // @legacy options\n    });\n\n    return rootSchema;\n}\n\n\n/**\n * Resolves a list of pointers, where the first found value is returned. Supports simple strings as fallback.\n *  e.g. `[\"/data/local/title\", \"/data/local/subtitle\", \"Title\"]`\n *\n * @param  {String} pointer     [description]\n * @param  {Controller} controller  [description]\n * @param  {String|Array} optionValue [description]\n * @return {Mixed} the option value\n */\nfunction resolveOption(pointer, controller, optionValue) {\n    if (Array.isArray(optionValue)) {\n        for (let i = 0; i < optionValue.length; i += 1) {\n            const option = optionValue[i];\n            if (isPointer(option)) {\n                const value = resolveReference(pointer, controller, option);\n                if (populated(value)) {\n                    return value;\n                }\n            } else if (populated(option)) {\n                return option;\n            }\n        }\n    }\n    return optionValue;\n}\n\n\n/**\n * Returns the first defined option set in schema. Supports relative and absolute pointers in data\n *\n * @param  {String} pointer\n * @param  {Controller} controller\n * @param  {...[String]} options    - a list of option properties. The first non-empty option will be returned\n * @return {Mixed} the first non-empty option\n */\nfunction getOption(pointer, controller, ...options) {\n    const schema = controller.schema().get(pointer);\n    const editronOptions = schema[UI_PROPERTY] || {};\n\n    if (options.length === 0) {\n        throw new Error(\"Expected at least one options property to be given in getOption\");\n    }\n\n    for (let i = 0; i < options.length; i += 1) {\n        const option = editronOptions[options[i]];\n        const resolver = isPointer(option) ? resolveReference : resolveOption;\n        const value = resolver(pointer, controller, option);\n\n        if (populated(value)) {\n            return value;\n        } else if (populated(schema[options[i]])) {\n            return schema[options[i]];\n        }\n    }\n\n    return null;\n}\n\n\nfunction getTitle(pointer, controller) {\n    const schema = controller.schema().get(pointer);\n    const title = getOption(pointer, controller, \"title\") || \"\";\n    return schema.minLength ? `${title.replace(/\\s*\\*\\s*$/, \"\")} *` : title;\n}\n\n\nfunction getDefaultOption(schema, option) {\n    return schema[UI_PROPERTY] ? (schema[UI_PROPERTY][option] || \"\") : \"\";\n}\n\n\nmodule.exports = {\n    UI_PROPERTY,\n    getOption,\n    copyOptions,\n    extendSchema,\n    getBreadcrumps,\n    getTitle,\n    enumOptions,\n    getDefaultOption\n};\n","const m = require(\"mithril\");\nconst createElement = require(\"./createElement\");\nconst LocationService = require(\"../services/LocationService\");\nconst OverlayService = require(\"../services/OverlayService\");\nconst SelectTileComponent = require(\"../components/overlayselecttiles\");\nconst UISchema = require(\"./UISchema\");\n\n/**\n * Request to insert an array child item at the given pointer. If multiple options are present, a dialogue is opened to\n * let the user select the appropriate type of child (oneof).\n *\n * @param {Object} dataService\n * @param {Object} schemaService\n * @param {String} pointer  - to array on which to insert the child\n * @param {Number} index    - index within array, where the child should be inserted (does not replace). Default: 0\n */\nmodule.exports = function addItem(dataService, schemaService, pointer, index = 0) {\n    const list = dataService.get(pointer);\n    const schema = schemaService.get(pointer);\n    if (schema.type !== \"array\") {\n        throw new Error(`Can not add item to a non-array (${pointer})`);\n    }\n\n    const selectOptions = schemaService.getChildSchemaSelection(pointer, index);\n\n    // single option, immediately create template data and add item to list\n    if (selectOptions.length === 1) {\n        addSelection(0, schemaService, dataService);\n        return;\n    }\n\n    // multiple options, ask user\n    const element = createElement(\".overlay__item\");\n    const selection = selectOptions.map((item, oneOfIndex) => ({\n        icon: UISchema.getDefaultOption(item, \"icon\"),\n        title: UISchema.getDefaultOption(item, \"title\"),\n        description: UISchema.getDefaultOption(item, \"description\"),\n        value: oneOfIndex\n    }));\n\n    // create user-selection\n    m.render(element, m(SelectTileComponent, {\n        description: \"Modulauswahl - Bitte whlen\",\n        value: \"0\",\n        options: selection,\n        onchange: (value) => {\n            const selectedIndex = parseInt(value, 10);\n            addSelection(selectedIndex, schemaService, dataService);\n            OverlayService.close();\n            LocationService.goto(`${pointer}/${index}`);\n        }\n    }));\n\n    // add data of selection\n    function addSelection(selectedIndex) {\n        const itemSchema = selectOptions[selectedIndex];\n        const itemData = schemaService.getTemplate(itemSchema);\n        list.splice(index, 0, itemData);\n        dataService.set(pointer, list);\n    }\n\n    // and ask question\n    OverlayService.open(element, { save: false });\n};\n","module.exports = {\n    addItem(pointer, controller, index) {\n        controller.addItemTo(pointer, index);\n    },\n    removeItem(pointer, controller, index) {\n        const nextList = controller.data().get(pointer);\n        nextList.splice(index, 1);\n        controller.data().set(pointer, nextList);\n    },\n    moveItem(pointer, controller, index, destinationIndex) {\n        if (destinationIndex < 0) {\n            return;\n        }\n\n        const list = controller.data().get(pointer);\n        if (list[index] == null || list[destinationIndex] == null) {\n            return;\n        }\n\n        list.splice(destinationIndex, 0, list.splice(index, 1)[0]);\n        controller.data().set(pointer, list);\n    },\n    moveElement(list, index, destinationIndex) {\n        list.splice(destinationIndex, 0, list.splice(index, 1)[0]);\n    }\n};\n","const m = require(\"mithril\");\n\nmodule.exports = function createElement(selector, attributes) {\n    const vnode = m(selector, attributes);\n    const element = document.createElement(vnode.tag);\n    Object.keys(vnode.attrs).forEach((key) => {\n        if (key === \"className\") {\n            vnode.attrs[key].split(\" \").forEach((className) => element.classList.add(className));\n        } else if (vnode.attrs[key] != null) {\n            element.setAttribute(key, vnode.attrs[key]);\n        }\n    });\n    return element;\n};\n","/**\n * Converts a json-pointer to a valid dom-id (url selection)\n * https://stackoverflow.com/questions/70579/what-are-valid-values-for-the-id-attribute-in-html\n *\n * @param  {String} pointer\n * @return {String} unique id\n */\nmodule.exports = function getID(pointer) {\n    return `${pointer.replace(/(^[#/]*|\\/+$)/, \"\")}`.replace(/\\/+/g, \".\");\n};\n","const render = require(\"json-schema-library/lib/utils/render\");\n\ntranslate.strings = {};\ntranslateError.strings = {};\n\n\nfunction translate(key, data) {\n    if (typeof translate.strings[key] === \"string\") {\n        return render(translate.strings[key], data);\n    } else if (typeof translate.strings[key] === \"function\") {\n        return translate.strings[key](data);\n    }\n    return key;\n}\n\n\nfunction translateError(controller, error) {\n    if (typeof translateError.strings[error.code] === \"string\") {\n        error.message = render(translateError.strings[error.code], error.data);\n    } else if (typeof translateError.strings[error.code] === \"function\") {\n        error.message = translateError.strings[error.code](controller, error);\n    }\n    return error;\n}\n\n\nfunction addLanguage(lang, keys) {\n    const _keys = (keys == null && Object.prototype.toString.call(lang) === \"[object Object]\") ? lang : keys;\n    Object.assign(translateError.strings, _keys.errors);\n    Object.assign(translate.strings, _keys.strings);\n}\n\n\nconst i18n = {\n    translate,\n    translateError,\n    addLanguage\n};\n\n\nmodule.exports = i18n;\n","module.exports = {\n    addItem: require(\"./addItem\"),\n    array: require(\"./array\"),\n    createElement: require(\"./createElement\"),\n    getID: require(\"./getID\"),\n    i18n: require(\"./i18n\"),\n    isNodeContext: require(\"./isNodeContext\"),\n    populated: require(\"./populated\"),\n    selectEditor: require(\"./selectEditor\"),\n    UISchem: require(\"./UISchema\")\n};\n","module.exports = function isNodeContext() {\n    if (typeof process === \"object\") {\n        if (typeof process.versions === \"object\") {\n            if (typeof process.versions.node !== \"undefined\") {\n                return true;\n            }\n        }\n    }\n    return false;\n};\n","// returns true if the value is valid, that is: it has content\nmodule.exports = function populated(value, returnIf, returnElse = \"\") {\n    let isPopulated = true;\n\n    if (value == null || value === \"\" || value === \"#\") {\n        isPopulated = false;\n    } else if (typeof value === \"string\") {\n        isPopulated = value.replace(/<[^>]+>/g, \"\").replace(/[^A-Za-z0-9]/g, \"\").length > 0;\n    } else if (Array.isArray(value)) {\n        isPopulated = value.length > 0;\n    } else if (Object.prototype.toString.call(value) === \"[object Object]\") {\n        isPopulated = Object.keys(value).length > 0;\n    }\n\n    if (returnIf === undefined && returnElse === \"\") {\n        return isPopulated;\n    }\n\n    return isPopulated ? returnIf : returnElse;\n};\n","/**\n * Selects an editor based on the given schema\n *\n * @param  {Array} editorViews  - List of editors with a static function 'editorOf'\n * @param  {String} pointer     - current pointer in data\n * @param  {Controller} controller\n * @param  {Object} options     - the complete and resolved (UISchema) options object (editron:ui + additions)\n * @return {Boolean|Constructor} The constructor of the chosen editor od false if no editor could be resolved\n *  or is denied\n */\nfunction select(editorViews, pointer, controller, options) {\n    // @todo export this to a configurable function (this is distributed across modules: json-schema-library)\n    if (/_id$/.test(pointer)) {\n        return false; // abort if it is an internal value\n    }\n\n    const schema = controller.schema().get(pointer);\n    if (schema.type === \"error\") {\n        // data-pointer could not be found in schema\n        // @todo find a better solution for additional data: maybe an 'additional data'-editor\n        return false;\n    }\n\n    // @ui-option hidden\n    if (options.hidden === true) {\n        return false;\n    }\n\n    for (let i = 0, l = editorViews.length; i < l; i += 1) {\n        if (editorViews[i].editorOf(pointer, controller, options)) {\n            return editorViews[i];\n        }\n    }\n\n    return undefined;\n}\n\n\nmodule.exports = select;\n","module.exports = m;"],"sourceRoot":""}